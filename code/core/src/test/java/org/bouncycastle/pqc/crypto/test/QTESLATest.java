package org.bouncycastle.pqc.crypto.test;

import java.io.BufferedReader;
import java.io.InputStream;
import java.io.InputStreamReader;
import java.security.SecureRandom;
import java.util.ArrayList;
import java.util.HashMap;
import java.util.HashSet;
import java.util.List;
import java.util.Map;
import java.util.Set;

import junit.framework.Assert;
import junit.framework.TestCase;
import org.bouncycastle.crypto.AsymmetricCipherKeyPair;
import org.bouncycastle.crypto.params.ParametersWithRandom;
import org.bouncycastle.pqc.crypto.qtesla.QTESLAKeyGenerationParameters;
import org.bouncycastle.pqc.crypto.qtesla.QTESLAKeyPairGenerator;
import org.bouncycastle.pqc.crypto.qtesla.QTESLAPrivateKeyParameters;
import org.bouncycastle.pqc.crypto.qtesla.QTESLAPublicKeyParameters;
import org.bouncycastle.pqc.crypto.qtesla.QTESLASecurityCategory;
import org.bouncycastle.pqc.crypto.qtesla.QTESLASigner;
import org.bouncycastle.util.Arrays;
import org.bouncycastle.util.encoders.Hex;

public class QTESLATest
    extends TestCase
{
    static SecureRandom secureRandom = new SecureRandom();

    private static String asString(Map<String, String> values, String key)
    {
        if (values.containsKey(key))
        {
            return values.get(key);
        }
        return null;
    }

    private static Integer asInt(Map<String, String> values, String key, int def)
        throws Exception
    {
        String value = asString(values, key);
        if (value != null)
        {
            return Integer.parseInt(value);
        }
        return def;
    }

    private static byte[] asByteArray(Map<String, String> values, String key)
    {
        String value = asString(values, key);
        if (value != null)
        {
            return Hex.decode(value);
        }
        return null;
    }

//    private void doTestSig(AsymmetricCipherKeyPair kp)
//    {
//        byte[] seed = Hex.decode("061550234D158C5EC95595FE04EF7A25767F2E24CC2BC479D09D86DC9ABCFDE7056A8C266F9EF97ED08541DBD2E1FFA1");
//        byte[] msg = Hex.decode("D81C4D8D734FCBFBEADE3D3F8A039FAA2A2C9957E835AD55B22E75BF57BB556AC8");
//
//        QTESLAPublicKeyParameters qPub = (QTESLAPublicKeyParameters)kp.getPublic();
//        QTESLAPrivateKeyParameters qPriv = (QTESLAPrivateKeyParameters)kp.getPrivate();
//
//        QTESLASigner signer = new QTESLASigner();
//
//        signer.init(true, new ParametersWithRandom(qPriv, QTESLASecureRandomFactory.getFixed(seed, 256)));
//
//        byte[] sig = signer.generateSignature(msg);
//
//        signer.init(false, qPub);
//
//        assertTrue(signer.verifySignature(msg, sig));
//    }


    private void doTestKAT(String file, int securityCategory, byte[] pubKey, byte[] privKey, byte[] seed, byte[] msg, byte[] expected)
    {


        if (file.contains("KAT32"))
        {

            //
            // Validate Key Generation.
            //
            // Invoke the key generator with the Fixed Random that uses the seed from the vector.
            // This ensures we can generate the same keys as the vector.
            // USE A REAL RANDOM NUMBER GENERATOR IN PRODUCTION.
            //
            QTESLAKeyGenerationParameters keyGenerationParameters = new QTESLAKeyGenerationParameters(securityCategory, QTESLASecureRandomFactory.getFixedNoDiscard(seed, 256));
            QTESLAKeyPairGenerator keyGen = new QTESLAKeyPairGenerator();
            keyGen.init(keyGenerationParameters);
            AsymmetricCipherKeyPair acp = keyGen.generateKeyPair();
            //
            // Test generated keys from seed match supplied keys in vector.
            //
            Assert.assertTrue(Arrays.areEqual(pubKey, ((QTESLAPublicKeyParameters)acp.getPublic()).getPublicData()));
            Assert.assertTrue(Arrays.areEqual(privKey, ((QTESLAPrivateKeyParameters)acp.getPrivate()).getSecret()));
        }


        //
        // Set up for sign / verify testing.
        //
        QTESLAPublicKeyParameters qPub = new QTESLAPublicKeyParameters(securityCategory, pubKey);
        QTESLAPrivateKeyParameters qPriv = new QTESLAPrivateKeyParameters(securityCategory, privKey);


        // For signing..
        QTESLASigner signer = new QTESLASigner();
        signer.init(true, new ParametersWithRandom(qPriv, QTESLASecureRandomFactory.getFixed(seed, 256)));
        byte[] sig = signer.generateSignature(msg);


        //
        // Verify signature matches vector, NB signatures in the vector are [sig][msg] hence the concatenation.
        //
        assertTrue(Arrays.areEqual(expected, Arrays.concatenate(sig, msg)));


        //
        // Set up for verification.
        //
        signer = new QTESLASigner();
        signer.init(false, qPub);

        // Verify verification.
        assertTrue(signer.verifySignature(msg, sig));


        //
        // Damage signature, expect failure.
        //
        {
            byte[] damagedSig = Arrays.copyOf(sig, sig.length);
            damagedSig[0] ^= 1;
            assertFalse(signer.verifySignature(msg, damagedSig));
        }

        //
        // Damage Message, expect failure.
        //
        {
            byte[] damagedMsg = Arrays.copyOf(msg, msg.length);
            damagedMsg[0] ^= 1;
            assertFalse(signer.verifySignature(damagedMsg, sig));
        }
    }

    /**
     * Generate a signature and compare the generated result with one generated by the C api.
     *
     * @throws Exception
     */
    public void testSignQ1()
        throws Exception
    {

        byte[] seed = Hex.decode("061550234D158C5EC95595FE04EF7A25767F2E24CC2BC479D09D86DC9ABCFDE7056A8C266F9EF97ED08541DBD2E1FFA1");
        byte[] msg = Hex.decode("D81C4D8D734FCBFBEADE3D3F8A039FAA2A2C9957E835AD55B22E75BF57BB556AC8");
        byte[] sk = Hex.decode("0B30605000E08087F21F029427811CC07D2108F41338809E03FFF9EE175028DF223D7D0914F85F3090C07B83F5F9F12F883F3E028B06121008303F017EFFFB170A6CA86F40C287E71828B4973F613F01072934E857517FFF84F119E47F10C002418405250A48F050C0007D0123EC5F482F80018103004488C7CFDEFF7C0009F0CBD7A080C183F8D51F4CB86F223B89F1E9E52BB8B0BF7B78FD32FC8B0FF0BE007FFAD2F1DFF71FC17E06FE1318EC0870BE018502E52158C84E607E7910E31504A02F808100FD1AFEEFEF40FEC3FA0BFBFB2B40AEDF45040703F6D757D081C18307FE01041000007F09FE01F427384F023C7CFF0B005CD8A0FE800AF1159CD7DFBE217E820F09FE974850A1018400EE05147FAFA141FAFFF0C9ABAFB0FEC0FBFDFC05BC1F90A1807BFCE5CD6FF890FFFC01F015E0F3C7FF5FBD77FA0DD897370060BE83FCFBC56F1810608482F61674036810E2FB84FE0C1488BF2F1FC2FFFDF5FF4320AFA03F7A0AE931B00780A1C480FA211470C02FC283FF060A36740790208389F9F7CB1350BF1EFF00010F1CC8A09FBE817D0FFF2568181F60FD81FCE32918A09EBF7DFDFD04F237503FA084820800FEBFAF0F217EFC1DE5E9F7E71FE3820507EC23D0777F3F7DFFFE2F22E84FBF628284FA0B22C06FA15F40FEF12D487410A15F40FA09E5FD2B00BF1C80F80606EC0FE7E0DEFE7FFEF17390F86F41FD771B28067CA00F40BE0214060A50E08E018087F5E033F447AFA07BFA170C5AB047A13E410605FDE71BB800803D85F01FCA3B302F014107FDDE09709F705DBD00F7EA277808C060037CF2FED7CFFF90E1FD7CF511FE13C8C07F7F0A061828EC7F7FA03F84F807FC0B980E9E83FBF006F4271811DE3CFBEFF4EDCB6F5FDF417FF71A082C20906100FB041242B098603E8005E908F88F38EFA03E7B0028361C88917D817A15094800B07E5E3C030014FC93773F61C3790900ECDFD71F20FE81FBF4E92330C0A0C183FBFB15BCE76F1F0102F4D31B743FFFC17E04FD01BCD7E73EDE7B800909E84F780181817FF70A382C88201F3E7CF9082E2C000121C00118ED09782F00003E00EEE1F92768C0A0BFFEF7E90F8C68A1C0FEFD03F69F63E781FFC3000F24F0CF77BF80FBFBEEF9DD071890A00201FCF3D7533820E101FA030CFEEFB87F1E007E021EF6631841BF8181FE21EA07186F9D4386F9E415F82FD0808382041ABC876F10DFFEFA0CECFFE3A7BEE181F205EDE71F28B0FF00F9F21D264850BF3D837DE6FB2FC447AFA1BE0507EE15DCDF7F800378EDF7131C48D07F7D7CF921CC77E8CF7F827D0C106614686000BDF6FB04F86BCF1E3E800114F5E7BB6F10DEFF81F311E043878F003FFCF2131214A0A07E418AF42D08E8EF3FDE0000EFFF0FC8773F60BC860E1322D46F7001407C001CFA57EF0E61BD81FCD539B06791DD80FEFA09263410E07CBFFF08EA1DA0CFAF20F96DFB1F0284EF400141800DEFABCFCF3F7E420AF9DEAF3F08B08083F7091314C437C05F3D05040C0648C88F1F008B0E0CF82F28805F0191FBF3C317C820E04087081DF68FB7AF7DC27D02DBCD63A09F5FBF8DFA23566000107F7EFE0DEA0FA8EF30007F800AF7E707A83FA040FAE0993B08009265B8004398CF119F95FCC217D38228F1D1F14BCFC5B7160986C339F23EB15423271EF1CF476289657DBBB1460665D3944B78BEE92D15AA609768F9");

        byte[] publicKey = Hex.decode("FC218155B484DC0EC3C2A445E6E2092310C4146BEC2A3A5D3D0CE8070B75ABCE4DF594FEF99A1615ED658C487F4F9FE9870AA816BA2364EC9174A417697B3244F252E07A382DDF33E39444441E4C5AAD319274F3E37F75DE8C2476393CFF3CD0250688F0A1FB0106972E62170F0C2269B0AD579CA91F0F4343B44D23F73BD39B5470F8B2A0DC3610D42E3BBC1ED7AE03BF6A88E4A647128278EA5A747590FA9F3148BDB56A3606E2AF20FE7C178647F98CE7D0C90B12344D7D33A766D21C86E98A164405134D5163F5BDE28D5A106ABA070D80DC0025C584D20B5774F25231A89D0C9D7A8B182E34A356DE4B7ED302CF10729F021032D111E431E6114AE915241C269B9CF9C3C5E4F55CB73BB4EA89D35060046D904896101017E4BBEFEDB404D5EE0B0846F89567780061BE858F1FDD0E9849AB64E744DA1863F989D179F372AA78412E15A91A0C7480081851C0C1CF98F4F46551EE84961A1843A78C12152952037B8B962A7150C9400456A63A6304E934AE63ADCA82C3CB650446A65E4A3AB1DD6F4D9E5634053D0F0F79489E196D5E8704E26BF8F1E451C5840E822FEA12892110CEEC986889A01572062B6E35F43BBE44D34D165EB273FB54F5EE2F901345453561AAC63CC4D37C7E534DC2962D0AC6DE752DBC966535233190364CBCA2021902A90A8C2B4494BF2226F89F20D082413F25E5A8BA64E6613EA3852E8B0B6F288A4812E5F5A47A7B6C458F204A9F45E78908301FCF448025A724F77ACAF2C3F469E35CF0E24FD3232F3740114AEA6B9C1D33D34A90939145475FE21D5F19CC06F9AA8DD069EAE6530087307A7F0EE4FD2A7C9D0444DDB5347B04E0AA864102635B1DE32F4D15757D16D73076FAB3121ED57C792905E291B39FAB66BA84106ADCE205565829B129C9DCF0A5663003BC6749F91DF0225AACED2CBB72376B8911462A203D79C74E6E51FB3A50C1E536717A93978C35924BBD6BA51DE681E410BBAF52C57BFC280A45EA0EBB503A5455170C5AC4548EDEF81A8895D4CD30A74B737232ED5C8D90FC4CB0F783A3D6083430A1DAB2326C4CD7479F9B64D15372A9AF4482EDA0592703304E7ED222399D1A02045A928BA7E698B0B5B4B5AAC40D290180CE670B5905B72481DC58CE8A657930901A1233E5F032962097339D2384C640D90FFCECE236133CD7411A7F15A351967A3C68E837AE8C85CCE907590ED4105D937584055FCC689005C0CC94B4E5416428EBB489F45FA5CA3B7705163280543BDAA7881C7017DCAE2A517C75ACD6A36D64218CB93278259B6EA3EED58577EAC0026082368EE147EFB4B7C8EA103FAE042FB161D9A58CA48E7DF6469299B13FC07EDCAA477261112A3E579E0EB22DF51E63FDA4791E74C5C5B91819174D6E02527308BA02CE8732D3C73B4B1B5DA917005D684592E831B5284DF7C0AB9BE1E10414900444887AE62C103171D5BFB0AB1017E8666BE9B336DFE0D2BD340BC4266E46037D989A1E98F041E90CED367E3C1ABB686DF6562859649C0C076FEA8A3EB00E687F50C08A28C0F81880EDDAAE0E794B8CFECF1E57430FD83F77055F73AD0349BC22300362C70C3266BFC3F0CE6EF8DAA45FF1112E94818696F2A519DECD85549A5B154E83B39BD7E335D88DDD48084D666655B02DBF2A164E2B1E4E000AA64D61F280A0B473FE7848021AF7A8A0F5893C8048A687E1DAADD05D73BDC31ED61571CC3DB765655B970E002ACF725A9C096C6F7C4B9C20D151D3EF00E1A213EB8A09FF54700A61F94AEDD808F418250EC36F375D6A1D5EDE6176CCB78B54C8838091101B7618155B1A17B5705B4888AFA5E4A4E72372C458252E8466DA32DDE99D09671EC35782A6E95481D8F8424CED37122C3F17422527356A9C334420ABD5C5C322A1E973C5E4F1348D5303340E76D7D980F387C8DD74562DE01FC551EB25F0B14E31181489FC0A17FAEC4CA45439F5C266C2348AB630065EA8119326065CD3E92D96B3B31ED85B826A4959A1E05E70E3949FCB6C92E29B0071FF4229FB593862B0A17884F770E71F2591F453A5AECFBAF2459D5699DC7D3C161D96160E993B08009265B8004398CF119F95FCC217D38228F1D1F14BCFC5B7160986C339");
        //
        // The QTESLASecureRandomFactory.getFixedNoDiscard(...) is used so the same key values can be generated for a given seed
        // for testing purposes. You MUST use a real SecureRandom instance in reality.
        //
        QTESLAKeyGenerationParameters keyGenerationParameters = new QTESLAKeyGenerationParameters(QTESLASecurityCategory.HEURISTIC_I, QTESLASecureRandomFactory.getFixedNoDiscard(seed, 256));
        QTESLAKeyPairGenerator keyGen = new QTESLAKeyPairGenerator();
        keyGen.init(keyGenerationParameters);
        AsymmetricCipherKeyPair acp = keyGen.generateKeyPair();
        Assert.assertTrue(Arrays.areEqual(publicKey, ((QTESLAPublicKeyParameters)acp.getPublic()).getPublicData()));
        Assert.assertTrue(Arrays.areEqual(sk, ((QTESLAPrivateKeyParameters)acp.getPrivate()).getSecret()));


        QTESLAPrivateKeyParameters qPriv = new QTESLAPrivateKeyParameters(QTESLASecurityCategory.HEURISTIC_I, sk);
        QTESLASigner signer = new QTESLASigner();

        signer.init(true, new ParametersWithRandom(qPriv, QTESLASecureRandomFactory.getFixed(seed, 256)));

        byte[] sig = signer.generateSignature(msg);


        //
        // The expect sig from the C version is [sig][message] so to validate we need to append the message to our generated signature.
        //
        byte[] expectedSig = Hex.decode("E787F8A574A8F0A77E4ABFFFB44D1F9396E8D2F2DD1C1EC5C573F366DFFF25CB33212B889AB2D56ACC4081BC1688E7D4F0C6BE8E53A5871EEE78A59C7B1C6869ADA6AFB9ED7079A892EB9D02BC4D51E75C275AE4378D0DB254B0674ECCD6A072FAA902182F443E0C8F114CF51741E559F0BC0E19EB1D75E6E0729874B0BDB7B236F7DBE3CD7B90DB940219D0F87D7AF420A5E0FFB73BFB7D221D1782A14597695CFDDE023BA244AAECA77C817E49902E109596F5A2CF2CD1ADEE05783EB9A9C3A6A3DA961DD0EE2B1D418861996F8D9DB7EBA59211B411042C7329CE5FA3011B9092F238FA84EF165A412F4188933B0C6E154B1BF2F5F0880F907BFC6A2A4231094EA6C10CE18318CA115CBFCA90917CA0EB2C9E975CE2108337623696092AE7FD98C4D6EA0DACEEDF6C03FC113F56079F93582195B401052B93FAC7BBE3DCAC213B8BF589D77F01BA63E95B2B54FD5E2D6AB96EC2B387ECEBE2CB21C9A4A0F29EA5F7D24D1CF5E35F0EC94F9B43BFA18D3E979557CB484E5F9EB8CFF35208106A5D482F0895B65C7D92FC87ECEB173AA06EFA494F430DCF3323BF84832B543090B7370364297D0E32601DD8669B6869DFE2DA2BDEE0B48D888ED9E93CAC36E0FEFDD4E37B57958EDED6A36CC6FC4F9CA210A75B9448B14180BF54210E0719BA0FA1887B04634DFBFF199A383F1448FE39DA8635A8EFE7A70A8CC4DC3A552ACD0066088CA4139D446A78082B742A1D65BA2F854C6C1AA3743C41E800E522C1A48B84534751E5910DE8D078155DB45975E66AD11C565ED5E1F1784FB71CF1ADF828F99CBBE82C3B91522947D497FB36BE11ACE0415E526E48E2734459972F5D3E5733C1D10A455BFF2B8A0624EC1142D7E639DDFF5C1ACE8F8D381DAE393E37C935BAD5A5F4FDECB8B0334D643B60D6A3A51B81E6C6D2448C1A54350C9A24035BFB2383AAACEB024B0E349E784A145F6EA70F64BEE64D7D4BB30C8A60AA3B033F51B7B5D7BCAC9DB15375ED9F08F58719A6D5BE4B1D33B9F7AA425E814C8D1C99F03781CC502F4A2108511A2873A7E014C6EC82108005718F2D2B05149F0A80621564C3593E0B4EF87ADCEE960E113047997C4567308FCC87735DA85376A50F6BF40B1022D94A27A7499F7E84612A813AD5C3547A14A0B18C55BAAAE55D9F2845C227860D8235B82E6A322D8CFDBF9FD08D4D23704B5D15E4ECE06E5B7F1791E4E0D2A355CAC0DC4BF54A0838F225FE7BB6A3D38D199DAEE77B9AC1AB2B5C0C68130CBA01E389B3F5E9F3233727B971C17191C680CB7F15CEFB2C6CAAE31F15FD8D2815CC7605ED4C4D691C94CF0113D801A0B5AD51D30612A72BAE62C532966ECBAEAE2A014A20351E89582C2D37FEE403E04A59C8556806014880A50FF78F115914A9E0B7823E4D7A9F0978870BD02DF735A958B2186643B8CF7D5B359A78D6021D20E421E133C87BA7564F3E78DBF80511E9BA3B61E86531FEDE9CE091DE3EECAC46631132A6855B2AA607499DEBFBD0C9E41CAA6155324D361E1A0616BD0F90BEE6691DA35D646A88096443529BBB3BB8D8B236AC81CDB8D3C96544BBE233B0764ECEDA92A5A14B02F49B283DEA6D418A911CC506A521DA8CAD567191C2C37CC9B2C7FD722D142F9D3B2F1F40CE297AAC6B263EC4FFF5917DBC17BACC6A744204F31D69D7EBD8A540368AF1EA7B5052AF28A43BD9FFC2B308F6CF97B74F6A646C7C02720DB8FA933129D73327E48B0828411CC8607AC9355EBAA0546766221EFE19DF0CC4058FB598D359BCD86567755B3FAD8E7E8A2EA08E8DE2EE3B3610F0A454D59B0136DA7B58D6D80E5E42E9FE21267B9D84D31FAB1A88FE85FEB5016FD6722A89972C1D3EB3DF62F73055B98A906E87D7F7C93B2AF6AA6A8392FE3ED355C6F56CDC8630B2C3A06EA9DF197823448E70C01F349FB0E6D69958AF7347D81C4D8D734FCBFBEADE3D3F8A039FAA2A2C9957E835AD55B22E75BF57BB556AC8");
        Assert.assertTrue(Arrays.areEqual(expectedSig, Arrays.concatenate(sig, msg)));


        //
        // Round trip against the public key generated by the C version.
        //

        QTESLAPublicKeyParameters qPub = new QTESLAPublicKeyParameters(QTESLASecurityCategory.HEURISTIC_I, publicKey);

        QTESLASigner verifier = new QTESLASigner();

        verifier.init(false, qPub);

        assertTrue(verifier.verifySignature(msg, sig));

    }


    public void testSignQ2()
        throws Exception
    {

        byte[] seed = Hex.decode("061550234D158C5EC95595FE04EF7A25767F2E24CC2BC479D09D86DC9ABCFDE7056A8C266F9EF97ED08541DBD2E1FFA1");
        byte[] publicKey = Hex.decode("528056F0580068A91464C5248A7F410B2C1C0CA95FD4B66C2CA752B5F55F11EC7120FA1C2B031FC2967197045B013747EE4F7045C76F48BC79B84831E11A5A3EAF25E6782A9E59695E29792BDD625BBE2EA99867224B10536513A86658E3321C4499520D650518930CA0CC1C8A936F6B2975B70C19BC71263CB62F51B37227E74019FA0ACD556B61DA3E33C95E379929A0104DCC137730526581D76CF3001614B27B85D12BB6DA3DC0E35179564358D10484FB1A38B66B9A501ABAAE285E8A34C122213D7A1A12ED48CA9F50861770091B2C949F2FD3FC23E9BE06A8907C1EAC0CFE481653141DDDD01E4CF944A45D31222A693A2E35727E54658729C37272855A67FC30654D9F5098666566816B233A59B71A788ACB146E4E3BF373202CDE549E667279D72C65B8381C7470FD7533C9C808ED621527081A2D2E6536272AA63231A82D6894F93877700D88472563F901886012729E4D1413587B1655D2664EC1E84749E644FBC81D288B03B55F1129635AFA184E6B9A0A23AE72351B4F1FEB469C5522596850C9B70ECC8C23CA2A663B3158CBDE3F9B9D47E6EB5F06FB6B60B8118A567654CD30DAD5444D137347DF62FFE21584935C58522747DA7AF74643568910D2502D57955429395134941D1A6F2796D72D49A34AE7155FFF2352D06902C3B503DC8A71D5CD32138725F9F26D02E44A0E975AC7801D24BC3AF8A976857C2D846B279E196C95CE46B8874AEB777DD8F63543121827890D3F877E47DC05F5453E96C964972D23861B1B9DD34A7442452985647A5B47A8660D206A2538727EF2FB3FED3C55B8393DBA3468C1F1594BA30E3BAC1E0F6C5AE6FA6D2CF23702D4319A8233106A51E66C7480A07608421196E91622DA69521116773C0683BA7266192878332A4B570C28EC1B45FC2E6A7878AFA51B37474485361081464E94077F491F68C4C84668C90EB14A6392A24517791C85CC71FE3A0089F418D6626092A678FC8B4A90904F9600073E1B5D14E141026A1E73D3362A6C36750416A3CA5FE58229A9330FF5863304595AD23815BF641BBB7C18C0592531211B627241B71E2297B66EDD5029A7242CB43D6A25AC1D4F9E1D17931E9E7A2B0C636BEF226AE5B357653D1C1563665FFB477F6E0A419D5206F63B4E754AF5564BD1A43109941C05166F66472682AB7B2F7666F82562331F2278B91069B5571C8C1982290B04B56828311C3FCF09656E723EAD6C034C2084A420CE0B0B73D370FCD14BA72564DF3729A9F55A4F94404FA4766C382B2FC0234D284B69D6430D46207B9E1B329D31D1826DA0D634771212A8E83DF85F302EF8599B4C759F2E5980FF3EDA0369746B67E7714DD33C3E23A11D1CAF1ECFEE5E40F063D7452D2F9E5A72A932A4A73DEA947575F215A30634B08F3EA7EF52048D79A26A07C42A49B36E30B7796204223D0E2C05179E1152730934D839354D2E06977A4FE04A39541DB2F174F35078D2A44001A64B5D615725983B8F365842EF3EC90005AB67054FDC001EEA0436F85241D60E34C07F0F017C299944AB2479596E3015FD3C52D550B7067547891D628A10D24A6D01CE2CEDD960718907929349DB750D8BAE0518E82BF95D17A1A61AD73C64E84A7915DE5FE68C4DA07A3384596971EF61635E2747DF4EF2E657459C4FD992137A3569B0F84A12E359F2CF7C3F861C181638F3866BF1EF46F37E673BC25279284F36E852811B4CABD71E80426327675BBF35624E441A99A50CA4E30A04724B32916995B2553118254B25662B7364DA2E433A9E2036B856D12642EB2F4046921EB131599A7143EAC54E11FC5832603FC93A1297C4744E2775A1815DD49669A76A0B629129669F67DDC0066F351AD58F7A7BCA2C356E7C306C678690528DC7711F4677C47A036B84670EBB245EF236905B06E27C0D8E586E0B6755323242C36D3DC3C13B4F6C3C9DD5526FAF02FB3417D906368EBC2CF3EF1D1FB20DD2574E63CD3797D028B4D17EA82C2166A76145F578308E3A135A5F65AF31E645219DEC40C28A593AFB2DC8AC042E870E488556EEDC02071F2B294D0377641A5DB912692222D6AC06D6243C6F0812477E284228615C0C1DB7734CE1BD3DFFDE4E58845E679D59D08A74881656A96D4458E342F2A52604A4291877266E183CB3EE41B8D661E5D23BFC7E749D005E32B22E0B514701AF726E790B387D4EEC6D44A49A3D09E306D25E2A053D086CF15B4F810491756FCFBB2BB1A01BDD5B23FD7A6383F14D2A4C717B8B73CD8B201640097208294234042865612FAB688BA9699A9C399C0C4236FE43C1FC4FCE5C6AEBC7640534002321410C3F30EB0B5AB75A20BDC359277408FCB324268650677634993C0C25CF049FFD0EEE47283781265FA6358898027D666F7E8C455089388C60543CD053ED5222864B4F4B47345DD8536FE72A354C69BD716A22FE4D0D2D3B73CB79878E42550A12040E53D2193BC3434E02BF4C4F1745BB0264B0CF5C24080279972EBCED6DCA6C73617B0A79FA1A58C76960D16E5A4D4892CE7D41970947B11033A74F11BD14949F32FAAC02EF8719A7BD0C1B3705FA2C0B4C5A332BB6222F010FACD92AB00F566F4D20B1A8364AAF50913D2336750DA01E25825F456B2B2C0B381B7F80706E732654670750ED7365594A8EF032E757184A0E7412BA0F16B60B7EF279BFEB41458430423459536E031CA13881035237BD12076160A5AA394D673C4BA33B224D7666D707765F67B54F6550AD16C22136905E54B6AE03C2D15637486A3F3C2400F75295F753B4295D9EA62D27F670B970006B8E282BB0308C4543BECF1A639D50A0F37F1E1135665D68C4F973C83C1D87A649EF42683C4754125800C3E1094FB8004AFB23A4EE2EFCCC5931E771290B520EE3119930686445346B2C129979723C4D71D4263543477D27961395E31AB3D348241A6774CA5A4E5405B397383A84255B87084EBE5381B6177DF8173FDD53A92D39257E7847CF23241A558DEB3D0FC94F0CCE1C1DEB4CF1915709CC4EDA7E54BFBD1444B60CD73C70F51D6F6E106274EA62A9A44646E161E76417F5B140B4EB2E6E277D4AEA7575816034F90BA17C512E682FBFD72D7DF528FAAB284E8E5DD566228D3C263DDE6AE80D33827062244140DBDE06005C224A2C3E42BF4E711D4D378D5313247F17082E5A823B5DE23760F83BAF46507DAC07F52A450E9B4754885833900D97B60BEBC274D211718C9041C50715B8C3530A092CEA7E2F793F34993B08009265B8004398CF119F95FCC217D38228F1D1F14BCFC5B7160986C339");
        byte[] sk = Hex.decode("F2000513060505F9FE05F7041001040B1E0CFD08ECFF00EAF600FF07F8000B08EA08F90700F9090DFF01040D071203020DEB0203EBFDFA0804000CF100FA020D11FE17F0040EF0090F00F80C090200F605FF07FCEB0201F3030A0DFA01E108FEFB06F6FF0701F8F3F5FF1EEE0A09061004FA090502F4020408FC05FEFB0B0FFC01FBFA05FF07FB08030E000BF0F70E0E08050602FF0601F403021401F60AE7FBFEFDF60B0200FAF902010CFEF60DF7EF0309F717F404F303030602F40EFC140F100401FFF2060C04FAFD05010F0C0400FFFC050209FC06FD06FBF400EF0B0213080006F1FB02FD07F6040B0C0411F2FF0103F2FA00F2FF07F4FE1207ED06FE121406F60F0801F408F900F506FBFFEF0A08FBFF070AFE02F106F5F00005F1EFF30C050E020FFEFF070FFC060AFD0CFFFC09020E0A0103FDF80202040AF607F2EDF7F50404F6F505F80003FC0EFAEEF40806FE0AFB02FA0703FAF7FEF2040313FDF0F112F214F707FC0B0205FCF3F9F206F401FC04F6F8FFFE070601FA050805FF070BF6FFFB05FFFDF7FBF407FEFEFDFA0CF40F0AFF09FCFE1209100E050BFA0AFC050EF20912FE0CFCFCFC06FD04F70706F5FA01F8EFF703FF03F901F90706FE0A011803FF0801F40706F1031AF8F7F801FC060B01F9F2FA06FBFBFF0D12F90D00FF0206F60E0AFEECF90B08FC08FE03FEF5FF0A0AFE0701F5FDF90A080107FB00F50CF0FFF0FEFBFFFC05FC06FCF8F50D0D06FBFFF90305000409F907090A05FBFEEFF206F7070AF70F0D030AFDFD0100F2F906F70FFB08FD06FAF311FA0C06F80B060801FF01F90201010C07F7F5FAF4FF0BF6F700FA0606F8F91000ED03070504F50AEFF803FDEEFDF704090A02FFECFA02F3F9000608FDFAF4FC080507FFF907FCF7FD000C0BFC01F210FEE5F50AF9FA06060714F0F60AED06000EF50607F604FC06FB0000FAF107EA0CFFFF03FCFC060DFC00FD01FDFDFEFF07F8FE001109F308FFF8EDF7FEF5F8FAFCFB090002F506FBFA0CF7EA07F207F7060203FA030B0002FB07F402FE09FAF204FD0510FDFE18080FF7EB02F017030BEF020DFB0C02F702FF06040700040B0711FE0E08030BEE07F302000402F20AFFFAEEFAF5F9F5001502F00CF806F3050509060102FE000CF9FFF7FEF1F300050E0FFD10F500010309FDFEF611F5FC04F4FD071001020B0E08F20311FEFD0806F3FD0108F909FC020D09FF0208FF08FD1A0204FCF604F0020200F0FCFD01F40AFC03F405E70806FC07F7FA01FB10FA08F9FDF8F609FF04F30F00060206FAFEFE10F2FF09F60310F5FF02020C10FE06FDFEFE1400F80BF707EC0AF6FB0F00FDFC00FF04FEFE04FBFD05010C1308F100F00BFB05F60C050E0414FE05F0FE0B09020A170E0405090DFC060206F70109FDF302FD00070CFAF704F8F4FBF902090DEEFE0200F70AFBEEFE00F4F6060DFE01FEF4F600F7FDF6080202F512E60805F80DFD0201FFFE0106F00EFCF60A15F7020315FB01F8F5F9FC0101FFFBF90301FF02F2FDFD0004FA0602060909F9FCF9EF0B19000708EB02FCE9E712FFF8F20208FAF60AF3FEF0050FFCF7050000EFFD021105070FFEFE08FCFF06030CED01F70109040E0FF1F6040B0CFEFE0107E813FCFCFAFAF9F2F90BF2F20507E50203020505FEFF020903FC0703FD05FDFDEE00FE0D0806090801090207FBFA05F8F9030F02000EEB100609FBF40907FB01F8020DF400F6F8F80FEE02FA030D06F206FDFB090A0A0012030CFA0608011003010606F6F402FDF3EC0CF8F9130CF2FC0FFB0406F8FCF709F70F0701F7FFFD0806FB0F05FBFF020309F6F401EF09FD0B0C0709FF0103FDE71000F5EE0FEF08ECF4F801F9F40D01F6FDFEF4F9FDFFFCF20000FAFB0100041101F804F9F709EFF6020105FEFDF30003050E06F5F503FBFFF7070603F9F10CF8FF0EFEFE000704FDFF0BFEF10105FAFFFB01F6FDFB03E9FE10EFEFF9F9FD04F817F1F2130002FF13FFFEF506F108F3F705FFEBFAEFECF8FEFC03FE08FF0A0BFD0A030D0315F0000A00070915090E09F3FE0301F90FF80806F1FC0204F9F90201FEF701FF10FFF4FBEFEEFFF30104FDF50A1011020109F50308F1FB0DE8FFFB04F903FF06FB040BFC0AFB03F8EF04EF00FE0BF5F4FF16FF08FFF7FDFEF208FA070AF6993B08009265B8004398CF119F95FCC217D38228F1D1F14BCFC5B7160986C339F23EB15423271EF1CF476289657DBBB1460665D3944B78BEE92D15AA609768F9");


        //
        // Key generration.
        //

        //
        // The QTESLASecureRandomFactory.getFixedNoDiscard(...) is used so the same key values can be generated for a given seed
        // for testing purposes. You MUST use a real SecureRandom instance in reality.
        //
        QTESLAKeyGenerationParameters keyGenerationParameters = new QTESLAKeyGenerationParameters(QTESLASecurityCategory.HEURISTIC_II, QTESLASecureRandomFactory.getFixedNoDiscard(seed, 256));
        QTESLAKeyPairGenerator keyGen = new QTESLAKeyPairGenerator();
        keyGen.init(keyGenerationParameters);
        AsymmetricCipherKeyPair acp = keyGen.generateKeyPair();
        Assert.assertTrue(Arrays.areEqual(publicKey, ((QTESLAPublicKeyParameters)acp.getPublic()).getPublicData()));
        Assert.assertTrue(Arrays.areEqual(sk, ((QTESLAPrivateKeyParameters)acp.getPrivate()).getSecret()));


        byte[] msg = Hex.decode("D81C4D8D734FCBFBEADE3D3F8A039FAA2A2C9957E835AD55B22E75BF57BB556AC8");


        QTESLAPrivateKeyParameters qPriv = new QTESLAPrivateKeyParameters(QTESLASecurityCategory.HEURISTIC_II, sk);
        QTESLASigner signer = new QTESLASigner();

        signer.init(true, new ParametersWithRandom(qPriv, QTESLASecureRandomFactory.getFixed(seed, 256)));

        byte[] sig = signer.generateSignature(msg);


        //
        // The expect sig from the C version is [sig][message] so to validate we need to append the message to our generated signature.
        //
        byte[] expectedSig = Hex.decode("1E886847E9ECB69F71553A6B514BDC63C636BA65F7AE891D9571E77A947D1A3119901222EA508F66B57564E01ABCA614CF55C71BB874DCB77A38D81DC317E7C10DF4A5AD564D737FBAE5F0969C772990DD29F63CD7D631B2AB8CFD7EA92CA13926B5C6E3A66F3E00B70591148787B04B65F6810666C1F87588E7DE61901C801E26E8D69E0CB266F1B76B3DEF80DAE6568F5163BF83133D2152B0C4B88B00FC106E5C4B0C6DDE9836A8DF17BD8E4B24157FA86C25FDD656BA1DA8F47E2FAA68256EB57BFE3CDFCAA9335F47F150764F771F0812F42B2CCF5E6332D8B5A193A1572324C6CC4274BED8192031525E3C8E2FBEB75B5A517A822C5AEE7F6E6BF6B451FE1E12E1034F3CBED22B726012C89C06A6095F7DA1EC4DEB433164C93E109C2CCE42B9A8410CCD13F36298900CBDA324B110F546DCEE2FAF061C3CFCAB38B88889A58B928241C1E54ABD8FBBF3B959E7F22C0F51FCF916F0672CD9CD0ABA7EEF136A69E2844311B28E181FF391BC2554626FE9D8E966EDF4B3A51C7E486D97FA4D29E8C350F2AE32920C2D8F35D0E3761094A175E07981616A1B9B4F0E11225AF64B9CA07EAC93DA1835F79B597A4C489685DE07E4EE9AC176296DF663DC766000DE8475F69D5A7BB93238E44784A5D879A058598FFBEAA85E477725AED14FF1280462BE4E9C52024EE35422EC0FC2F74B65F1E1BC88EEA2508453043392F6A35368C1FCE1B8E4CF28DB841AEAA4F2135D8B3400765EB2343A318356484AB9935C121E2B18FA0B1D754E5F1E31B1801AE53213743FA0C849304A4502D24661D523B79743BAAA28689B65CD5CB138875CAEAAA0F2E8AB6ECDD6B761498930B97BB56513AD541F23AA28FCA68723148B07249632E124CE6E28CFE04B28A2EBDAC0A1158A32F9AF5B32E08F1F711DDB7055F76E2B4DB390BD393A00E7F88748EE9D5B2D61BE9B372E999D66DA3A50E547DF6A046134D61AC4789BAA7A86267684ED1724335D598B042C4AA1B1CBA734B3CB21EA03E25FB32E7DDB45195076A9A317B849758BE49ADB6067B3AAFA1DA0B8E60FEF8A564C5EAA0893EB6C556C54204847CEF0F087F698DDB7283C4248BF81422515487A315C41C88705E1075B9227508F55400656D1693837CF82987BFDE7EEA618227C2165CB2CFAB8F2182671E21FEA05B9125A6C64F61F706D2B30368DFDE9775A4CD9924E78636A601450841987EBAACFEFBA835234E9C49C8F60D259570C33DD31FB5B804236695A80B6C49F822837B874B07FCE90B4D4A5E3502944E49EEFAF540747428AFF93DC91E48CE9EE5CDBE769B35E9D5FC69067825577C021C499BEE9434B6E3AEFC6028B4BF40B089FAF76F53E3C3415C61FE5E41B6D5230D029A866D424A5839674C011EFC029B51D9CA661469C8770D5B72C13AF6D4D98AB0F0165FF35AE42B1ECAFDC91295F49AE440EB9CE8841CB25005C10472F232E5CA491C0D555D37493339DEEE187E9D6B636B98B64758D0D527F2EA655B31ACFE6460705EF50F033B8E14E5944F92DDC864510A15377FB0E7AB81B3F9E9C1045BDE1B2B3431C4B9C628A734BF1EE418BCCB5C5D199CB394884551669F2BCA171CFA28BFCA3CEF574B2A38D99D49C2A9048909A91BB53065BA2116BF3649C61CA959A7611C0C0797432E12DA94A7445FBFCA796DEBF6D312E235D211B290D1178D89A6E2EB6FB309C6399C0FD624028DA76EEB3FB40E39C927B75F1830F2AFEBAC87D6C2E7455AAD12421D8149226831D0F179064C9B81B7C40865E2D8DEE5F0058068B90C6F916EE933D32F6B902422F70F95AC6BBB7DEEF420E0A01490F07452C7D00358E3241A59E99B8F0B059F19D72B85C672D9DE66C40D8F5A9EA320FB575F69375023A9A5120F18E4406B87D55E52F036061EF08B38665E1D51EDD9392C92D508200205B0E10F927FA760D38872C7739F13E4587F6DA2F77F6E09A72313DBAFEBB7E51BC33AA5E59CFA0597E5FC886A63DBF584F99D16BA26A95794B5FD32F39B27C22D7AFABB45641E3884A09C53A8CC51CD2005D312556B04AE071BF3D98720964E3E55EFC2FC8C2FD8E4559CB11AA326008EBFA5439B3359C459BB8026D1DD300E6CE517A4D38B86ECCA27684DA90EE31E6D48998AA49DDCE12C6C51F52C618C3F6E7F222FAF955E124591D13FBBF571C609897ED12236B6592D241B746A20627BFBFAD11325DD60253C538D11D4C017985F8F365F0521CE913C26CEFA768E50B5DFAD99DE17BF20E6799B506B58F6FE113336E5327EA38BFF0F7D63DC7F622B748902244F6C2F6A7D9E49856DF807057F8D276B83A288D458B4B37A4271C17956548CDCFFE78A497FCF97C99072FE7ED8AF69F294D000975C2139D621BB7CF93C0F286CD02D1F8A0A2D4831B2C89CEA1BB7F8F023D67F30EBB6B90236452E51F8E6C108EC809A11AA4B83F0F7B81AA16B5517D78D436423E1052FEBCE8CE55F0E5FC7C327F3392759F430791AE6C7FE790554205735D2B7B51C72454750EF466E4DD17A810DB18A57B758D66B8E50F50C4FB0FF26EE2370A799A772DD88876EF2DED537BFD5150563332F613BE5ED7B5E7F009364315484B97C6178FDD98E4E79E32ECCFCA2F07FAD7A2CFC07CB22B9C82198EB7AF9FED7C8628E1E592C2A27B1BCB25A819D9CF94BD5406EA65AEA1FC6D5BE387AF43E70F85A02497822373CE57B60852FEED7E91B3B799969982847F909CC59E09D69712617A8334D44A008F7A014FA470D2F037ADDD33FEA24E181F3F48F93266EE0546B026B32449DCA83B62F5FC446CEE6B0729D5957B8892F0512D9A167F070E768876F80E97F187060989A7B9C7601184F6FBD08A64DD23F97FB7721A8CB090663675A97D6854CB26CA08FC2A53FE77C98F8CC46820F7BCB34F13447CEBE403C9620A84A3F9F49C1E40388B1869DE9983FBECEE28E85E2B8208457723B15EE0F3115BF7310166D03B95D793A51B3C636FD68AF605B86211AC98CC0153EEBD8208AEAD058091FBFA6E3E465338111D783F0C976CC4D81C4D8D734FCBFBEADE3D3F8A039FAA2A2C9957E835AD55B22E75BF57BB556AC8");

        byte[] generatedSig = Arrays.concatenate(sig, msg);

        Assert.assertTrue(Arrays.areEqual(expectedSig, generatedSig));


        //
        // Round trip against the public key generated by the C version.
        //

        QTESLAPublicKeyParameters qPub = new QTESLAPublicKeyParameters(QTESLASecurityCategory.HEURISTIC_II, publicKey);

        QTESLASigner verifier = new QTESLASigner();

        verifier.init(false, qPub);

        assertTrue(verifier.verifySignature(msg, sig));

    }


    public void testSignQ3()
        throws Exception
    {

        byte[] seed = Hex.decode("061550234D158C5EC95595FE04EF7A25767F2E24CC2BC479D09D86DC9ABCFDE7056A8C266F9EF97ED08541DBD2E1FFA1");
        byte[] msg = Hex.decode("D81C4D8D734FCBFBEADE3D3F8A039FAA2A2C9957E835AD55B22E75BF57BB556AC8");
        byte[] publicKey = Hex.decode("30EA3DACD21DE2AD1CE2A513F0BA4362BC340B792196C145D53446BF483F39B470775F0F95927719FD2D050607796D1F64EA2027AC29611754CD097297BE62CF123C95E172C6D229FEB337FD19745AE701C6B3374F5F25B1221FF4191CC5294BD65C15CD1B0FC15D3F8C0F39F50C20F5DD5FE50B06AFDC1906E562C56C30FF925981CA6E640467DD5F5C8EEC63C9B4270A7E3A30087032C356CC92089FAB51D5C870A9D81C5C461A8B3F53BAB67E09E37F94F22C496238D87B365B1F4896553F31C91FD04E3EADE74F454C32A3732CF1BA631D5A1E6FB3747456579E5F1C58427765597FF12C06119E642CDF1AC24E6ED4787465702DCDDA37AA2E441C7747775D65C6001FDD9546207177C81F5322E272A0517D4F0F5857F91944C72A3D4135BDD171397521812D251373054F6372FA4A03418B40B2AD00A8EC0673F253A40C3BE295142AEE1B40D179A278372D6C01C0F75441CE18B8A549C1523E77F911785B5849EA65297E5817ED6582701804316877A92131260EFAB74A932C1C72C431F50F7C117632EB4D7F063F3F12ED7816B027CE627905C111A7DA2D2DE57BF42E626E392797346675BD6439641FD715571AA75CD60C2497B63C641A106F143232E37809C95FA7185BAB2562D7630F00E443343425B8AD5CC6681A7A0E653879406E743EA4C848B4787C6CF2182A440AF8203DE1C24EE09415244278BF9E779F406880EB6BD9556416BF0175167B9D4543A94F0977FB0277E812600C0DB0AF09FEBC15F15616F5CE075EEB4C212332BAF97FE413473B993944C00F7F83609BCF454A742428693EBE863BB7972E132535AB841649047EB7C73A14EB19075C34F0360E63D376111444FB146DC5013C818603A381670E89596CE828C14C3C1D362A7D9E42569B2C314513CA772A52483A161B144FD27DC6A725219D48EFCA6572EA57985C357229478BBF324A7E45D0E14CB3A257687651265B4CCD7B6AF86349F5611DF4E36F61EB1DB36B6F84B72BBD5E35E91A4B2031599AF96A7B505AFD8B341FDB6009193FB74E3F8D2B2A56672E9A806400BC79B3A77D7CC84B845911C46A4A78F73115B25D72C24F5D0A16406D35E5D02264DB20C6885FAEC73943E66532046A43B078C03820DE7F0FFCFE2EDE313BA56E0E518E38772F40CFB11C061C1FD8005D5E3B2CF1EF6CDB785EDA9A6853EF3A4B5D42AC45673E604CC73A5AEAEF7BA0C13273C4349CBB125B7167C367786E6B2DFBB530932D4C5C6E0C920068522958488F4346F7489FC2047CAB62402F5AE0AC01FC6552B5F50587202D36AA0106603E243A1CB8131776C928137623CBDC25876341D3591FC0FE795B5224EDD8067C4573B8F35978F63217C22445C3269736804E656E68724C13481BCE1C67277924C1EB41149F4BCC2217154826E5EE25EEA1679B7C4340DD5711D924AEEC3E9AC04A9AF1043D8E4C5CB00B38C60B7BAF7FBB2576002376064604A9947577FD7C56370C6C0D76F2DD1E5D011DD7485F2A295BFA3327CCBA1DB6AC689DBE3F5124082CEA5473097C0ADA29144B0F216B18B3B85502854FC7037FA3D4786A5379087115811038D0D5046DF70C013628786C77B94A22FDAA2159A8660C0617F58613A73F50B2B204F306399B4C73A2C25B87403FA7406150677F80B274488E0F58F73C3B1D7586452F10EA6057C86A91DF2BC17707666A2EEA0006CBF9635B1A1354AD473EEB116C324E096726C88B45EE881ED8D520DCF822C3522717422B7DE11ABC1F344F2425596D0C051B713D280D1CAC1E0327651EA419FEEC6310946BC8801F7E1E709F976A04325E8B0D35C2D86BFD020B4F772CB1821BB3CC6DB0007802D439D2793DEB4D1E97672F0E6168B66F49AB762E467A234CEB5091AC5D21870B280E53FDB052732836020B1EDFCF095513247EE124C3C752BC9964716101F0CC6C4D191DEC3F03816F5072E03D25C33C992F089FDD5FE4BB454D375FF1D636D0F45065957077686953050C641054C64D20A0F628DCB45BD8251429E62B22A57B498E09734F6ED0F1351BC16F3C5E4FB52176F6E647F44633CFCA06BA107F482E0AEE932BF7E74643B1738B3208276D356BF401E87B1D9C016E93081CE249647E9D6DBC5630C980197F7767938336E3C64BA7A520C52451F7E650E2680C4CBA0DF0E62795C5262D333707CF109E6E5767361673FC040B3536B5DB3CBB6A735E4123719952F18720E50C2A998B2C8A915D809130906B09A601670DC33C292B0794F63FA1D56EF1CE72BB7B4676CA666DED3FBE69721113389CF27344F4429B4C3BE5324CF78703B4156D7852101F451A01E1692AE64F7FB70B164365D5AA1A87714EC871561D8A63C4270DB2481484411F4570068E61787C1B73F2C90BD4667B831C34526324832922B4AE5AF45C3E50A60A50643E58A050744E29CF161431525248C10393B652065E51B3327990CE5B60373283682684C2035056662D1163E83E21D9CF448D375C0F403DE6736770B55645837C53BE3D76AC415FCC3B83A266294E6DB4D44125D24FB49D2494E91303796335CE7A27162406300FAAA70E3C444FB3C01D32304D9B937BE053332E735A26351D831F50BC8B7559E214D86A4958134FAD7D634B000069084BF6CF1006D659B85E765FD80B23966873FA7624612818D36D78E72A983A6B86AC3E99F756110365C66C4516664418A63D7FDB4AA030609EF97B686B0890677629972F3A6A23FDE823948028D73C02CE22077F3B2B8A4979877D6E38850BD4573F11624CB49905DBDF0B408A1E8E5F39E1E14278F12C4BF458CADF000D8738995329211C28A890752EAA547EB42006D977492D0E8CAF753098401F0806766941777762F7045DD88274B23131E8015433504DF7BB11F6C20838617BE9936F481E0F67AF15BDF21ABF78494BA77E4134803124343A1531FA4F72ABFE48AE2E75106514D5D610A120535AA47395361C38BF2C15FF08D5B62AE0125971221447727F865E35CC597AD7121E7B8352CF56591FBD4B7FFD64D5F25B9D8F1D3A267A8D89031FC83F12EA600D214F421C7137347F672623F620079BBC0CE1173125A03AB8BC4F7879616D1E39C08336C2B8504D9A4949170EC890505FFE333DD05418D86DA1BF461EF21F1C4E42DBFD7F87641A208964EB86457C7A263C9A54C1622DEEDE13D3D44DBD537769F0400EBE129CC535A59A3AF4697F32D36B80536A3FE36EC0770DA61F196B9B2FB11509FE037E0E195ED92052C90146ADB22A41FB7055AA5E7D4360CB105966B16CE5FB0A07C307D22F38689D32A17A3A401F673D857712A66B8F672F7B7914B443460888200CB71638FD65E09A3E83C60908AA28D047668EBE2CE9462CA5E75866B63A1C900D7E323AC62A51C8B50A4E3F26D9607828DD2CE6825D044110744B040C4F367C975680741F43F92CE8B57C7B536009D26E78A732941B7D295D218B68040C4F4A11BB3680040124FD51F45016B20D6BD95B5BF9EF4C78E411A425423CEB264EF808EDB94AB6E177B7B60E2BF22329576FEC092FF12B2B802D48EF0F495A023B5C253ABECE358E771BF7ED7BF9242B955122AD8E62FCE87418C04BAE4E5D153C7D447F1337A63D52AD38F94D040B072996AB3C2D5307F84F70E6DA1CC6745BA75027715C1C77E801589E7649510F303A1CF06B63538C1E5D1B4A606C3EC05C05A6BE147D093DF6B67D4FF3348EE3597A5112277243DAEC7895215509CF1133CC4B4DB43F4C785412FF6C9FE9164280697EE8792278488F74715FC21C4C1018B87F6E6BD85DFA833796DB522A972AA6D366387A3FE39D0BABC612F595394BA37702BF465D3C34AFC60284C562817B7B6B410D222B4F002358D1C2399B544E98506A1EB7336F791D32A902F8D76485D0601F2D6679357181F076A734787D90195A0447782E40BD78193CA04EEF267E207E56172F59F6A74A728E0974424A315C765A0C495275658D9A52B9E820C3E865A8B872956C7E853E1174935AFADB1B662E0118DE714549257AA81F6BE54BAA3131B5997541280EC90D66E41314D9243CA58523999F1132E500374F4466BA4E70F56F5FDF4ACA41006AF00444332AC97743689540523E47410B3E60094D403B54BC695872012BFEBF665EE045435144FD0C7C40371CB5304C1D4378F96D2C86364E98B94E93050F1DE569C7C53B63887F54296B744400C5C1286A1D2D64362E402413975E05E3E17FF23A53DD033DCF925BDEBC524F395BEBBC7AAFA40BF94D50FEAC1BE24A4AEB047BC11875EE650723791D47C914AAAE10AA4041A58A6FD68E6740EF459E4D45454B528CD22F60ED39869B099CB6313258077A9F5EB60E7FB7708849FEDB54F41A68314805A5C0766ACC9F338A46B29EAAC00087AD");
        byte[] sk = Hex.decode("02F02F907FDEBE03FDFEF12FF83FE0BE80FE1018A48F1FC03F03FB0302E8B7306081FF0300F22FC08F40C082FD000A10F8301F7F02F6FE1154C83F20FF7EFAF00F3CA89FBF007F02F82FECB73FE03D06F4070840E0FFBF7F7EFF050234E05F2081FF0700EE2F986F9F00FFF509161850C0E03F0405F915FCC7DF3F81010AFEF9D317001F7F7F04F5F707F86F80000105080A28E04FE0C07E01FA27F427F0BFC0FC030E10F4EFFF9F417FFF07F8CB4700C13E030006103800D06000FDFAF809E44F500001FF0209EC1F206080C0800401FC13F8DF80BFFF01FA0520E8CF7F01020AF615FCDF6F3F81FB0014FEF78F509F7E02FF021004E82F60018200FC01FC37307FBF7FFE020CB8970F604183FDF605E417B060BE82FFE9FB972FA0FF7FFAFEF703FC77E0E0818401FD291838F0DF7E81FD0218005890A07F82F6F71D14802060C1FFF700EAD7973F1FC08104FEF903000000BFF8FF07E8FBC7EFFF7E840709F8CBE74FC03F0106090648302000C0FFFAFB11D4DFFF1FBF01F40DFA0730D0BFC101FB0C0A08D88FA080FF03F7E50FF01F1FFEFD06F90D2C684081BF83000CF80FC80F40007E02EFD907C00F0041F8FDFD11F8F7AFA07F7BFB04EEF3D7FF7F7F0300F1E73BB8C09F7F7F0BFCF7E38F6FA0017E060902F8EFFFA03F7F06040EF89F1F7FBF8501FAEBE7EFFF7F417F0201FC3BB0BF1F0000FD06EE1F30402001810216E223F8DF9E3DFE05FD0D1C2030A03E0001FAF30F9800A0C18104F20FFC1710C03E8005FCF7DBC7CFFEC0FEF6FA0BE0FFBFDF3F7F01F2E11748701F7F84FCF2111C4040217FFD0601F0E717908040FE0600C61B28C0FEBE79FC041A00F09F400182F804F6EB2FF06082FDFDF6EF0FB84FC0BF0403F9012CD81FA08003080816FC17B020BEFDFAF50D04D8DF5FBF7FF9FBD70B58E03FC2FFFCF701DC0750803E8305070CF47F909FBF84FCFD2704687FDFBF7F02F501201830013F7FF90E26D0F7EF7FFE00FFEFF7E3FFBF80FF81FC05E6CF47505F4000F6E40124A0DFBF7F7902010A00B81F6141FE01FC072C08B060817EFE03025490EF60FD7FFD0B22E4272080FF7FFD05202040A0C001FF03F003C4276000BF7E0B08E40320B0BFFE7FF9FB070C5830BF000203080E641010E0BDFF091012E8B7CFFE40FF05F705E44FE0BF007E04FDF7D38F40603E81FBFD29E4EF0F20408003131E98577FBF7E01FBF2F71B3870DFFFFE05F7E9CBCF5F9FBFF8FC03F21318809FFF7FFA05E61F088080FE7F06FFF5EF2FFF3EFF83FF05E8DB5F90C00081FF0002EC978F40410602FEF1EB0FE01FBF02FC08F6D7FF0F014001F709F823A09FC08200F5FA0BCC07D03FFEFB0307F2274860003F00FF05FEDFCF5F4002820105DCFF5780A0C0FD0C0C1EF4D7EF9F7F7BFA081210E01F4081840211184020809FBF00F907001CF81F1FC001FAFD0FE06FA03F7F80010DF8232000607D82FC0DF00B2860C03F80FC07103880DFE0BF8001FAEFD337C0FF7F81F8FA0510C8CF5FFF79FFF2F903F8FFDE8000FF0708A8DFFFDF3E7D0008FE2368605F4000FF0D06EC4FE0BFBE00FE04FCF317F060BD81F900FC37F0AF9F417D02F5F51768F05F8284FEFFFF174830003D80FBED23E437E09F4180F7030820082060408104010EF8E7DF1F7FFF090216E0C7FF1EC07F00F82BF88F005FC0FEFD020C3020B05F010705F8030808B0DFFD7DF902DC0B182080BDFD09FA0D2020E0403F01F9F305C097EF3FFE7F06FE0324C01F607F8602FBFF476830E1FF81F9F313FC1760407E0000102E0CD83F1F7F00FF00EAEF4F4F80BD8002FFE30B4000C0C08100F3F5DF6FD07F8001F9142C4878501FC17EFF0102FCB7AF7FBF81FD0A2AC0272001007DF706F23B18A07FFD02010D162CA0801F417E04F313D40FA03FC080FB08EEEBBF4F610001FE1C1020B8AFDF407EFE04100C7840210001050CF4F75730A0C001FDFD190CC8BF9F3FFFF6F8110C30503FBE800607082C5830200084FB001AC0DFBFA0407FFF0A0434E0DF7FFE80FF03F6F3EF8F80FF030603023800E0FFFF01030EE0BFFF7F9F7F80FAFF0FF817D05FFF85FEF1D37FC09FA0FF7E01F7151450A080C27DFCF711045070C13F02FB08ECCBDF5F00FFFCF600EEDFF72F400186F409F8E3CFFF3FFF03030438BCEF4FE08100090F0210D84F207F0205F4F3D3FF4F60407E020212E84F907F01010012024418209F800305FA0BE49F7F1F7F05070EEE47B81FC0FE030209081C6840A03EFEFDFD051C18703F8084FA0908E4577060FE80FE010AE4AF5FDFFFFFFAFDFB0308C040427CFD01D6DF8FCFDF7E80FC030A241860208182FC11F407F8BFDF3EFE01FFE92BF01FE0FF7E0B01ECFF47A040C20004FE13F0B73F20408100EB15F06F405FBF010A08F8EBC78F5E3E80FAFEF7C3DFFFBF3FFDFA0AF807B07F5F817F0506FE2750F05F4181FD07FCCB07F05F3FFF08000EECF7BF3F810107FCEDDBE7EFA0810104FAF7FBCF1FBF4182F703F0FB37A0013E7EF5F9FD43E0AFA03F7F0203042878AF7FBFFEFA0D0CDC0F40803F02FA060404F09FC0FD7CFCF9F3FF07006140000303E8E71700400081FE1802D8871F203F01020404ECE76F20007E0103E0370870A1C27DFDF2FB0BD020A0FD7FFCFCF523C8AF00C0FDF9FF01F087703F0204F602FEC34F901F007EFC0FF6ABEFAFE07F01FAF1E3EF0FC03F407F03F1F72768C0BFFDFF03F70514D82F40C07F04FF113C0080E04080FF170204E0CFBF3EFD0A04F4F33720C0FF7DFF0AFC0338605F807F000E1A300800DFBE84FC0BEA2778FF1F80FAFAF8FBD74720C07EFF06F0F1D33F40603F800303EEF71F50E0BFFB04FA050418103FBF7EFD0F100838A0E0BD81F9FB2928E00F60408206040E30F09F1E420302F51B0828B07F410203FCE3CF3F30A001020AF7E9DBFF7F1FFF7FFE03F4BF5F7F20BFFF00F801ECE77F20C1FC000FE407F81F01FE7C041BEC1710606100FE01FDDB1338D01F3F7D04001C981F2061FFFFFB002000381F2081FF02F00B24904F803D7F02F1231CA86F3FBF7E0607EA0B5830808003FDFBD7FF57E0DE01FC01ECE7EF0FD1FF407B04E31FD437C0C0407E07F61BBCDF9F1E817DF903F033B87F003F810007FCCF17707FFE03FBFDF72F183020BFFFFC010EF46F4F003F7E05F123EC8F9FA0817E03F4F3C3EFCF3FC20004F613C81F3060FF8205F90908908F7F000603FC0DF8B71F40C18006F6211C2050C03FFD0005061C6070A0C002FAB60E7FB7708849FEDB54F41A68314805A5C0766ACC9F338A46B29EAAC00087AD394D1695059DFF40AE256C5D5EDABFB69F5F40F37A588F50532CA408A8168AB1");


        //
        // The QTESLASecureRandomFactory.getFixedNoDiscard(...) is used so the same key values can be generated for a given seed
        // for testing purposes. You MUST use a real SecureRandom instance in reality.
        //
        QTESLAKeyGenerationParameters keyGenerationParameters = new QTESLAKeyGenerationParameters(QTESLASecurityCategory.HEURISTIC_III, QTESLASecureRandomFactory.getFixedNoDiscard(seed, 256));
        QTESLAKeyPairGenerator keyGen = new QTESLAKeyPairGenerator();
        keyGen.init(keyGenerationParameters);
        AsymmetricCipherKeyPair acp = keyGen.generateKeyPair();
        Assert.assertTrue(Arrays.areEqual(publicKey, ((QTESLAPublicKeyParameters)acp.getPublic()).getPublicData()));
        Assert.assertTrue(Arrays.areEqual(sk, ((QTESLAPrivateKeyParameters)acp.getPrivate()).getSecret()));


        QTESLAPrivateKeyParameters qPriv = new QTESLAPrivateKeyParameters(QTESLASecurityCategory.HEURISTIC_III, sk);
        QTESLASigner signer = new QTESLASigner();

        signer.init(true, new ParametersWithRandom(qPriv, QTESLASecureRandomFactory.getFixed(seed, 256)));

        byte[] sig = signer.generateSignature(msg);


        //
        // The expect sig from the C version is [sig][message] so to validate we need to append the message to our generated signature.
        //
        byte[] expectedSig = Hex.decode("9F0753D5B1272BF06813914FCC186531A9792F909AC31EE3A822C7D2D50E3AA2ED50F0E7F608D60A2AAA9F4296A237933482EE126C97428040B41D3126B4A6EBAC01C0D483068B96A34F4E2B571D231FCF4991EBC67D4EDD2C93C55459DE243C280B858F6FF639EE7B6ECEA3602B7C570EFB548A62CFCE7198B43326EB2B30B81169DB2ED9D3D37C8974AE15754B79EBEA35BFB163336F7DEC55E3718B47F7E006F1F39FDCF14F2FDC13AF7FE8ED78B9C7E523D6F71708F22AB7A75872D598291ACE16F661BE6C5301E1B92124076A3A16F214F6D159E1964BF124193F88351B67D2A6659AEFC933DA5341252801C31F48E087D506C512B90E82D87D417392AF0B0142D5894C98DA90B9CBC4C240F97DFE9B9F63F55B5937127B0361C725A77C3C6C1C65CA0CC9CA8980420DDF61BF2E0A1E664F1E80F2ACDA2D39034B44C759155FAD8D4C9A221882B820E64C2D6196DEB5E6891111AD849F5C6220690C90C243ED6E2C7681E7E88E2C57448456CF95A45A35B99E4979D71D052B60F8C593D80B986EF88EF1EF8AD964614A5F09188EDE21C4CE8EA37E1CA158CAA32AB0769E3D207F66F8A10F28F96C2976574BF3C751328A6A8DF35C7DB1F3664025A7417DF6F2CE8B07729EEBE31DD49689063FC4926216EC918C8A321DA87948053D6B87A20F1D1731387E489628B521D061B2205636CFB11A6B42E60C2297C6F013FCA8A84DD79BB322176CC997457A27DC31C34A950167A36706E3FBF1AC4520723DFE2A907C7D5AADF734A5035C3D0037FABA0F1B7302CA32C841BFEDB90EF652D4629254A58DE04D090D0DFFD89628B523AD146BF7D9E1FD59A7253A9058C90B683551C0669BC1136E7226E707BEF2E559420777290BD64876F92E98E66D6BF8DDFDDEE07B9D4B1DF52115A8EC804815987F36DBA353B83726C308AC2DF3CD3496E92A038CF857DA9E4282B6FDEDD4D1D472CFE1DAF08AA73324ED886198A144BF7139722CB84A68B7E5EADADC1DF000D21BAB7DB0180EA2385D7F1BE91F8AA8AEE5DFEC878AF521213BE2961559739F059670225C7B7B2B11B714EFC796115C7820AC9C427D965878D65E9F6EFEFCE62FA9B436660C2B69E3FBA25D7759B8B7A8108F06592A5AC8F6332438B1002DC94289B9BD9857ED3A66E40AF83C6E017BB03D55DA88F01F9A06365B4F4831F33E94598DE9219E5282234A7768AF0F6B3419EEC0A10B596FEA1F3E3EFCACEDE5CB8AA5CD4244BF0A2905DCB7545FE46C956AB273045D9057C1004C00361EE562865473F9DAE65347A1E2F8562A109D6C3930582A0A4720031B8EB210C37C8372401E61BC932392FBD742CDD22EC49DA4C24BD27AC16674FE4C6A052106C30C18A7B53B56E81D49DAD1E65BE358CF8F366D42C2E07E8171663BAC6CE2F59C4DC85D6D8B445B7B4624AC07174CC66B53260EFD225DD4D3490D0FA9C9CFC7559AF3E63CCBD190CD89A35520E2C578AB19703375F767DDE5E9B252E03A890BCFA46940E0AA7B40CA7DFDABC587AE49810E19CCA37849A42F49385B79E11315B4C2E29CB9EBCB92AFB2136F41CC1FDE0AEA10977076D4B5ADD76AF492F8849DDB05909088182A5E21D6427B54EA5F00DDC844D6013905AD13216DE7A9E3E8A829C4318F19C57C11502DB9A4421B889E36A6066FC3FF9D4834F5501A2BE41734213A6652AB6C12F0B8F2C35BABAA5E7DB1EF3D8A9C156D26DF50C525A01B711A97FE256BF22D75D53AE9EAAE036678000221C0D04399658518722270DDE353FDC6249693F9DBD236F7DBB80D758E9FC5D5EB8AE0D5216A6A138401BD99953D01362734738307DAA1B0B1BF9BEEF225039524D83EC8221E23DDC14D3444114B8407EC21F58875491CD9E8B91EEFECF3D795F1885CD3B3F646D9A96166EA8A2C2D4827E820BE0E951610DB061D6FCB04D7A0485E05C02C828E7790E83558134AE997026310B6A863E5955B96DE0308B04909F9F12AED6C06C037C9111991F2046576B625F85E7B79EC952180A62EA34D828E41076C377DB90D44305CCD48F864E52EA57E90A2873A9A0252363D94B3DBADE50DA9E5B9042F41F8C7601D6BFADDF57C86BC899A2DA59DF8F15CEFB8B4A8DDE6800782172F63ADA70D07C60221A8B752F5FE255F423C7AFCCB3E66A64222D07D274410DFEE116FAEE0A16D00FCFD82FA5203C9AA904C4403DF5E9C83442F4826DDFEDD31A16C23197AA690E860DAB754810BD741E076BACA97A9372817062094B4BF22EF1561288D78AFD314F6D28ED67F9F14D9FAE0FA3FA20B55729A3F67D186FE62CE031F4F210EA2700D7DC84B1D4CEEB3522274500DCFCF917B4F8E9BE3700514E6107845D30D751C4F97CED4A44136434BB3CECD22394D37DE9A2825757795C6A3FF2E1EABB09964E869D2D3815A61655E962A9AB3558EDAF450524653635D837D92BA36C8D4044484C1D5FC293AD581BE740FE51ACB4DE1673F035E71BF369E23ABF9994EFA58026424D65EBD382CB6648C8FA000BA0D1DF9FEA4A3E8729F0456C0DCBCE460CF77946378435E20215242DED50907B3698271C47214E7862486334A4F365FD39C3A9346670A29A9A83C2065C131F6A3CA15D870B2D02EE185064FD936BF183196321ECEC4565FF33E4DE00044DCC131E01F0D4544E66E4029D5526A8D9F9E07867F8DEBEBE75E227DFEB31F926A8AAF805B5E88C1893F68BC8E097DB7CAF952D1ED785275F40D71E426991F8B90C4BEB10741B69EAB3C8DF0BC17989EF1DF8D1779D01CC68C27E06F421AC71D1A723275B686A5208FC1D6F7C87EEA6B0C12E90170FFDEA0F906AFA1F6D88AC695DA4A5957CB9406603527948377013A7B6E81EE50B36BE4A227596387F36EBCC210A7CDFB32F3BBBA3E6B8BAB997407C91D7D7CB63CCDBD7FBAACD68DC4DBE78B00986282CDAF027B3F2E182FA797BEEE033D89222B268033600AF2DE0FAC55BBBA6284E97D3C155AEBB2A2A8461DBBDF908899BCF9C1569DC5B74B9AFDD591440AA693B57BD9DE2F8285F16E2CC3608674918F5E0902A5B8770BC356D6FE22E647E9443DFBFCDB46198910660F81FC51A50F6DD4896116050396B6C41C59F6D9D04B4807719E645D501DF7B7B37BEE4B0E095760706C2879F18BA1E3D456F8A1B59049A36B54889DC650E0376262637029F67605061FADD526A5C00FE259530983B1C886DE42FB465326BEF445AA17472AD98865367EE6C0615542B89B8BFE9C5E6E0A510C7DE01FCB102F1DE3A148D7ED7E9B47538D93B250A11D8A959265C9E8DFBDF6124D30D8AB1FB52E692F4DF3BE1A3EC5C8984489C94EA1A56E90CDE1805100834559C1DB100414E5E9A62FF1F30DE89F9D45AA590005FE13436A72FE345B908CA79141CBB1E7B8477D885678A7BC905C59C8F4969DDD07F07847E6E445AA56D2EF6DF38F67239D74DC4936BBF3CD097F64E91FE4D964D2794EAC5B6CD2D7F6DAA494050373C7849F200703AA6307F0405C73EA506C0C66078C7D30099FD749E7256D911ABF6BC27257A2484BB8FB7BA7EB825451C5E7290C05113E464291786C1BA739095D4F62F6CD55B3BE319FA5039EA4A510D4BC17E3A49EB4803B699AEF059F557C7CFE9DA45749449DD8867633DC71BA619AC5119FB4919F6446A73D98429B1D67C09CE975E57D6F4338015026809431C600A69296B40F95F072D0036CCA7ADB5DC706EB5FC8369DF8CE56F56F45B1D3E92DA481AC9B46434EE24C9757CF719E73151772C99F64C3A9A199EFA1936E82B5E431A9D492EF13A318E4F344EBB319FB834C94BFCC00A9FDDEF26F7B2F336C672B13E92E4016AD9FBBBAAC1878D12CD052726A1CD3C08A387C40D1FC00D27E378E4AB70D5842E564A557439EA54C0714E66759C2EB8E73B9815389C4DD7ED38DE052918A361632D06BE279DDFB508BDCFD2B50D7AF90950FD11643E0AB9AC7FA1C1866C34A24F95D407D0BB30669C63E6331BCE40B84C339C8394C8998B69ED6B372A4672DD79E068FBD7782CB3873526D43D8CCF4A4D81C4D8D734FCBFBEADE3D3F8A039FAA2A2C9957E835AD55B22E75BF57BB556AC8");
        Assert.assertTrue(Arrays.areEqual(expectedSig, Arrays.concatenate(sig, msg)));


        //
        // Round trip against the public key generated by the C version.
        //

        QTESLAPublicKeyParameters qPub = new QTESLAPublicKeyParameters(QTESLASecurityCategory.HEURISTIC_III, publicKey);

        QTESLASigner verifier = new QTESLASigner();

        verifier.init(false, qPub);

        assertTrue(verifier.verifySignature(msg, sig));

    }


    public void testSignQ5()
        throws Exception
    {

        byte[] seed = Hex.decode("061550234D158C5EC95595FE04EF7A25767F2E24CC2BC479D09D86DC9ABCFDE7056A8C266F9EF97ED08541DBD2E1FFA1");
        byte[] publicKey = Hex.decode("92A432229C97A4647FB234FFB1515123A715D3B55204365B724684EF94EEFC207889D8C57E13BCDC672C6E4D6BFB912C474AF3ED5292634F38E9092BB324E4523C60DA0747A2C39193356E4E027A0C92E7643A2D23B8C4874B8BA55EFDC00260386CC221FCC2A7B818B62955BB204CBEE7FE992945E19505C430F39E40BAA78E0EE074C950EBCA1B4843B8B4C57DDC056B70B46F6616F82A4DE468BF1040FC59E5F4E0CF8F4F1B92CCB633B5010C70D6A9053C3083792149921254649ECF415E17CEDC2DAFFC9E2C4DE363DEEC435D6F85DBC9A2619C532FD82FD07D2A24D4292B1E879028C662EC859A482285E73E3F8CFED85FE2DDB48B55601D3ADCCC99DD7828DD299DCB77A99FE1A9425687BE0217750367365C063B67158657B8EF21F065064C0DA88AB81D9734C51E656E48DC2E648DC700A137F3823E928E4BA740FFAD16F47833A37FE69800D9688801908637B0AEABA7BD351DFF60323C7246532181A014E708CCB6C8D051756B8B29FE2D14FE99B117F44618E4DA04D6AEC1B84D213A8A065F44ACE8940E89A6126B8E184BC652560FE8D4F713224BC5A12A1863052208D0BB8C2C5479A45F9AF8A915D416E672A201D49CECE59FC4D7A904892442701D74A5469AE37CCBAEFBC39A659485E83C951B2EB224DE585F724F0C4ABA49200541E0FEF56705FF6BD35A8F9557B341596020B81F621EE254A2E73A37B2F0A1C02BE85341850BB1D7265407DA5994989F49013BB1EEC72673A901358F9058EEBBAA8A2761FA33BEE95B21ACE9D3A805823C03AD41DB45BAD8A482483E90C69D3A8128A99FD1D36C59E2B45308050517D3C32FFDEC1AA6236FC4B738D493C841448EE496E183F4800D374084A5983C9F547D1467EB08522588EEA6E7F8B1803FFADAD92DB538811056AE757CA62F9D89EE7BB9AD73E10BEEF62CDC367DBFAA2F34AE1ADB76C9FC5CB68429D93601FBA5EE577C4C9A2AA963040CAB4A6E0A448B1DC6E5695CA8C0FACAEA1389DDDA600EF26C79C9142AD0740D041B5B290D09B79804A8362400A4663DA1281716305F9A306F1CA22C5A2EE12033D64FD906889B1794746519605C4C7AFB2A29A853B3ADC8E54BA86A6FEF000BBB8D59B74746FECD5479851D4F0114F2DE86C0FF4F6C7106CC46AD0D5F588B0AB27E8EC510BEE590996896E7BA45E382440D8B8CDBF84A48B9B0A28347A80A903B2077946EF800E3DE56F1769E4447620BA496DEED025DCDCA29FBABF59A7902F45B005D9680B360160CA881D07DBC4856154106AAC2ACACC73BB0D351D99AF429062D26F1D0062D09DA76111BFF75A90D4F4E7FC626393E36C54954ED2A84AEEC3C2ECCD978DD86DCF08FCBD25AC193301893253E5C52009BBD3025B2D1B44076F013E61BD0C006378EAF9D1FC1EA9772ADD6316B1C686563F1318BC6613D19FC772F968E558AAFC9343C185D4CC9D26D56C64AE127E1469E64AB8AFB1C7C1E5C549E2D002001761AB8B3112D130C4DE31E38D13573572A208F2A2E690149CD3AF25C2012BF77674287833B68168BCE4E9D04A7C8F009797364812322D3390CA241AEDCBA122B558D00D7EF8D880FB30D9F87C08E2D52B055A35001C585A1AA7C745F242B56E270608C741D1008F3D3979D27420801B8D9210A2E024C41C8BC982BA13D81598C47618B890FE9020ECC5C3318C76727FFB1EEBD5434CF335B055356DFDAE383BF050465873101136559DE8294E4B4618699186F349BE32C62F345DD732449374E2E5645F87DC6282CAEF9B10F94072725AD584109BC246C977AC4AAFBA6CAF7C8449C5BF897F6FF5CC7B83C531FE688DCDF2089BAA63CF8C22C2E14B1A4E831ED884800E9013A59A9D5AE6A6770D0548B402C944E11429BB7A4208310AE946A362B1C1832BDF6F63298E538892A60C974179140483F1F8475942E14B468BF168EB43F245DADD4E0143B461AC46CF664D83C949BE4375C2123C8C0E31F38590CFA6BF961EA4468FDDE8AE82B1FB66B42D99883A2C737F40D1AB0FFADE4930CC91418C01D3CA7834057B43B783A62A08406D0D95F04E4FA64C3DB870ADA5595CB6464557E9EE22EF341528BC1E49370349A01C05910776183BCFE11110A38306B2F61ECFA017F1D235A5CC0E7105429F52AE0E21EE60D2E0AF3BE74BA882B98EEC4C346A4D47695D01217A0E179E17821C047A34D8ADD481A6AB613F06E65E21B9D6E0C5E357D3751DDC051F594B56D11B265418A6F8698C648A6BF36367F362C9588A41264F07E7A62DE8A2498BC85E2C1C16FE4B124CE169A29550A8AD9A9A639E06F0E3575BD87407B4207268967C83DD32C3518B057CDE6A34A70494080628BDBC299074A00FC8920AD882BE81A9C4D7D65808A97772C07A327C48B394707251B8084438DEEA6E608059EA93ECE074F620CD5FB829F72986613675CFC544C4B4720A4E6AB232470DCFF2D621B857FF995F92E1193BFD9221519F93CB5AB1083A3716060140E42972400D77A48940E6984A85EE4683652B07F06C6CBEA7D6589C1DF87848B79F1A4DE2EAEF6BD0356C968A1F6C64AC53CF8130E3593938C281DBC4242CF7920817D5A5D5AC5D260A15318D9D6018F1B517F25743E74BBF604A254711A84919922EBBBED5052233FCC925AFBB0EEBC5DEDA152A479A7B62705D26FEC6E531A5B0B53702677DC54365AFC60B171A1817B40F7A66ED9C293164F8A9DDC3464C76DDC12D6B8EE051928426015C46146DD08133D97CFA00DE34DC2149997E122BA3096B786F39285F11F8D0DBEA4B97E474601F77E29982DD268922A5F11BFAECC4BF24268ECBB1F233290DE6FD833BF28822158628434C11B67652A0A2AC121B17B5DDD57435810B484A7D2D063DD82B3C521D8DA5C4DBB0E04202F0B54566232A4E548E381E523F371B86048A4023312B311E95D5127629C900F9CD94D730844A5CF14A9B68C5B0D9B0E44A96A8675EAAC702E5D20E7BA011AA0F3334CCA1287CB943546AC0CA280C1200FD0F0C719029D7A85D368C0519746B90B1999DD336205EE829F72D14CA1C033727309C1EB5FF39E0511251F252EA1D5EF9A08868DD35931C9AC35EA1DC5D32C112634B88EAD2E52FEE06C324A88FF1DF2B85623A328406BEB1D5C2738073128BA8EDD0638422409BB532A28974765E7C472898C10043C4F30391666860E24253B0560AA6474878FC93AA316133D857F382FC15732DAE99E688E427348513132C90F3CC6C6B8180F0B6A7585F1B37A27D09DD1CD30AA5A97F8FA6C4428801D733C59162AD11BEE707CDB2DA963680875424A854A6FA004C8B1A5CF1A3B46F977BC1EA771CCA8294E46966C502E2FDA4421498D073B078738BC22ED9909B82E0A8C0180A37000FF26D853DF1557587DAE18DEEC9E7FD9224310822CE47296E705BEDE4A7010C3907435CE17368869BCCD291055C4C5B18E29E0911D5B49289A9644EB8E30D45AAA9880EB18A8AF34E6B4EF9D8FD3C5DAACF5E81B718BC506BF75D8BD69F9EE3B736FD460D4ED17A3F59C0AAA0322E3A1508F97A11EEAE326F5824944AF7D6AC8DD02B735C037FF932E2CCEB21D7671F153028462A322F5A7C2BE023E7F431A60192EBC3F3BAD3C1C99E67985D3F6EFD6E809AAEF947C1A2558AC7DD288EAF4AC98138A65D5B25A2C765C86F765840B323D0571FC88AC3A6545B581B10CA5B87E4ADEDAC5BBA62F75490DEB6FC9EEF33244769FD0DAF7A2B5FC284DCCCF44D2098406205CF7EF5C99883952CD2ABE24D40FA9472B060D12EDB1ABE7440A87092A3FE3797C0084478A6573B86ABA3215D7FA876E3E21B82EB1721C0961F6870AB4F7C586FB2D26F25D21C0AD957630F300C958941C7471A5E89CDEE1BBA32FE5B0846850BD19734FA9389A88EA6094E20402315D754D91E296648967ED0F5F0F02821A2C9ADA8754AC30684E200114ED299C4A84FC0C0C6E423DA15C2C908A50E1BB6C2191FC84AE3FCFD7C2D9226C1A075939D6A9D26AAECAE8DFD783CC25C0F582C9084BD23FDEAAC701177C2F00C3AF26FDAD62700C04519365CAE7B8DA03219E7B567AED959DBC467EA916097A9B00F5F5494D4A035E98E70281E338E62298607D3E21D78AFA66CD212CC58B747412BF619B47DE2AF35B65DE8808FCADA23AF572972D8262D14B1E9C7215E7AD6A6A91BD68AA53B1583E42B18286FCAC6A6D6442135CA7C78A2CA5C917DAD1DED858D8C1814B27D13E6E083AC9F854B48A8F4D05F874903820902D10795F0916C6D4E70BD7C4B4DBA57FFA455CCE4072780A4C5009B3E57076734D6DD3461F88D3B8A9164E1C0E7196B38D74114871F74C768907EFA5AD9869C9A4212B5853A8B73676ABF4ED4288734417D1170EC4C3927F7431301D06D579B34EFFDC087D4B91E7BC43E384235D6BC61F9B019C3410DA4AB6D2652FB8551BCAB91F0182B7C678081BDC4FB783F21B983183E81509609534534A9AF4AE9BA511C1D250B50F737F6944F82142AAAE0106BDD13760B3B0590D60A78BF75C21A26255F00C2908CCE484744FCB870B76912D840E5ED044E4A73F264633C65C3857056443F319501214D2AC2B23E71CD0DBA447F169550FF21878730C166C320C20611EF5A227CFDC2DC496790231064655D66D2391C7DD691B1D27511B2F80758BC523BA978C23A98718EE7C8638438AE8F1BC2063282B21475D8C411DEB45465247176A62F0D1003268663EA2D465ABB39ED6F6331093675922D6022A1D07094A380AC834A25E45A875C8D96E851C3FDC23E4C426EE4FEAC091FF32D790B7D2DBA7AE7B9F9D7C1632061E2FDE13F2E123042D3AF2DC9762BA616394F588765B2CEDD50297C8C9B81B5464F8A8EA0B6522D3D0249898C8E23E37E2876BBFD4DDCE5A190C9D2C90A05B65D33B8DBF2FD4A5000D5BCC4B2D33DA482A32C979E6016AEA11C7A08B5829C48225265FE77FBE7A5B08BFAD1CD89A19F05C36057CA9EF3DCFD6122248EE2147C752DEBF9700DFA35B853227B24821424540EA918CB4E679EC52E19406935C35D81351A994F82F6EC88808F50D125E12489A48C4906393159CE7CA1BB0C230BD65D916CDBB659859C538BA0C731679A41C428A297E55866F22AAECB44E6659A4E1EE7866D92870BDB5A85A0C43E985B3385E4659679B20B19685081877E7E7C4136920C5D880A0D9B680624E2C5B4B8F2D0D829703FE249DE642A078B283F1DC736008062B7EF7508A46B342554F1C164AE246C201BD3C529E5215C6FA4F653149817B08DE6702A09306EABD1040DAAEC37987713736C254A959C07BB690605E80CD32707349C5D4FE1B1D1D95386DA14AACD3F5D8A67BAF24BAA14BE666CD5DDDEC9099DE64AD1E8EE872842BD596FB707EFE0C76664CF67CF2C25807F8B49ADF0956E6D3E2C98C1EB12CD252197AEE91D85067B1AA2AA2EFF182D8670A144A92A56C29CB950EE4C93791552BEB9D7DE19110A9069D48BAE73128C04334FA2E4C62D760658CF3044306AA7163AF4691B6CA2932897ED8E80C9C974439146B7A06081554742E9B039C9B250D4C2D0210733C3E632DE957D7B1A79D94098686BF4B993598A924A42A3F85684E58A8488DBC4BDC6C515F72A09A7ED9BB59B8FF940028F8358C3ED9A04DDC085D4C85D8F24E17A8959DA6BB2F08592F5C9BB6247175902181BCA1155481EE26E9D1C2612786B022BC73664854F5B18E3260B593642BAAED6D8D93D9D63455952E3F55AE5629550D308AA8F2E304674F440861959C5BB23B400E4C070B0802A5258286DBA32612AE3A6B7E604FC0C29247336EB5AE1D7C3C79754B5A79525F305721E28887973149AC5CBA75B619DF3E0B005C9C0FAB2ECF745C370C5F9C1D97F0372B9B4BE87EEA20B4FE6CADF069511876632CCC99855E4A0800EA8003811F76DE0CBAAC6295B91441415D40C983799BCCB92BB879708E3464CA5DF945C488DAFD26F398E2C03AE60BEA208DE2E315C7F1A20407EE8CA16E733EFC60E80F21DC5890E9EE03C943618D9B123EBF5FE5D498EA5851444013AB62BE1D40DFA2AB2821731515A857F6DDFAC2535BE0C2BBF8481E8B109D702F81A136B3F3C0689B01E5661AF2BECD4204ADE987F593C6543B2BF37948AC4506D69758176AD9A7A736C93A68A681CDA26F19703333DFC0456094704D276808512333CDF2627ED2D9894E8D5472434F48456CD819B51CA0284F9FB2C221E2E5735CC65718CCAE641E3F99B2FDF3F0158EFB810A17FAD52B5ADA16A4FC8EC80E22815BAD762D06EDD3B2FB1E2FB51FDF6B58C39375F9B64D816A516D1F74593740D74F4B8072D3AEF10953FC91EBEAB1A59A3CBC149FBC8E651977B808CDC1B118C70142A19E88D235069A0769B0D3EECCD3EDC0A50A82F8B333C8A8D53780614C16D0CD620F9D509A300AED1648B1B010F2CDD505B1B10CA87139F5D80C96AE0E8AE0BDE8A12098B7BDC60CDC8BED0050E456A54FC679CCD57EF6ACA55DFE0A081099B17859AB8E7F06912084B8794A6D039B1E9BC71189ABA04AD417BA0AE9A9BA9E7C091B2E9771A9F5D8C0EB995167C7F1C12960F6266F2311DEEDC4ABB15139407EBFEC33FA351FDA59710CB069EB235901060A7EBB3C636E07AF0FD8723CECD11AA9821C75165ECD4C8A874AD7869058598B97796CBB83C0DD44B07208B2D6658A1E1601EF86047E020AC2C40EA29155D47BC842FD49A231AAA7D1C45217D33CAD53442B4ABFE691854929EC01B4E7B3BA27A6617B15187A85DAB1416B2E7E3CA3DC6C9E804AFF0E50188F84BD2FCC22AA9A91DD7DFCBDF8845622518BE8E023E125841AA6077D9FD5AE263E2465051600172D1918E47C8A0C3FD2A06445C7ED4F3C849AE0FA6B2792FE2C9F60006AD1510A43C06903E442950B8ECF8BA66945C8861FD0761BF54C3F6A2842569A4EEACA94C8F94812851E197D9136A430A185761AA840C7F4C5E70129B1029F853FAB400AD52714543CC484298BD9A08986B70F89A97B0BAE181276E62D10CFA8DCFB6B24127839A4A05563AD4BF40E1F4C6EB075D4136F948DF69FA1903AD211C98060F549A63185000A4887FE6D1C0765DCBA61CA147242124EF8F0589FA45A4ED438D83FE0BF046F2748CA400AC03F51611A3411243F8FBFAB42CEA1A5A14E1F54FA49A8420A4C509A2A154CF72F1ACE7CBECEB9790C138159ED782B0E39F3C8AC97D9F69F00E5A08404BEC376CD16E595764727B2FA747829A79153081C10257889D8B34750A52BB67A2A0F85D4CA75048857DB18CBD084B1D1AC5A5854789F206D7D6AB81174081EC59D865B1930EC70AF78AEAFE8C58D4A0D4FA7023A61DC66A86EAC96DF4804D24528D2AC29919FF9AE8EDED763620CEB040D69103CBFF9F86C7038C92B65310898D484E5F1006EDA5774E8E44C75F42080EB33A7E9AAA9A0507EF91B548D1447BFBC529A51E9DB257A8AC3B0704D06E92D99A9CE36B4CB63815C61301F67954A522014EE72A42B4D86678927CC12001723D48372C2AA281CC589B988CC671E592F37208BB6D81990EB1589335F6A3D16989BBAF0AA6110A0E6C2A3295346BEA59C34714C733DDA830A74EBB7F1B0AE44B1D7C484865F294400D6DD7D72C535DCCA84D092CC9A6CCF9450C92C1799D5B0222B2E9C14CEA7CAE0A6A7001ACB62502F6760F6425C005C4E83B3628E06DAA6934C0E8254B0BF43A5E8062CB0A2B279DC4C529F5A4D6F3847ADB8BF8449944B312F41C697268C5E210797412E5BCB2B986B5F02AE90A542CB599AC2B0C7462825A9DA77A717AFA848B8A942806F8D944F4951D1E6218B7C26CEA89A1B8E0A2B8E0C83D7A5C41248BDF500443B42E707B50D063883929A9AE8174F0656D6BC40A0600E5FE10FAAA7DE00AC6CF719AA9121BD3E4367E91856040BE1D3094A76CBD230C4EEC56213AB06B1F2D661FD5E61F2774B1DBEA2499313D59A92227C0F1829E42A6619484EE944CC1CB889C18211865B45B0E24303461009D991D7193E5949F19079BCB489FC4305ABE7B903C0804A9CADC001B2604D4DFE914AE6A44886232A662D0490DCA288C5D1F238A2934B27ED22739E552AB47D34699026671825401EB6D1FFA0A58BED2D160149E26525B9F74AB0D62934E4292B8FE90F5DF334F59D1E70ED05BA91C8A041B500EFC662E24A8E21BADFDB2F2C70BE692E2345FCA6BAC1CAE1A278115258DF2A101A9773C80E8FBE3EC453410A7D36E91DF02B644E066B8920F84304D3939086C5361BB29A7A345AB5DA6CD00591F7C0868C2BA7CA096B27C9520971803636ABCC38754CE9CF3A03AB5FC97AAE169755B282E94788EC2B64BF473D651C2A225354CB4AE51BF608B9A69552F857F55A095C99DD091F91B0C198775844A7012E8ADD53897F3F03F5F5751C0E4731F2BA83035E40C21B8DE029567508A10FA82496E65C1292A67111EAA0EF32F35926A6CAF417FDE031455A0B95EC561CA4EB289EE71312B4F03420E3BF3B1AE8E78E90B21E7209A9888FE24DA8B9F0893414A82E68B2D3D9F513A36EB2235E39CE76DF76E07CB9B13C0EF152C3CB8EABDB67602526FF63930B46AEC944BD24F511AA0A97B02F2938B6020E912C81656B906AC63CCF1E28AE5FFBAA6E748EE8C90C6E190EA4034FFB30024119C8B2D569629DC9D152F7E5D06589B8C4FCDFABE3D21B890FC7A29F0F880414622D3AF0746CCF04FACCC5D2AAFFD103DB72FDA6459B915FB5A9F0CD03CA9A673842483D6E3661742E180DF78838D3DD71ED7954BA95BFA8612EFFDC9DBA93F9CF1F4D482F3682D8818CA0E38B60168FEB65C68F10B74881B20D299E701CDE99BF253ACF6BF91E442BAF88C80300C47E893EA952EC338CF0D48171C0B6D9CF69C61EB4E3B59D1017DC2D2E6A66A63D41986EC3F1091EF0A5D0568ADEC4D8FA4A011E2AE0381EA141986CE6E45888DDBB3970C7EEE9E10399C3CC8DA3E07D4ED2753A8CB88395A20D21F7BE051F402571FB49D59BBB85F20C96D9EFF07F0994BA7BFBAC46C5E781CF775C4E286DB13E194837BBFAAE22907D6D624189594426F88AFCDD1C227D0C94EF0CB60E7FB7708849FEDB54F41A68314805A5C0766ACC9F338A46B29EAAC00087AD");
        byte[] sk = Hex.decode("FCFD03D86F7FBD80FCF3D3E74F90FE0201FE111014E0DF20C0FF040DF03FF84F7FC100FD0302B05F0080017DF9FFF5C3971F60BEFF08F4E9C74F500080020409F2EFD77F1F40FFFCF5F1F35F90A0C10504FF27F8BF3FC0C100060522EC5FE01E407FFCF21918E84FDF01020108E4DF2FB09F7E020BEFEF8B20709F017E02FAEFDB37603FC07FFAEA1B14988F01C1FF000328F4EF3FE0FF02FD0C08F89FAF7F4084FF0400D407105FBEFF050FFAB70FC0FF8081FFFDF9E35F5020BE7A05FBFBFFE78F7FC103FBFFDFFB4F50C03F80020AEA4B1800C07E7D0B0A06BCF7EF7E00010204140058CF5F817FFFF2F5FB07909FFF01FC0606F81730C0807DFF0C1C34C03FE0FEFE0503F6E7BF2F5EBF0303FD01380870803F7EF7050EF807C000C08301040A8010C0403FFFFBF3F913B09F40BF81FE11FA0FF0BFBFFE0004030624B82F007F04FEFE1730D8EFDF810204060804F82F7F7E8104F9E70FF8AFBF80800613FA0BF03FFFBC00020010D85FD080017FFF01062060E07FBE03FB08061C00D0DEBE7E0005F053A8BFBF81830314FC0BB060A03F01050AE213E01F8001FEFE0CFC07287060C0830001FE07C84FDF01FFFC00EE076050FF7EFCF9001458E85FE07F0101FF29FCF7CF9F8003FCFB2BDC1F40E0C0FD010DEEDB07C07F3E83FDF90D3408D0803F80FA1A28EC974F9EBD0401F317F46F3FE1BD7F08F2F9435000407D02F9043208A02F7F80FE00F6ED1FB8309EBF00FF06F00BF80FA0FD85FA031C3CB88F7F3F810A0A022468F0BFFF03030C1A00F80FA00002FF0E062078CFC0FE7F00FE03FC7710A03E81F50B0404A02FFFC08205F9FD1BA88F20BD7FFF08FE7360EF608081FCF8211858DFBF42FD00FAE30B4000E03CFCFFF9EFFB07B07E0002F6FDFB53801FC04082FB03F043E83F60C07FFF08061478D0FFBF02FB0416D0EF0F803F01FDF3F9E35F407F407EFD06E2432880407F7DFAFEF927D89F3F7F030501F237609FFF7FFF0115FA47F00F21BF010017F60B68F0DF4002FF130204A06F5F3EFDFDFBFFE7EF6F80BF7E010AFE0308B0C1FE0205F9093088EF5E7FFC050616CC87C0E080F8FA0CEE07784080007B01F911E4FFEF9FBE03FDFE05FCFF3FA08100080D14C017B07FC181FDFF1D08484040C07FFB06FE1F08A000FF7AFB01025C6000607FFE06FA0BDC0770BF7EFD0205F80368D0FF80830806F2F34FC05EFF8000FD09506820DF80FB08F9E7CBE71FDF7EFFFAFAF3BF6FFF9F7F04FFF30720B83F007F82FA0910EC1F218080FBFB0A12E487F05F00FFFDF5E303C00F1F0200FEF20D0C483000BDFD01F5272430202000810001F85728A0A0810001F6F96BC8FF00438302FC15006070BF00FE020D00EC7700414002060FECEF27A09E3D81FD06E4FB9F0FC0BE01FDF4F7234030A0C07D0008081820403FFD03F7EA1D54A8EFC0FE7B0BFFEB0360F040417E0BF7F70720601FC0FFFEF8E53F28E05F7F000502E007C05F5FBE7D03FD2314E86F80FF02FAF7F52F70AF1E828202F0F50FB81FE100840606E2572860C04002FDF5DFAB675060BFFF0DFC09F0AF8FBF8180FAF8F1E70FE0BE00820309F8FB17303FC27A02FB0B70C84F407E0008110EC0CFEFA0BD7AF7F7DFF3D73F20407EFD0D0200F8EF5F01000AF1D9FBDF7FA0017EFC11E81F6880DF7E02FEFC1900C0AF1F00FDFF030434E8CFE03D80FB13FCEFFFCF3FFFFCF6F3E923B0BFFFFFFFFDF80540A8CF9F3F81000C0EA8F76F60C07F03F7093038E09FC07E000E0A0848006180800104003C40B0A0FDFFFE0D20104050A0FE02020604F8972FC1FF80FC011014185000417EFC0AEEBB5FEFFEFDFEF7FFF127D08F20400408FD1DB01730C0FFFBFFFF19D4CF50A0807C04FAFB3B98BF7E3F00FF0ECC0350E07E7F0009020E24E84F9EFDFD04031C04107000810005E70708E87F9F0182F409FC1BC0FFA0807DFAF7F3D78FFFFE3DFBFC0D2410F88F408101FA14F8EFC7DF1FC1FBFC022AFCE73FC07E010909102488E03FFD7E01FC152058D07F7FFFEF090AE85F10014080F4FE03DC2F4020807DFEFCEFD32FD07F807E0312FAA7E7DFC0028406EF1B14905F608101FE0306F8EF7FA1BE84F711F2134060207F0300F4FDEF0F90A03FFF010918F4E7EF9F8001FD1728046870BFC07F0504023060E03FC18105FF11E8FF7FDFFF01FF0A1CC88FFFFF3FFF07090A14D85F3FC07F030BF843C8BF80BEFA0003F01F38F0FE3F7E04F60D3C0030408182FAF023FCB74FC001FDFDF4EBFFEFAF3FFF7F0A102AB8AFFF40FF0004FA090CD06FE13F0100061224D8EF208001FDF7EFEF4FC0FFC1FE02F9035020F0E0BDFEFDF5E11BD0DF9F3E020308FAF72F903F817F05F411E8D730E07F7FFDF60F5038E05FC0FE000DEAF79F805E7F7FFB0810D4DFCF208183F7FB09ECDF9F413E03FE070608E89F60FF8201EAE5F34F2000BE01FF011EF85FB0E07F7FFB06EEFB1790407E00010B1610D83FDF407FFC09D8EB07E07EBF7D010926C0171080408300FA1B2888C0A040830101D223D0AF0040FE08F1F753B83F00BE7FFDEF01E0C79F1F407FFB070CBCEFEF0041000304FAF7F7FFDFBD02FCFBFF273060203FFCFA05FE2FD0DF9F3FFB09FB23BCBF705F81FF010E0000C86FFFFDFC040022F407604080FD04010070B06FA080FE08FE0B30C04F80BF04F8FE133CD0EF00C07BFC0402FC1780FFC1020CF2FD37B8FF20FF84F9F8DB0F00F000C381F61000F047C0417FFE0710FE0B00C0C0BFFDFCF2013010B01F80010EF6EDE34FF0DE418001FCF1EB578F3FBFFEFCF7F7F7D72F40FE00FF09EA3FB0BF204000030C0A3068FFC00082FC110A6C787F20BF810306F8FBC7FF9E3D80030B00C04F2F603E830904FCF76F5F607E8102F505E847409F0080FEEEF1D3479080FE80FB13D423C8C09FBF00F90C025050509F00FA05FED1331820203F01FF030C18F8FFFF3D82021410C40730BF3DFCFEED0FC0CF2F40FF7F08FEE3BFD7BFDE3D82060A0E04801FA0FFFE020E1E14D06F40BE0009FFFDFB5F8F9F7F7F050D061C3850DF4083F90D080C88C0DFBFFEFEF8D5E3772060800104070AEC2750E0FF7EFF0F1A00301020BF7A0201081868C01F017E00F2191C70E07F8001FFEA1720F86FE0808006F713F44F60A0FF010207F4F7A760E07E8306FE11FC977FC0C0FF030738E44F801F027E02F41114A00FA001FD02FD0F04F0DF7E3F02020BD0F76F501F8201FDF60D386810E03F8200F923C8E76FE0FF80FEEDEF13A8FF9EFF7FF905FCD76F801F40FD04EFF7EF871041FF7EFA0C22FC6710A07D7E07020240D83FE141010004FC47B0105F01FFFA01CE2B48DF00C0FD07FFD523607FC1007F000012E0775020C07EF707FA1B4030E0FE8005F51DD0EF6F3FFEFC00F0E10B88901F7F03FD0D08FC2780C0BF7F1103EEE7A73F80BF7EFCFA09D0EFFF20400003FD1730E0CF20408307F80B04B8DFC0FE80FF10F2236850A0BF7D07FD0D18E8DF3F4003FE0E1CCCF70F7FC0FE04FFFBB7DFDF1F7F7DFCFBD923F04FE13F03FF171CEC7FBFBF427FF6F7EFFFA7C09F80800004F653F82F014181FB090EDC0F30E0C003F8F9F50FE03F80BE020DF9F777887F5F7FFE0909EA1310B03FC080FA12FC1FE03F1FC101FEF5FD17E81FC07F0202F7F7272050E0C0800711F6EF1F3020407F06FB07044020E1BDFE0403061CE8DFC03F02FEFA073CE8BF9FBEFD030AEEEF17A0A0FEFE05FAF3EBC70F20807E02F7050470A0FFFF7C050500F08FC07EC27E030EF4F70FB0E0FE80FF01E6A7EF1FC0FE800305FED357A07FC1FD0209DED78F2F60FEFE00FD05FC57809F3F7EFE040E0000C000417F040214F8F7AF9F01FEFFF6E337B83FA0BFFF000620F0CF70408182FDFF2D20D07F603FFFFDF71BFCEF1FA080FE07F20D2828A07E41FEFEFD09EC8F2FBF428001F2E917807FBF407EF8FE03E49FBFA0FDFF0106F8E30780803F7FF2010C2C4870E00081F506F8133830FFFFFBFA0E0618388F9F3F80FEFEDD0BC0BFDF010301080030807060C07E01FDC3F73F90003F8200ECFB17004080BF81050AD8CF37400100010106FE07A0BF9FBC7F00FCE903B09FC0BE04040EE4E3DF9F9F7FFEFCFEF1D7C7EF5FFF7FF7031A1038505F40FDF808FC63D8EFDE807EFD10F633082000C100F4F6EFC30720A03D020003FC0F08A0DF008005FF17F8DF0FE08101FCF70F1C2890A0C081FCEAEB2798101F4281FEF1DFF7E77F203FFFFDFFF5E737702080FF08FC0DF45F60A0FFFFFC0004E43FD04001FEFF0BDAEBDF5F9F7F01F8FDD15700B09F3FFF0105F4077830A07F03FD02F6D3474041817FFE0400D0FF4FA0C2FF04090A2480DF2040FE07F7FF0700B09EBF7FFBFB2714E82F1F4002FB1BEC03A0304040FE01F4F1E717B09FBF80F601EE536820DF4180050702245050FF7F01F9FBDBC74730A0FE810AED071C3060A03F02F8E9FB1BE07F9FC07E07F30B40E0BF7FBF00FE01EE9FD7AF807EFB05FA13DCD71FE17C84F603F24B6020DF8082F7FE07E8570061407E060506F8DF4F9FC001FDF5DD9BE7DF7F0080050B14C0FF0FC07E8103FF1BF83F305F80030406FA1348D0DF007EFF11EACB67B0DF7EFFFFF805FCDF7FFF407B000208FCCF8F5FFF0200F013E05F80DE80FF030E024CD03F20FFFEF90FECFB2FA05FC07E07FA1710886FDF4380F9070ADC97EF5F01030802F2030880BF4183F80E161C38D09FC00305EEF7EFE75F7F41FEFCFBD907F0FFFE808003F111F41F7000028404F8F1D7E7AFC03D8101FFE90340B09FC17EFDEC11EC77CF7E0080FBFB03E457B05FFF80FCF411F867AF7E8100FCFF011010301F028006FF21E8A79000FE7CFA04F40B80E0C041810110F83FF8BF5F82FC05F80FF0E7AFBF3DFEF8031C14504040C17E04FAF37FCF2F00FF00FF0902F47760803FFF0106063CA070DFFE82FCFC1B24A85080FE0101F90FF01FA081000006FE11F82F809F41FD06041424E01F7F40FC0104FE37F8FFDE3E80FF11EE27304F7FFF80FF02F007E8FF3FFF03FEFDFDEF87A0DF3F82FE00FCF727F03F41FC0BF2ED1BA8FF1FFFFC0702F44740E01F8280F813D09F2F0001018106050E082810A08180FD0AFE0BE00FE0007F040D10000830003E7BF7FAF3430850804080FF00FCB7A73F008002FE011A103820604182FB01ECE7E71F807E7EFA071AF8AF6040BF8003F8FD1370CF9FC181030B3820908FFF00020107FE13F8BF20BE0103011E106890604180FCF91944C080BF3EFF0302C86318A05FBDFFF70EE40B282F5FC101FC0006180880FF7FFFFCFC0FF83FA05F8282FFFFF9D34FD0BF808301020EB427A07FFF00FDF901FC67A0C0FF0009062618C87FC0017E05F2DBF34780A07F81FFE4F9EFC73FC0FE7EFAF5F3F3DF1FDF8081FDFED72F003040407FFFF903E8D77FA0BD00FFF711B4A7CF5FC1FDFB08E213E8EF3F3D03FB0F08E4EF8F40FE82FFFE01EC0710FFBF030BF5FB231010DF81FD04060E2848B0BE0000FFFEF5FB5F202102FEF90DE4DB2FE07F80FF0201F0F30760E17D04F8020CFC07F01FC2FFFDF111782800E0C000FF17F03738F09FBF04FC0704C45710013F81FE0014DCDFAF7FC0FEFF09F03F40D0803FFCFDF907D8CFFF1FBF0403EAFBF74F605F82FD040510886FB0800081FBFEE3F3E75FFFBF0001F71BA0EFEF3F3F7FFEEBEBF71F3040C0FC01F9FB0B20205F3F7CF7FAEB2F4870207EFE050016FCB75F9F017FFB03FCDBB79F6000840100DEEB6700FFFC7C040400F42F30A1BF0007EF134C18C0C00082030D222438B0C03D000106042CB84F1F7F81F8090AF4AFEF80807E02FD0320E06FDF8181F3FFF9D367F01F01030102E2E7EFBFDF7E8007FBE517C08F610081FA080E34480060FE7C0202FC3B306040018305F2F127F86FBFFF81FD05E80B18F0FF3F0006FEF9CB1F602143FE08F20F30A85FA00084F8F5F9C367B09F4106F7FD13DCFF8F40FFFD04F0E18BB7EF5FFFFB03F7F91B30107FC0800013F6EFF73FC0007EFA01EAD3B7BF8041810309F4134070207F010404F4F7B79F9F400008F71300B8FF9F8101FCFF05FC1770E0400205EFD92B389000C1FDFF07ECC3FF3F20807F01FDFB37C8509F807F0302FAB7CF6F3F7F010A0406EC9F7F6041FFF7EC018C47AFE101820006E0FBFF1FBF7F82FDF715D817B07FBE81F40512F02F707F40FD0206F013A83F41407EFAFE17E8AF7F80407C04F319F03730E0FFFB04FA0BD02FA0A0C18201FAFD23A84F8081FC04031E5CF8BF60FE8205F90B3430F03FC104030030DC8FB040C07EFB030400C86FDFC080FB0AF8F327103F800003F9E9235890DF3F7EFE0C2A08C89FE07D00090526E83F308000FEFEFA1BF41F8020417E01040428E0AF803F04FAF403F88F8F5F417E08FC09EC5730E03E7E0703F4D3CFFF607E02FFFA030478EF3FC080FD05F433B05F807F830200F6EF7FAFA04004FBF9E3D79F008002FD06F405E4674000C1FDFA03DEB32FD0DFBF8203FC0700F8AF1F408307F5FD17806F40407E00B60E7FB7708849FEDB54F41A68314805A5C0766ACC9F338A46B29EAAC00087AD394D1695059DFF40AE256C5D5EDABFB69F5F40F37A588F50532CA408A8168AB1");


        //
        // Key generration.
        //

        //
        // The QTESLASecureRandomFactory.getFixedNoDiscard(...) is used so the same key values can be generated for a given seed
        // for testing purposes. You MUST use a real SecureRandom instance in reality.
        //
        QTESLAKeyGenerationParameters keyGenerationParameters = new QTESLAKeyGenerationParameters(QTESLASecurityCategory.HEURISTIC_V, QTESLASecureRandomFactory.getFixedNoDiscard(seed, 256));
        QTESLAKeyPairGenerator keyGen = new QTESLAKeyPairGenerator();
        keyGen.init(keyGenerationParameters);
        AsymmetricCipherKeyPair acp = keyGen.generateKeyPair();
        Assert.assertTrue(Arrays.areEqual(publicKey, ((QTESLAPublicKeyParameters)acp.getPublic()).getPublicData()));
        Assert.assertTrue(Arrays.areEqual(sk, ((QTESLAPrivateKeyParameters)acp.getPrivate()).getSecret()));


        byte[] msg = Hex.decode("D81C4D8D734FCBFBEADE3D3F8A039FAA2A2C9957E835AD55B22E75BF57BB556AC8");


        QTESLAPrivateKeyParameters qPriv = new QTESLAPrivateKeyParameters(QTESLASecurityCategory.HEURISTIC_V, sk);
        QTESLASigner signer = new QTESLASigner();

        signer.init(true, new ParametersWithRandom(qPriv, QTESLASecureRandomFactory.getFixed(seed, 256)));

        byte[] sig = signer.generateSignature(msg);


        //
        // The expect sig from the C version is [sig][message] so to validate we need to append the message to our generated signature.
        //
        byte[] expectedSig = Hex.decode("0608B39E631F72C02BA78828C48C6F2D2694DE8B72CD21C4E208A58E95383B00186DFB047FFC20C1BF7F0AEE4E61E9A257346934B04B28BE14DEF8437D1EC697AB69CED6C0C9D4631B16BD673EC15EB9BE3BF27F3829BFB7F1EFA6AE7992E5B0B2ACA8F0086A2860FB66B5C67D789C7316B0553957AE22AAE4AA3D136FC33043632C7C053D6CC46C6DD792D3F31513D9C056EC63CA4FB65E753476C5CBDBF2F56AE1716BCFEE5145C4E701E58211F59075E2EE1EFA29BC1C30E583E3EE3F23C803B33DD92557CB324570B105FD311F0A53E1C573D3911C80F6B1F44B6159402BD5E5D294914CBF87557ECED47D96A18B4F5AB03DAFA904A0BF705E24B0A9D4A66425C23708CAFD0B961FF9E81B40B376A2264D2D94B9EB828591F9F781F8FCB84FBF4FEE46CFDEC062E3D2067DDCBB38FA37334C4A4E2835D4363BECD88B0217B1675480523CB52BCD0CF4273A5255F18BB491FAA688DD401C9AE5AC5FC2DC71D742488CA4CC4A16984BAB469A4F48A143EDCE29EC328AA3B36AB9EE44682FBB92EF56CD67D0E467D7BD4656D00E18D7B55E54E2862D2DFE4A65B6653165CC09384DBD73253B9321F56F1B8A1F7354E8AB1D461FD0B16698191F0001B4BDB4BB1E2A7FB64B46F45C63D6AD7EC3F3C6584A9EF7F4218E776A7920D9717D2F0935AE444358C432E32CE85432A29BE9FC9887C6A26754A368A88ECBDF371E8A2CA1CD8668FA92696665593A56449D10B10751C0C690E9F721B33645C59CC976C1B0F4B245DE89B297A10F95A1C746FF268CD7856721022299C55F5425DFAFAC96823485D1B70A41DCC0CA7D3C2F27325E06ECD2EFC25B472D533487243991364A624AB4CAF0E5DE1256EDC8808AF5DED94141B49E9AE8C8C54A028C56A50DD863647065377997E6E71CE5BB4A0925BE4B55698D062BDFAEA7F968353CBEFD7EE2F7CA3F752C04A9E4CF0E82A802C6A04DCAD1E9B83786A21108ADCCFFB7B158B532E20BFF2BB62728411B6AEEB4BEA9356787038057E03C433C2331B167A8FFDEF8EF714C8195C0D49643E4E662100F227C63DE21AC5E0611145D5F61D2CF31A29233FF4A78A8723F24E98E38CF8B6CE39EA5ECE01494EDE56C898C4DF128D83285189E0F570EBD7D76ADF05C9B7D82F3E7FBFE9264D9C671C2CAF4F13D9C5DD72470BFA342842CC86E9E857A8086A14FAC1C96A464891947317FACEB002A574CD3E3645F0FC34C15E544B8FA99263EB6CE62C5840FA288CE9874C25335E2081C3C74590F0B5C32AC0A8736CA7A3F04E2558F9F147B7966C512EA41648A15620470A79FFA3EBF56C34C76194197E8AB20464C20173C5A84192A8FCB136B3E9F2C5409C11546888E203910965444FA8044D870680E311A71509B90C701DD090891DBDE856A4BBBA8E62411BB24BB34D8559BBFB1B442F2056339301EF9EEA037EFF4A71D977E6B15D9737A9A7651C200D80293A4ED986D1373D1D9EEB6ABE02151633CE37FAC67FD975CA64DF15EE8E3D345D33BA99847EA33E7A37F9913FB79C633430E5B1C9105225C1C6FA4075CEBBABB5ADD4541665582EBEC51788A8E06B65C757C8CF293FD1509888EC9024D5D3037DB4B86FE928E652BAAFAC4665B21BB9CD9CA97B5A2CA56800BD6FBE1DF3F1D43281CE7E79AACD7CA3126C1F675062A80A88088B3C52B65B7500629B586007DBC893C2EE43C619D24D476D8731C3C6B8A9B9787E9C41C1BA0AAFE92B2CB40E87263A0E16DBF7FA70B9B3AC119CBC92F388FE8A0865AC91F016D597E75D82A5AAF7EC5EF5DFA38BBCA9924772A1A07BA0350E38F7E49C4F856ACD59AB6D56DF09789F70F5C000C332CB37F2206871178CDE333138E59164EDED696FA75BF83B5A157E4E7E8EA3511E1B55FD4A442106EE0CD58D11302E984B1DD6005EC90DDB11F5DDD95AF0C8C2BC12A852C8C5FA4787193D4A148B483E71844DA67D65DD0C85A9DEB6BA27D5979E557446E5DB4D6D5B2E35499B15D64358274801BC4C445253F872D0C1E0F8A093E9222811900AA2EE8620F12A40F5652A5B4A302C3B16B81A4950FDBB23842807E3529C47D3C97767629C057DC234252CADB24B3376182A56A2F3C7BE56C3F13D4A22D0B1DB32CB0D5E8CBD1400489AF19C03FD96F96929690023675E41E48F1E7A198B7DD84C0219A78AE43976023C88044D6E470D74B1FE4C1B0D9B4B8135C3D57735B9A32DD06DC0E944ABC34633D617B60D623043EAED498FE524F421CAEF8870799411E1245DC771C04E2E07B44EE56305B6DE027FCD5FC4B354056F1CF4402E3DB32E7A05717E49CDC5ED863729C8D0CE53391840EBCF79681E2421C21309DBAAA57533FA45CD004A188FE2BB4BD22B14BA30CD729FAF5B225ADAF7D526CCF07BB06241CA24A0DE94F8C680338636EED3D2E5A3820706B2C83BCE687C9B0AE146A3AE848CF6F28F7EE146E567F2B54590E73A968F9429DC8A70BD7D484946CB62ECD025F16F5E074F15E1366495D194B235EFFCE2D56F16892D95493CA1FA8CBA7CCEEA60A39DAEA5CDAD4BCA4FC708DFD1CEC37AD6BDD9E9A7910E17A6B3EA53A75447DD93794C3436EEE78F669C02BCDAE0D869295B799AEBDB1D48E9140FCEA39CE62B98AF18A27008B864EC3FEC43ED1B57D12A00CE6F2460E18FF8E6D195E882F50A952E207AC8319CCBE0C8CBF2E4777D990A3E20C0E285B7DD3BC56265D7C296C4A45511152443DC635A9F2106C78D2D08E6D0BBD386553EFC51C69294DC1995FD857D99F66EEFFA38E83537D7F4C3522F6EC0622A75AAD576398CE43C17F2DA8D71F6F890CF39F2918A92CF21515959762E104F0679C5C130AEC2A8F958A129627C38EBE0A1C39F9CCCF6390248863DFEFD8824CE59D03CF1102D3D2FAF7F18CFCD01C66204FF0DE09D13EEEAC1A2709D4D6192B482561ABF2C89E3FD88843A44F7AFB13129A59DE35CD3E3694E30A184BF9B29679F57F9D43A15072170266CF82A1BB81D9F542A387ADC65EBEBB890E86CCCDBCD5607E90AF4F0FC615DF73E78D3B6AD0D9FA6BEE21AECB90B99141F87976008CB6832D810546E4B868943971EEEB589D272ACA0A39C059040B92D21FA886ED921023F0DBC761456B68ADA8BFA2CEDDDF701533C9D007D3F52CF2BEA463BC3A219202F5C91AB0D93E85049BA4BBF912062F44178BCD2B463DA964BCC55D5636E645BC31A58BE4D92BB46DD2231199DCC332FFE8BD0F0D8C13135E14C4ACB4C1D091B33A1B5512522D388FBD5DF019EEDF07EFB14B72F47A05FC8C0D5A5D7C9FD1B1365758596BD13D8DE69742B0690C47FD4691DA980B15BB9F0526405A7BA8945A8D104B3B954E321612A537357E63B6269ED28BA4301C51C046686DE3D11C38D396902DCE05989CBE9B14F222F4890759C2EAD2CF3D145C753B0ACEE3D78C734BA1F22D28AEA62CCF88FE13D65EAB138C15D64FB52EC9279AB6336B502946324F94D6D929DFA99BB9E7307651A0F98A822F6F3B1DA0549E6E2C287EF9077A3ECFE21A596016FCB729A9F1F0A7AD04C9AE3332C1766CF8DCE38B8876384FE94172FD2CA683E0D9E3011EFC90B9EA2295B3D28FBFE6EF898D6CA3E3EA68B361BE39021ED9AF10B2C963F2D99CE86EB1B1BCB65B464A136360753261478F432CAA03EEDF318FCDF182626F5E765EB20F7FC0674BA533DB6DB12C7E0720CBF5FB44CE82BB45F274F220D589E4338D0B257D7C5C2E454A56DBDC8B930AE949877FF37B5A1F209F05203CB98742A8EEBDFC49EA6F1770449B6627838FEA7CDC423CD94125C9D2C4BA67379D3C4EF896E6BC868FDF90FF878CDECA6052D6EC6409CC4FBBAE6FDE5B429DC0E726A05663FCD397C2B1A4995309850A7A259C3226EEEE46074BD1907D5EE213CDAA635514493EBDB869A0104EE33C4E02A52EBF33C771AEABCC2397C6936CB769E828F710156E622DC973C652F37D9F848D411CA2688E6A46C1406664BFEC2552EB78CBD7DF7B7DC776846622720A1040D70F98BA8C1FF0D2AF40038C534F3D0DAA0F87DA50B496002924376E686ECB8A09FD3D2B193CE4F796E97986795D2C21568E13A803373C125FFD9BAA042E5354D139888CD636B14FDD1B9416E9F9AFE8BB7EB15FF99AD8621BF62AD8633D821806939578ED7709E55B6C69905CD767B50BAFEB05029EDD2E83ACD1756850C2C9D6F2F903C9BFC7854E4DABC8DC63F585342905C3CE058136C2BFA98545FBCDD5A820DA69BE5CBA47AA04B69218A83857C7E0E17B443C1EE56E72D26934226B388D8716BA39661A8FC552CF4730F7831315893EBA11F6EEC1815E22933EC7E1B2D2227E914F3AC1ACF290627C56530B450F7B250EFBF00031AE1E1BD61EEAD26010736F029E5220A1BD3F979EF49E1342D2F5E7AF11966606E6A5349928A95AACEC78B1927356453B81A5666F64AE8324B138F09F06F26AC0B40C7DB0B2C93CC86B9A1167B3B354D5EDE54BF96C115EF7F0A47FF14B225D1A5EDF2928592F65752390E4ED73720D1E2AEDDDD90F203C57F36C592D3FAA86AD69C9DD03164135D74C7C5BD87EA788262BC4346D7C86D5452746B3E7D1FF7DED8561F82E6422F8F38396A48FBEDA2EB10A464155EAA7DB4F0242E324674B0763270E8D0E6317B02E85E7B16FD11FB858669793ED7278A61F346F7B36265DC307A07265C16E5FD97F3AB02A7A2DADD5774276DE662285FA2552BAB226DAC0098779007D194D656D128B8CA6C7331061F69FC06E96151FD3C9D164E1BD98A96FD9EEB6B63AE7B1E0E3AA4480A8D8D975DCBEB0D72ABE92C5628D5E67AE682CACA992C1D6CE7B31B30CEB1BB6921B1C61DA0F6FFF3EAA893F2ABCDB2B7855F809EDADAD5138C08EAD66EFD3E84B87B6D807D340E5C3D8BB9F906ED961EAE1B59268B74037E943F28E587F0358A6753F8E86A861607483F9DBEA5B935555006CBFB6A0269C0D15E5FBA25B5DFDA17AE027F5E09011534A5329B358A35F146B41D08875FEEA676FD5AAE0872E96106D813A6F8246BC7530678A63FD77BE4C294F0CDE0AB2F6BC27E9EBB337F7713CD521637268821E13280ABD9B76AD462DF750CF8379D8B89B2BCCAD4F99C7C52FFDB341DC90EB2ED9B61CF8D8C6DC725D5BEF9696ED81B76DF5614EFFE255D769F724819D97E2943CB996AA84F7C3D9883471DFFFD8335372CF4F578D934FF1F0A17335352BE7F67BDED0E33D647E55A643098EF35EC6C5340FED82AA3EE6D178241D08A789A0ED8BE14EBC7B2B3A1FE98041D78DA55C379697DA194740A8C74097DC0C2E47F39531FBC011D79B2AE5494E73CAFE828797FB8FF9ACE7F20648606823BC3B401827F2143EA8E3543110BDDEBC8E6448BE37A802CD93CE49CCD70A4D3BDEF483062F22D68F0D877534FCCB27B4E67D4DDB1FBFD83681EBB85337EBAAFC7B9D09D734B36012F191FA85043E10CBA181837A77216448C582D30D542281644890C14E8DA15F3B095C0474C58E971F75D8F979D73E0D16546463227DB4C101C83A131A71DFB981D045CDC8798374780B611DB22001E28BC1391C455AB8C1A9CBEF03FF651E3A7797E2059D03FB18FCDF2408631683118786EA48CD3B8B951F33579A6D33E8334F2192F15552B3DA8859B49B06BB3A6E83B8946EF41C6FA8E56E5CF7D3147EF68243F99E59C081186DE2AA5FAA1536FBAAA5ADA048E7710E59125661F3ECF5F61BA54527F9E43E2CFF37C31209F35C66850AD195A8AFCC3D4BA51ABF660C5EB63C716828EBF3C7A51D8314832533B025A99F1FE0C52469AFCCDFCAAD2F271C986952B985759B27EAB84CB57D1CD7E22914A5F2831DC6842B170C059269ECCB7D79549AFCB48EAAB37398AAC7233F8850D9CCF53092C3E36738ECA2DF4BD349EC8EAF313910B1A0AEF889AA4384AE33E603ACB6046159FDB0D96A2491F97B95B65EA4C63BBA327BC3843CA4EA95785C99D7608AD306805B5E3911BDAA24D62C12C853F1729BCFEAD92A9873C2D8FA102F748022B607530769738AC92BB2A1601FA6BF5811879081335059442F972614491D3E3E646A590B12D96798DA742B34564B3C459FA5AE98E6314E095890AD79424E0EC2B64B549FB47BDA17C4C504BEC548F634F2BC4F050463519DE3553D728AAD116648CE027221CABE5824B749F6C9102972F32BBDD202842C5FF035CB0AA98BE54BF7F1BE78D53AD1043102CAB3399A58F80B7C13B1E3B7CAEED3249A049A72DB5F57071C398383CA4D6002F859DD978C5D13D30600A01CC24506B702E8D3FD7775A4761EEDED8C1DE2B5C8179B6199E0E8B6FF1B211A113BECD7ACB28B6CC1C06E98194E7CB69E455F1D3F244F53FCA279CBD1AA739CE69447BA5D554ABEA552725BA1B328D1732E4121ECB3C20DF1B5D004F443DADC49FACF33805EBFBF126C7B7779BDE5B92994B26BE1E4AD669CD547629F055D08259FCBED38D58391012E5B3FB936812BC9F0E3B368132DA8115D5D4E03201B57523F026FB46E7B3A4DFF4B257E10DBF8A052A3188DFDCDCD98AEF19A654A9865652F73BDF17DB62572024D82155D54C2B284E67EAFB5F25BC8F5FC3D11E751E8E9E50CF08F297CF29C5187E0148EF1723418B4845ED3E707FBC26C2B0DC829FC3650E04A78707EF299F8F8FBE274C2B329CA1457E0A15B40AD69A9D3B1C63F0532CBCA81C3D8AF201128A566D5F25FF06FE1D239569887855F4668D1F66A38C90C53A4D0E0EB5D2AFF8D4332F6B72209E57F90BB2D70792A2ADD32FE83FD7894714C9F5F1A53D4B62CD3B8B1A4322BA3BA533AE687D9AFED1FC7430D67732DE79C64DAE8B422628B74C63CF47C7D9F0EADFCB62D383651298F2D36008C63C7C979748B9ACB6794F5EC3DFA14D3D70F234EC7F1D4E8116E122AB6E35EED8D98DD55DAA7DDA972C5C3C2AC5B7AEB44BF906B20C34CE29B80E76DE58071F300F828DEE931C8F30148D72A65177401B751411D1C8838A865C0DF3FAFABF195C70823943A34A8EAC8956D8041D6090DDDA8265125DB30A89339BD7F76A471FFC3E1CC36DC11DDD9352C525562AAD8C9B01FA931AC3A54EAE03A3AFC1B2E1B6D651AB921070A6BD7BEB607DC76D0FDE9D1D3AC9A12340607023A425996A468DC9931BDA728EFD2B2F2DC4745C9552E3C032DFE3969EF094581F6F212F386CB3313C890DF40E4A5D4CAF87E0D0132FEE1D47BE79273AB1F86FD8088A22D399F980F7AF4FFA171990012F9E3280AB7DF0600B3ECD3F5BEF4EDFE13781A05560E6D39F68798D17B3FF9225CD72676F8AF813D44F82972742EE8A433A2C90602FB5B90B81D9FA52626301B32039381860249545A009B8894DB575F1E9215B7A71B233E561258FE4AEC1B79ACE0CEAB29743E819E5578F92E57F37B741B5CD17FEBE85B21ECE9D51DE2686C100577A35C01417AB46685A2ABA108884A791374DAB4BE543D89E830E34B783AACE6B8A4881F938327F8394D3195FC9816B355A944B3E47DB08D2334EC97B96357F9B08C4E8452F79FFF2529C9E91AA3C252CF6EDFA2E01AC27F1F2E270375FE0BEBC09281344102ECD7EEDA85EDEEE02F39CABAE0F66A4EF557DA4B204A7196BFFF7F157570497E916CCA8FECEAE9EC66E65F51F240E721D64EBA672398959783808C4541935C2881657E44C4A9F0BB8FB3C0225A8FCD73EDD39218759797CCC55A824A957DD980F88A88AB183004A1435193DDCCD1FCEAB1D0F39C0C49D09040DFE85251E6A104DC50744AB36F23BBB261E5DC849B579B09971B7033BC244133BDC0A954BF881EB441AEDDE4480262E5AE778EF453775DDC65DB64C63C8115636958D95CFA1482E8D438B0058A44A0E731338AD20A8A4131F16F442A0E2B6AB2C44837BB14D5C03E893BDE0676CE9E4E48C2F72A9A2C0618B9CAE3E394058BDF9ECE98A7664F81F470F9A4A47F138C48B33B787B2054A990806B4509CEAA35BABA81D19D8CEC1A4BF1CC7874C0573D58BEB9CA430F1350C3322A0D384D0824388EEEFB1321AB09F41525F981A81CFECD9D70910C12FC1C60DFD6F7A9089D02C7602E6F0DFB06EC3074E3A4CD61F459DB534E40D1A54A583C841253B00DE1C4D4477A19BD410D07A48A454AF44398C02217E933A1DD5B3DB8B9F3DCB0F6214A58D52F50497EE6BDEC58F473E1790BB286B8F60E4BAC5C126C54CA5FCE3D6F49F0E3504614BE2F1DCE6B14D2D9DCAD91112B87BC71070ECDE520B79D34F271B94FF5619510BCE23EEB8E83865D56B46D3C48E2F28A0394F8E4F600268169C6EDE5DC6B7BF057D526B46C9ACB1A61C2CB53C4AD0A02274A1633875A6C38722F120288D8CF6AE057F1B782B51DCE1EE8FC050FE526992BB0D80D03D5CE772F580F7D1E1213B9095CCD1554CD08CB63BD9248BE6891526B56F444D5D81C4D8D734FCBFBEADE3D3F8A039FAA2A2C9957E835AD55B22E75BF57BB556AC8");

        byte[] generatedSig = Arrays.concatenate(sig, msg);

        Assert.assertTrue(Arrays.areEqual(expectedSig, generatedSig));


        //
        // Round trip against the public key generated by the C version.
        //

        QTESLAPublicKeyParameters qPub = new QTESLAPublicKeyParameters(QTESLASecurityCategory.HEURISTIC_V, publicKey);

        QTESLASigner verifier = new QTESLASigner();

        verifier.init(false, qPub);

        assertTrue(verifier.verifySignature(msg, sig));

    }


    public void testSignQ5Size()
        throws Exception
    {

        byte[] seed = Hex.decode("BFF58FDA9DB4C2D8BD02E4647868D4A2FA12500A65CA4C9F918B505707FA775951018D9149C97D443EA16B07DD68435B");
        byte[] publicKey = Hex.decode("976357E9BA3591411285CA585EE79F24A8991634403F889F03729D439C689555B198AEC628F566B8D6B0880B60E35D800A4D533523FCE59C8DBE94FE73445A93455CEA1A45E2C7E2D4B9CCEFD22EFE52AEB5655781A206C6E49D0C7AB7C3E8CBD401A26E1D0B09650E5E34ADFA9D5360945CBB1925814B9A595BD5D09C8A8D51F27F0A0277D95A190595285037B349EDBD18EC323BE62EE0D3B459121F531449EFD11704C04FA9D35CE5893AB17DB1C552B8CC27F333AB4EDA203A2C05B0411684773DFAF19A19859893554D526C8D2680D991C96770636347156B195C085A863168324553A9CB811E763936FA7C11E1431645D11F604652FB4E1113B415A49198D1C73686538D4062A7248CF0D524820C6B413F3180EE151A254E523424F0B955A42A7A82C2644B29E502999A779D3183F3D0A511B5282587221101469221AA29031AB90F34D5A5B0C71F80DB7CD4DAA501FACEEB0CABBB172971588D6B0E0AEF862D295CF26D96C2F24F1FEEA21B91908153D8F7CA93B00963D4203DF30E5686B44985167385574C8D8848E6BD48D5E680006C99590CA0BC469D3E9CE5BF5F47553A5DCC1110465C08C2A34B639B0944C9E5605B78CE72B72A2E3249213B1D55CEFE839FCC022384F09D617565C45415D3BA063C9125FC0B3B745AF3D74E182A13A311248B6C341D734C062E238307FFE80281412EE2D8A64D34C00E76D4B4194096DDCA83072DB62DB9F42D14D71570918038124E48C7943E4313672F1B8E6F22634BD2E93E2A36FD2EDAC7C0227A5B735DBD9B71055A1F94571789FE4D2401B6118F57D11241380E67E0CC9DAE9026AECD0FF8506BB51BA52BCE0261769AF09B12F28588A1286E825444866F11661CB9E3814324917A10C3CE634CFF3E3E44EB99B18DC888A3AB1D570FCAE085F8B033DD0675B2343252C6407B8E14FA4D41BE4731A052C6C4DF8D80F5890868B121226F0F45AAF5422E89CEB99839BE8B9FED44DCC0ACBA4C1C3E3EF951EF1D1313947E4B17DCA55C21D0E06069A96007FDD994FF537B7AE718FABEB6895C98239D1FC33C43311429C2646DC4EA47776309291D7AA7F6E962CEF3DD4CDC9F5B896C84003A631D32943A821CC430CBA9B75C2888BEC60E7F3F30F977BA61C8F31B2BC5298422F0E46413C1B9D6D187590844D4D4B0DA52C7CDF2C8920309F8BB1F8CEF1076FC9889514C454A9FFBF4AF18F679261935262D628207C595AB307DD44F8B5B7F612E85D0B282161F6F10EB413D91A2722048FCF651D546841E5C238CA9C19828C547C48A658909E059737D5F4044AD1849013E0CDDCDDD4C8D65D6A924156D8D68FA0EB4CC1C4B25479188FFA50F917A0AACC942733BBDCE5A053D030BD81D4834E2F35DC575BC697BC87DD0D0E626E3B58E8EF8588F0E4FC00F54A2114E8D519A051215FD0D84C2F76EAD0AC874197D7A19249711A13E1045D0D57AE34CF601093260D6B559C0113D5BBAA4F12C40D00FD48434216D3A1E16EDDDB00739B3C8E14C742EED74496CA1D3522D83A3460B51CCB7D5B990C396FD0FAE6B178C6FFFD198D60336899ED8CB078C58ECB11F13923CE315BDBF6788F49818073982D9C8086AC520C2A2B49175CE378CE91672C5380EF2DE309A8C43D18E48F1BE72FFA3E09DDCFBB3F1575AD9DF2F08BD73114233756B281C916B66EC0CBB3C3571D2D3BB40C8161094460241FB6556683E49D4B55EE88CBD643CE0D6624D823EA629BD2A5811D8A341A8D892CCFC4D43C022C5685FB7FDBA8DD66D78A1FCF0504D0BE34849125A360443F3DC04A6FE3762E2130BB3217E894A6D3F22A21B760DAC297065169321EA6663CDA88D09B7642F78894D3CA140284D5A2A77710DC80A502B55D63DBADCBF9945391295F524B4E181E15B0AC31E71870158123520D028C0A16A6A8FD15E41430AD78E2B982C9169DB96876876EFE5276F42109428D91604B1ABA833872203A0EB0DC5D63BB871B52210035C7435123CA800E52E45550C919D19E13D8240CA98992345FEEAD908602DD30E76AC6A2573DF5491415F5973C7CE64EA4263D30FD136F84A25BC29D551B8B132259D316357BC403758E73CD4751950149A5684A6EF10F2ACD5CF63D1D9863995BF87DCF902467373D03FCC763A3C679990A1068F0590DB0647F4E6E7D0C08D617A8504498D31687F63351E1B150BE6131B304C847B290C5E770199F38730607531BF21EC78CCD4ED7BC7DD3B15F692A3652E367083839ABBE6439EB71101F503B5DA110B5FA70C8334EA9581CC255DB75CA871604A28FEC806FE470EC39AD55255E90727C46669956DBA956FA13F1128A938F6A2D7BC9D8DE6C92013CB7A880EF166F49D5543564DD3BF479985C6402595CAC25F435ED39455D22370F677D0E35236E58BD270F138C63ECA9E298015C508EB5CA92933D6E212846F220FAA71349A1206E8039757576A53C922008EBA80AFCCCCA75139E78C234C9020814BC58945852DEA0BA9416B8647C0D649BEED6831601C3500CB41AB68CC38B5343AEFADDD7989C06B889D62881DE0CE0FA5F850E474594348176E373FD7FD27F322F4A35312FD68033D5039C6BD11F90A114FD60DF67159D06572E6ACF8D2E9D542994942F08A7B870528507BD5144AFD2D815A65B427329C680E33048F446003288343F9CC12F44E2CC7BDB8011C75A057C5E4EA523C70A039982783ED5C9EF9D11AFFC2202D097E25EB6EC05A4C6792315FD54D34D712A8157AEB5983B7F60C77749221719E7C0E59C5A60125673A833687CD059508120238ECA992C7160ECF6B5F571D8F5BC063E6952A5C0B81A62BB6C2B015190AA355FE9400876DD9BF9380D60DB5868685ADB037FF96070D177C03C90C803EC1087F04FF34A2AB818FCDC011A575AB837508CBA1A1FF7F02EA8B7CE24AADE8EB52A5A4929F155D4386D6C3EDBB18318811D15B912945E03364904613B748CBCC0417FA9E04F5B9B9557B471B17F67431BC4EC1836111F3311268FD2EBC5F3679D3FBE536CE155B53520E481B48AFFAA68811C8CDB3333BE4FBF45FA0069D69CB16D05A2F7895A1B007304E054C9E782052BFD8B958E211EF2E45233F1B40DD29F1989694D49946AE6B4B0C8C0DEC1995C25B9F8975004967AA41ADF1D8141F4183C87C602CB4BF557A3C76618FDE3D7169661F09354355A6BACA9597281DE226D4DDFEED217FF204F4BD0D41B97389DCEA148B43C5106B0C8157F9C06390F5E9E5C5BC281004EB4D94A0ABF7594B4FF32557767F46F903F0A30E3688DB0F549A5BC2D16BA93301B346475B00A74252DC94BEC4366509C1634C16F40F7032D8651C91D4A6755AE495D9D802B363863383FF5C34D51085E81DAA85D7C3D00C4B4D1310E1C84F8E857E4C1DF9D4206758B2A082D2E0909317E5293A7C3B0D9DEFFE369454C9B4AD649A9D0DA8B78FA2B03EC53B2B6A31CF4934EDB50353C25AD09125192A7F0C31967245C5C14C61696A9516395D2E24904ACB5D200F2A554D493537F26A07003BBB1A4498676C6FF2D11CC2143044490CD05AA498BD10BE3700D2A51AFA757E1941F842E6244F5EA35967330CB1BBBF40F753036CAD5B39BF2955DBDAE4F4EC1F5D10047A1DC061C47EF5BEF49AD7D526C89A47A57968409876433C1C089818D0690445E5DB8B90913B59FB4E02FCB4BA8766D10ADF056EABFD260DC8F4820A6AC3A66F4AB5B88374C42E25BC360A8FB9735B6911D1313CE1ABB00CE04D5FAA9C10213A97D73FCD4C3DBE2CE3D647EC42C287396A4E400F55ED1F39A8CD174010AE5A3442062B310AC9DB7FA5697A55FF1816FA16FC8901FDA536A055380B4339526FED023B60B3CC959F5D1B4A19353CD132A2A169C5522F4BF03C3F19B46B02B1F40D24C0009C14F6799639526105077F13488FE928618E2EF2FAF3D16DC61585BF15E9FCE42038B204FED656D8254CC87730432822512A3D08B66A7A783E88B1F98ADAC40D2AC1E32930D0FC84480BC1587770CF0210915EC021DED64EE4633C58CB6111648D3550975F45B90B4C3D777964F4C07EA388738C7AB6B1FB043957E0A3A28785083171E03F09CBF0A395EA99E22E4B3DA24C998E9F53C11B067EDE3A60AFFDE16EDEA106675886D81FFB0AB0D8279C0416CE8B648C3FADC65B3C3B5B82408BDAD06E52A69EC29D32F94099F7CE5BD47CCDEB3EFCB92E71610F89E91476652486789703D0963146DA93185D5D2FF546297293C5CA884369226C526CC1C3759715D59BFF4480098D7DCE2881624C5581D44AE76D6EA5A144F780779B47203F817DF0A0B1A4E525C7514B1E31510177802923812399011FD25AED247728D2B46421B740320A140EE45EF59E6D2280FA190DF524233552F452BFE551E348AD665B6AECFCF028AD6068A1547C714503F6E1C931B557634C5950D83BE20DE29D244F8111E2C84DD66E34F8E5E8D04F577BA408BCFB4CC99C01A5C9DDA60AA69C020545A2F9931C587F0570801CF0722A7845DBA5838897AA35D714C85D9EC0DBD5C51274178348CACA15F06E7C014CB935FD219DBA8268E1C7A67D683ED778D2547DFD0E556C3B0C1195701EAE8CF96D104EF40759B6E1737604120D0426A3D7EB94C50F92EE309A0DDA7EFAC0CE29CF2A06772310CD8C19C7D7ED28B130652E9810C07310CF25A099B497F5F1F9DAEE32392C18DC4175F946BF6100245905B4956651553FC79767456F6E7A020C7661E169B0785B073F41479A8D7BBC340081C9B7DAA9D23F439A7C0C071270BC69164D50518451205002F3B70898557B702DDC3C6588A07141592BD9B4F80441C03004A83A6688ED0EF7083B9FC0F7E89F4DA46AC2C429110EA521CAAC3CB6F5058F1F8C757C5283B72566CE75C257DFF6C61F40C86DF9B93802CFD282446E450B00C959E38975B2579089462C754F4569E7BF227E9519E78B29B63AF8600227832B33469615176A131E950469720686953DF205E50595091F0570A1F152E3CF02CA67A6590E1CD59557C3F6EF28999953ED9297B66E3409F4856B898843A90ABD331FB48BBFC40DEB2B3F35112AC7CC8D9EC6A705FA57B784C522D4A2F887892D0D6AE5DD4C502E67AA9E1FECE32C1F96C8CD933FD0941E994BAD4BCEC8B615A66FE2B5E615C4593677D8711802E12402B2424CD8195B926F5C7FCDB0B9445A65537C7FF5A46D8ED66569730777FD1475CF920D35B1F2E0704A4163110E6A9DCCB523840A35CF17083465E0554D93E8D6E53F854A0B1AC5DFE178A251D730EB1578FB3244EEF2C49A2160AC29C11AF0044E8DD4255E998206CB843E9C7010EA8D25647044E4A25B61570CDB8549AC36F2723516DC1C9311F1D986D54C83D7F98CD1C9EC6AB64EE545F7BB83B8529920F91D8122DEDD166E81CD2ACD80F15B6080974461137064A299B50C18F1998BB58A9891DC88C5FB28412C21A2ACFD9E7177670CA0B441A27764E891F74499E64B6DF82F8D9F37AC09D5D01C55030F172EE4DF2279D010D5F55717312F2150A12041AA53966774DA37074C3998234DC722A123B8017C641213F56A2C6A80B20FAC05F5AF642263D351DC5907574615E9964FE2DBF3D934C717113C9EB6D34611AF7EBC525DD23B4059FE9A2E0B24388D655283BE2514301A1D64E4B784F034A23126154B63304F9256DC314895303ED3A5827FDB0EFBB8D0B0118BEEC965AF21F2C9D8E11122F5F92F1B76E42FD5E8CB6DB7384142D41EC7994CFA6140C83AD19694070F8566195BC45AD5260EB43414C06DC36D2F7518B4705426FFBBCF6A8814D8D90D4C0F22842CA8DC2C4A1EEF134D918482116384CD98275697608909666934682F8DD8655611F92109BDD923C9D6C3DCD77E827374850DDED077B35F771B18749B26ED65E1E55CA507AB874056127D81FA94A7F2990696D866210F5E352F1E856FE10C6CE214458A1A84BAA7E0E0999D5EA862D14DAE191A77E4BF2E4AC124393616C275B86107191D1A35921BDBC05C6C1B35F6191FD9823B35D1CB3B4C744B2437945114C74AB4B728385F6F166D328051CA473625F059A4AA8446A015149D2E20FB9451D09E43F498DBA43840EB57DE2C83B8B0536ED488B73D51732C04427441B6CD4769A32C13A39234CB6E1069929746EB59BFF440FD5717535786CA8A6F25C4F9D51CF2E0655F09D20ADD019BD77F90894536DD82145CE0605FD4D3E8AD078008438B8FDC4499D5D5084CB9D1A3F34910A42AF3A39BA82F014662FA150C2C790E3078CD2F733492E6CE9F9C4DD29D885C877F45672EDF2049794B56D004FDDA07D929CEA6F42E388E9FD867BD5284CAD97A307821496E1CA3A4E21D9D9DF57E622FD1523876EE8476A5DF50236C2DD642D890509502FECBB6B70FE48DCA704628003AE3163B080B05DD70C5735375554E891A6E19FD609428C487C317C982ABD163EE2C63A82EF7D692FBC7F4AC6D29A5B221731B76DC53DD745427A1769551FFF0F05C3248E44577CD01EE013CB737009E53E18467C8EAED74EA1174631E9C635F1704609A09578D328CE551968A6311FBA6DC27B7A0B2091C611855BA989BF9C7458168E8898AD03073C3E0CCE1317109860E261A740E076104D3B011E8D4DE27635FB802D6212A2A625C378914C93F58E6A35C12B774DFC2CD7B6650A7EA0F5D553D27205B8BAF394BADCEF764FD5866B243CD3F4109BB8E6BF0CF2832EBE1466BE051E283A49149B2A26934513CF768FEF087855755F029FE0813857EF79189E580A930CAD851378C69D3E1E649FC0D83A5E4DBF98A55043CF388CE32540E23C3F401394FAB076C9514D4AE274BB22F14EFB9C7D4BD4E724CE388CD336D82194568B7E915ACA51267607E7E72D9A14FB551CA83519EC7550563FEF43ECA85B445C200D63B34BC06B12D51F7DBA7067902658E64DF9D67DD046E024E9DAB04E6771CEC34D1E16CAB8C4CDF5EBF48B6180519C386BD5413360BD1E2F894CA80160C5201225634ABBC309CFD4EA485158F0D484CA9E3AC4992F72727AF0AB3190E3D24A6F13C6AF33D2C555D2B6C3A60EC34F2441075BF03CCC43822452489FE5021CB2BDB4D26C979881FB339B9B20F1FA702A25F17FE0A2B89DF");
        byte[] sk = Hex.decode("EC07DC972F7F01FDF7FD0D4018B05EFF02F8FAFDC707A0407E7EF7F8FDFFB76F2080FFFAFF171858801E407C070F080060C01F00FE0101F0F3BF0F7F7F020613E82770FF7F418204FCF51FF0BFC04001FCFAF9FF17B040C08101FEEF0780E01E807EFF01F4F3D7D03F3F7F01FE0D0C40E0FF3EFE02030C184870604181F9F40538B0BFE07E81FB09EE23687F9F4181F900040060D09F40FFFBFA1FB047A01F00800011F40F48A0C0BF7FF90D1854C8DFE0FF81FFF403100890BF7F7FFA0806C8CF5FFFC100FCF7E1FFDF4F7FBE7D0607D83FC8AFA03F800BF70DFCDF6F7F017F04FA2930C0EF7FC0FE01011A14E04F004084FA03CC43889041BE7E05F5F3D75FD09F3E82FBFD2500E87FC0BF7C00000018384040827E00FB01187890BFFF82FCF7F3F787905F3F7D03FCFFFF7F905FFF7FF5FAFD47F80F2002FE0401021070E0A0C07E0AFF014408E03F8280FF02FA23507000BE8205FC15F4D7FF5FFF820606081C38401F3F7E03050E0418C080FF7FF6FC1BD4AF4F203FFFFB070E04A84FE13FFF0516F80FD83F80407E04FB252850EFC0000107F1FFBF173000C00004F9F93BE0EF1F7E85F905F2F3B75F1FFEFCFE0DF62F6860DF41FDFCFB2300500000808105FB172400F03F7F7D010A0804A030E040FC0118E20370C03FBEFFFDFF05DC37306000FE0503EAC3479040BDFDF8F723DC2F807F407FFF16F403D8FF5FC08108FC2F0C98CF1E8001FFFCF71F00701FBFFE02FBF127C83F003F00FE07FEEF6F9F00C083F816F4F357301F838009F91114A88F207EFCFF0C14E8AF60A0FFFFFB002A48900FC03FFF01E5FBDFB76F7F3F800506E4EFEF9FDFBE03FF00F823C82F6042020B0B24E8FF2FA0007F02F50518A8BF1F7E8008F4030000B07F3F7EF907F83B90C0FFFDFF061BDEFB27F0DE4084FBF7F5E32FEFFF0082F4030828C03F00C07DFFFF11D87FC09FBF7AF6F705BCB7CF1F4000FBFCFF1338200081000406EA275850BF8180050AF2CFE76F0001820215182400F0C0FDFBFB04ECEB8FE0000183030B0CE43720A00002031406F41FE07FFF8102FFFB0B4050E041840AFA0320E86FDF81000007F6FB0F707FBFFFFF01402410F03F020001F80314C00F7FFF0007EEFB2300B0FF0082000A00E44F40E04102FC030CD0C7FF7F40FFFD0806A8DF5F608082FE01F643F0CF004081FEFF0354583000FE81F805F8E35F5080C0030005F42F18A0C1FFFEFDED05CC1FC01F007C0BF2E11F80CF1F40010207E647786F60008204FC250020D07F00FE05F9ED032820A04104FC07E4177050BF3E810409FC0FF0EFFE7F81F70EE6BF6FA03F40FFFF060848D8CF5F8180F90AFCFB07E08000FFFAFE0100B8AF1E427F04F6FB23A0BFC1C1FA03170EE847905F7F8107F7133CE0AF80C180FFFA312838D07F7F00F902120C4020003FFF00FEF9BF4F80DFFEFFF906FC1B0850E000010402F8DF1F1080BD8305FDE51BD04F00BF81FB0700C0B79F80C0FC000A04FC4F90E03EFF01011224281040C181FFFFF903C84FBF3E0205F7013CC8CFBE8084FDED010C0820C040FF04F6F91B88A07F3E810501EE07C0FF5F80FDF5FB1B3488C080FE00FF08DA33A8AF1F817C03FF172880401F42FEFFFAFBE327F09F00F9FFF5E52B2890C0807F0BF605C03F60604103F80506284000C03F02040116C03F40A03E03F5F6F937F04F2001FC05FC0110481020817EFA02D27FB78F200182FBEE17F45F20E080FFF8F2EFF79F1FFF7E03F9F5FFE70FA060428307F61120D88F8181FBFDFCEB2B802F207D7D0209ECEF3F70E0FF800409ECF3577040807E05F8FBFF4750E0807EF8F111FC2FD0BFFD00F9F4FFEB4FBFE0FF02FFFA07C47F6F9FC2000205121CE8CFDFBF7D020316048010BFBE01FB08FE27E06FA07E83F5FFE93BE8AFFF7F01FD0014000060408084FFFC07F0BF8F7F4001FE07E41BF80F013E7BFBFAF9E7E7BFDFBE7F0601FA27A05F20C37DF5F209FCF75FA04080FB031ADC5F90E07E7E0210F81F08B0408082FF06FE13D00F010000000E08E407D07F7F0001EE1104D04F208002000C0850F86FE0FE0204F4F907D87F203F7C04FEFB076830A03F8200EC05F0E76F60C20103FEF727B8FFFFBE7F03F8F3CFAF8FFE4200020202EC0770C0807FF2090408D0504000020707E22F1070DEFF8101F423D0DF9FFF810105090600E03F41BEFD02ED05FCD74FA0BF00FBFA1D1800C020417E06FAE7EFE7EFBE008001090E34E05F40C17CFA05F823384080FFFF07F1F3EF973F20FF020814FEDFD73FE04087020212D827C0207F0302021C0CE06F9FC07FF9FD0F083010603F80FFFF17F44F10413FFDFDFF0544086060C07DFAE901E4EFDF9F7F800210F0F3B71FA07E7EFCFCDD1F00F05FC07E05F4FF3F18F0DD007E03FC1BF8BF6FFF3E0402021A84FFEF3F3F010207FE1FA88FE03E83FC010C30B8AFBFC07F010B16B02F30A07F830CFAF7DB570F1F800100F107DC07A00042FEFB00FAFFF7EFFF7EFDFD0B00E48FB080C07E03F7FBDB1790BF8280FC06E40330B0BF80FD02F90DC03FD03FC0FF04FA2F202050DFC206060702245000408201FD03EEEB0FF01F8001010CFCDF4F4000C0FCFFFFF5DF9F3FC00081FEFC2918D85FBF4101F90E0C04E81F213E7F030BEE2FA0FF9F7F7F0500F63F40C040FFFCFBF6FF1F40D0FF3D84FFFAE3EF27805F80FFF8FF09F45F603FC000FAF7E5EFDF8FDF7F81FEF70928E03F01818003FB2BF0CFAF1FC17E05F5EFC7C79FFFBF830009EC3B908F208081020CFEF71FC0E080F9F407E03780D0DFFF7F05F2F5F35760C04000FF010EDC670F207F7EF908F40B80A0C03F8203FAF11F100020807EFC04024058807F417E010B1C18A0AFDFFF03F7051A10201041BF7DF6060A0CC03F000080060208E02790E07F02F60CFA2758C060408205FBF72710A0BF037E0300F40B302020BF7C060800F4DF2F803F84F70E021870CFE080FFFD09FEE737F0FF41010203EE270020400180FDF6F11788DF7FC0810302F4373820224202010F0CE0C70F803E81FDF6E59FEF409F00810405F443F03FC040FDFB03E0FBD79F007FFD03F2F7DB87CF3FC00007FA0DF8CFCF3FFFFB04F7E517881FA1C0FDF8FDDF23A80FE17EFAFCEF15C0870FC1BD7F05F31BDC1FC05F008205FBEBF7E75FFF8082F900263898809E7FFEF6000600985061C2FFFDFC07E8BF3FBFC0FDF90400EC1730E08001FC0300E857F05E41FE05E313C48F8F404004000016CC67E0003FFCF812101C584040C07B00FA0F3C00405F4200FF04F2E717407FFF01FC08F82B98BF7F3EFE04FDE313D01F80C101FBFBF79B27A080417E01041230D0FF9FFEFCFD090E20684FC00083FFFF09CC479000017BF60AE4FFD7BF3EC180FFFC2D28F80F1F0004000A08E427D0DF80000016F2F7872F007F01040C0034081020BE8000FF012CC0BF7FFFFEF9FF095880C01E3F8101FAF7D7AF9FDF3FFA05F13F0828E03F7E7E03FAEDFF2FA07E408106031050D8AFC07F800003021CF00FA04082FEFC0518D06FC0C10001F9D91BB84F1F407F02FE09401820A0FEFB06020C04B04F5F01830704000488AF80807FF8030CF00F00E03F7F0602DCEBE70F80C1FDF8FB09D877B0408081FDFA1B1408201FC2000202FC07A0E00041010307F42F10807F3FFF04F7331830F07F80830201DAAB7FDF9FBE78030BF413B8DF3F0081FFE5EF1B9000803F810001FE4FB8FF3F7F80F8090C0C8030A041000007E2433070C0FF7DFC1216F44F705F41000B00FEF747A0BF7FFE04F50FF407B0407F7E0109080848703F827A02FE071808B01F417FF50DDADB0F20407D0105F8012CD87F618180040202C4A70FA0C0FF0604FA3718E0BF807FFDFE1710886020030003F9E543A0EFDF7F00F7EA29F0977FA040FEF401F0E70F70804003FA0218D00F10E0C2020AF40308380060C1FF00F8EF0F08B0FF818201FADD17C02FA03F7C080CFAFBE75FE0BD80F9FBF5F7AF20DF0080F8FA09D4FF1F3F40FCFD01F833607FE08180FA051808F0EFFE80FF02FC2934C8DFC0808203070E101060007F020607F4E73FB0BE018002F41BFC97CF3F4000FA0222C0BFAF800200FF00F40708D09F81FF04030050109081C100FB081638A04F9F41FF0200F017D02F614080F8FFF7F72730E00001010822E41F20A0C101040EF0FB0F905F0080FCFA234C18609FC1FDFAFD01EC7F9F7F0081080022F0B7A0BE7FFF01060E2CD8FFDFC1FCFDEBEFFF1760E14001FC0114F4E75F0080FAFF1104E4F72F3F40FF02FDF9F3FF1FE0BF01070EFAC757C0DF00FEFA012A28A0BFDF4081070DEC4B880FA03F840109D0BFDF6FA080FFFB04D42BB0CF80400102F6F787D0DF7F80FCFD01EC072020010083F8110A1C503FE1FF7FF6FC0D281860E0FFFFFF0E044878205F8080FEFDD51B3060403F010A16D2EB6750A1FF7A03FEF503988F3FC182F801F4C32F2000BE7F0301F8CFE79F607EFE02FE03F44F306080FEFEFD1B10302060C10202F613D43FC0FFC080FA09FAE76F5F80C200FBFBF50760E03FBEFDFCFDEB2BA84F603F82FFEBF527285020C0FD0604040420308080FEFCF3FF1348801F00FE01F6190CF04F41017F02FCFB23C050FF410100F3EF1F48E03FC0FFF9FE055008B07FC0FD00FE0D24F89FA07F7F0CF8071C785F40007DFFFF1BE03700E103FEF5040EC03FDF9F7F81F9F51DD86FA040BF020810F20F08D09FFF81FDEC112C10A09F0000070200E0172080C280F80216F4AF9F60417FF600FA2FF8AF1FBF810505F2E33FA0BF807E04FC131038E05E807DFEF5CF3768D01F8180FD0E0848D03FE03F0102F2FDEFAF0FC0FE83F505FE23E88FDF827EFCFFEB0FE02FA0417E080FF2EB5F50A07DFEF9141E2808E0DFBF7F0522452489FE5021CB2BDB4D26C979881FB339B9B20F1FA702A25F17FE0A2B89DF955129066F1FEE794EC4E2C660B81225A5EF9171FD643511022379FA9A04FB52");


        //
        // Key generration.
        //

        //
        // The QTESLASecureRandomFactory.getFixedNoDiscard(...) is used so the same key values can be generated for a given seed
        // for testing purposes. You MUST use a real SecureRandom instance in reality.
        //
        QTESLAKeyGenerationParameters keyGenerationParameters = new QTESLAKeyGenerationParameters(QTESLASecurityCategory.HEURISTIC_V_SIZE, QTESLASecureRandomFactory.getFixedNoDiscard(seed, 256));
        QTESLAKeyPairGenerator keyGen = new QTESLAKeyPairGenerator();
        keyGen.init(keyGenerationParameters);
        AsymmetricCipherKeyPair acp = keyGen.generateKeyPair();
        Assert.assertTrue(Arrays.areEqual(publicKey, ((QTESLAPublicKeyParameters)acp.getPublic()).getPublicData()));
        Assert.assertTrue(Arrays.areEqual(sk, ((QTESLAPrivateKeyParameters)acp.getPrivate()).getSecret()));


        byte[] msg = Hex.decode("2B8C4B0F29363EAEE469A7E33524538AA066AE98980EAA19D1F10593203DA2143B9E9E1973F7FF0E6C6AAA3C0B900E50D003412EFE96DEECE3046D8C46BC7709228789775ABDF56AED6416C90033780CB7A4984815DA1B14660DCF34AA34BF82CEBBCF");


        QTESLAPrivateKeyParameters qPriv = new QTESLAPrivateKeyParameters(QTESLASecurityCategory.HEURISTIC_V_SIZE, sk);
        QTESLASigner signer = new QTESLASigner();

        signer.init(true, new ParametersWithRandom(qPriv, QTESLASecureRandomFactory.getFixed(seed, 256)));

        byte[] sig = signer.generateSignature(msg);


        //
        // The expected sig from the C version is [sig][message] so to validate we need to append the message to our generated signature.
        //
        byte[] expectedSig = Hex.decode("ABADCF054069FF9675FF5564751107F54B8976808FD0CE8E73480729C487363509B0CA4C687996E2042F0CA36A9A4C6F9C10923E357F0B9962644605629CC38ACCE89008A9565A247658C94675390EE82E835BE5E458F35270A22BD28F2B41A0F8F2ED46E6A3E7FE12E07843CF342D5614BB25E97F6D5D48B15557CB4F6AD2879A9EA3EB4843A4DBFDB81F268F84800E89AF2C7DEF620773C7160C34549B4E01FF2D45BBC3BA27172F77E308A549CBF05F47353050759CC352414A0097651AA388576ADED96195B9D0A8B06FED99480C2A4F1386EF091B5450F29043A24901136B321A6222CDF2C607A2F879450BD785896304ED53AB3BFB1677791BCAB767E0B31768EE6DAC242EDE614F43A154286DE6C0E181DC75CBE86E05DD4442639903923AF63AFAE1765B11A7EB2593EE43460E0254B2BE30AFE50DF2BA3EDCB16F46A06B11F8C7E7985448C6EF39EC7EEA4782A77D758631D5B3FBDF95D094969E6084645E0D19C453C45367BD07EC659C4ACD034BFB45B521CF7AC02CA44850F9150E28E6064ACA32DAAD7EAFE4C354ABA5613832DAFF8B1DFFDE29E206D77755F1F99D9B644515430775EA08CBB392F7D5A8929F1C71C596F21299036E71CE14522E2C7BA00387C9A2A4CDA14F3E1C119663F9F515D971C4EE95020D87A83A245AB3960DCCA3DAF74894DE5EEA28E26AE387393B631A837BD5378F7154FDC142E1B4A3BF5587F002B8C4B64D26A2BEAA50297E583EE86D6BBAA838FFE9D25859096A47C0E441108274488F66EDDC25996050CB1F34C2D317A20C5935F437082B6783BCEC43EEA352965A80E7A6BB7B6256F47ED957F4133A41B5F7B23AEEB4C4BEF8F2347901359826177AC6DFA808C6FBF86AFCA47B85F8C9B45DF41B3FEB1E57A7B79D695F43AF023473EBC8AD28A899349A31411FF335D0878EED485513808FD78CA8681C886370CABD033889BD99BA0EAFA66E8FC0F26EB6A78CA141EF91CBBC093967EB774CF9DC512E2FE790913A4484BC16D1AE63A241B52286DAE6ED0906EAA4C6BF5EBAA4C6C7A47EC3F6A8E6A35BCF582CF03A1A039E8E6F1C1B1A80DBAA29DB0C7BA67A40E4E9CB85098D0E85370BCB9A4E7812640D03528F8AD4696A7A58CDB2982645B59CF7D26D3E9B9347785DE05386830F30965633486F905176B4F171BA6E9D21EF2B20B1968D544E97B46E173FDE065397C7C26ED7D347D33FF5D13BC8BF13262EED33E4A8233E45F8840ED495FE4EB2E6AD5FFE72DADB76B6B00C5528A7698859A1E1436F47636277BC9CA1B82BC938F3BA807878AEE2B57BB05513575728A3CDC85A68458CFE8016B38075D8C78E425F6773C2C3001871885834B225F4C4685563C99926F2778EF411E35B6003E4C62B51499B150C118890630FD5393C9FC32A9A89CE68E344358A2ED8BC17EAD895D8B9B07A6A3227D69524AAB49A623C428B213298B07DD52FF439CE8EA93A8417912BD93083F1CEFEC6B03D5D268270F98D16498C5BAA362803B88CCEFED62F8702396BBF01128CE64EF2A956AE4722297EFF98A583096DF216D2BFCAAAEB05E1231B6273F28887CB6426FDD7ED60AE08F088F6D85A67718CAA3431E33726C8D1D8E9E4201B2AB62970A004EC0277AD7021606D2065E973525E3880CD01CDEB1414059362FB36D9D9F9AB0F783B89B696563996C2997F41D8C49A52EDE4686449C0A74F8C7A250D7540C6DBA4280248D8DADE08077EF202040550E0491AE289E7853930D2A1144F452D49B67F21B0D6459326103892C96A94331D14A64B3954A1D65A45293B67A44D9D69BCAED484955C0DBD5A033C9428E3DF289AAEC6B3A1B9852C15B67AF4E9FAC7051C0586A79089F5022AF37465233BBB8A5D2D3BE75D9FB92039252ACC57683BEB4DDA2A0DCB5153F259F6B3BEF5D8132CBB69762D03EAB861E73066B0FD386FF51E4F6A52A51041DF10DE9D548E29E22FC135693ABB5FD84D23012088F1EA4EBCB2436C794AA8F5026BDA533633B6D62A5188A72D9E53708139E3BC8668224DC7B71669BD46E251E699D8F52365541DD762C09842220E40BBB8DD28D29FB0B48EFEE97A6334D1F54BBAD618904746BDA4A37439233B56548C58E1C88B6DA951FD8C69CA5DE28CA638CD6A391FF0BCB53FCD21AF97EDBE22F68106E0C698F9C2CEB7F98420EC8E28197DACED71C812E6B2B08C14C7CED431832DF1B76BEA6420E8C7CF4D644C4D1BF673C049C525F326428365351542219F689EB8BC1DAF151B9FE0E02F552E551B7DE8D475A0D037C027153D6F6136246577BD432954045B1090ED1335F5C64DBF690A44D36EEC711C69AF722A43FE574FC12FAC8812E334D09CBA86B6CA29CC9904335CABE8D63506A40A7E38C6884EB8829DEA2B0ED5B28F8BF4A8B1DCED1B4F6EAA2E2262484AB77BE8ED7CE0B85FF3426EC940278A6382ED8D1ACA2F427AB0DEF78155CF979CA63DC8422D9F3D1770A617C24AFB0D07794654896A2C3C036CBC554676246C5841CD85DCD3C1D6E5BD4F7CEB71C91B0177375BD0F206EC616B3AD16C4F49C7E345F64A2AD9A5AD6D582C8691E405A096AC34D31F59D20371216F2A5EF130BA26C88ED19585B10CDC9601C0193B190C891101DC03CACFD96E56B9F4E71DFC45158E8F7247FBED3196F7AAFFC42C30620B4D4DAF326EBCE09D3B7FE53995CCF18B78E0A7E6E34C12515791EE082787BA6897D257E79D1B4FD815A2F7AD9EC0F57E33936F739465F50F69126B370B36A222C275D5AC301DA4CD597BFEF7E87F3261636513C9F750B1F66405D2438D66AD142CD416C2F58E24EDA05A98AF990A093873776A276E341C4EFA08C875AAE21C554938A2CEC2D7BAE1A74BE6F6C206FE4F247550E5876A63D45A7EB4B1CA485A656DC7080D10CDE286D99C87038A47069F1D2C9465AD307B896FF05279AE527007D1355AB49B740945C9467555096A8BC60A65BA0819132A38B9A844C231977DE72002FEC8A3D3CAC4E40D6BFFADCAF3FC3612F18BD4A5820CD515490E150D68B785584874A8312404095F3FC05C96E3B2A74505CD0FDBC0CF6012299E1AF33EF7CE8242D93B91A0B5DF4900C5075FE4E0885BE6767F1AAEF0E12EEF9294CFE1AE4394ED3F6C707AE0F36F6225D4CD72EE580946583FB8CC601B57D58CE190CB7F1B531D4B5CD17DBA12B384CE0FDB3E7CD1CA2ACD967F5A8FE9019766D39C1A23A7B6CD2C14F0EB4F6FA95EC7ACCA28557C0483F97F82ED8F027A6D3D49397F3E0797321F615F814FC86745D764026B1DDD0DB5E0DAA40EC487D890C43A0E301D63202A6678093B1E5C9857999900F5C256E56E886D806D3C5BE7A04E500A5422106F1F394ACBDC96A640613DD498DB9F1D7DD2F0C5F2923B53354FDA69787F41C38FB929A10C6B60BB86368394FBA743A341A77710DF7FC5F371C4BEA9E37935D1A4C48A52390CBA04F688E654D503E8DC2D297885534B41FDDEF1910657DDB6327200D55AECD9B079F8734B96CDBBED4E4342CD9699CCAAA25A98A6FEF6BA2549C7F88AF5F9E6B9CBBA75E5D3498E5F9C0316570E31A999DB4C03C283D595C3B48C37B5D62F8FA1C0A66D90660751FA6EBC3D115A0687FB1A8FDAA1481D52448BC4F9B15DFB515A1555197264EED2686BDC7C213B592581ADA62A5DEB097FEFB5B26C01BE01FF7BCE0159D306B6E90250F693A9C7227729D80D38F42E5E61F74BED5C3E50034C2C63A1DFB50B5FFA787F838B5A337BF5C88529E695A245F7D8A7826DFF750D7BB387CA4BDBFF3217FCE7EF16BC1DA431AECF395B91EBF2FCD8962C6ADB32243565F7749CADEBAEDC7B270BE5B4B2E6CC0434740A06E193FE3EF1FFE8B350268F6C352002FEE855094D117CA0329A21D02EC1742BEC4E06AE15153A1C64DDD986A0E7E5E9C1A9ED64BD6834AEC10C4234573B7C12CE329DD7CF555EC8DE697522770636CF8B6844E1AC939FA3AE62D9F73BD9636930A384E3094DE3370022B624EA21768A8CF4AF03358FB1F25F53B71161D7AE992AE4CE299943D58B853E10EC8DD0FE4E2B8F3F761593B25A18ECA8597E18F4928662F73A78D2FDEC8BE29EA89B375ECDB50D7D0F50BB17680C9D67C829181602468F3F3F870C2849021B0EFCDAC093F663958663EE45DB789567E8D47A72626086B65E78E9D9F20FA1FF6A4AA4D8D40E319B95B3ECC8F3F3BDDBDA60A82C5C7B62E42497C8DFC15ADA1CA5B0F3119442FA9C0506AAD80DE3D643C40E9BB6D7C3BE0AAAB157C585766DD8EC54CC51EC685E6CEA4AD65EC9F354003392071503B43535A08B9B49895F5BAAD26BACEC663E8B1E5482DAD2123CEFE0C21EE465BA16CC9C4A055126B8133040070EBEDDA225C3B31D44467F8EA1DC95E36303CC5F09AE51D86C3C979361AB0D7F73BF741CB150D85CF878A69A34357794E0B6D7F83E69D93379F4024C4A4FFBE6A4704839C652B4086221CE1D4F60013DD1C567E129F34D63C06E5ECA11CFD692678D6AB21A7340F25B7CB29D0E7E4D948574D602A9DD23B3967EB29CCA31499479C364F6B1F64FBAD48DE55187DB4B0077C0A7841A89F6E658916E7FCA783961E4FDF715D39C086F512461665F81DE4927CEB6ED6025BC41B1411916933E42DF8F8DB53E8E3D752598F74337181E08BBA8EF73A59BA930713AFA3C7A0588FBB9AE16E88F18004936083E7253FE3B79BBD653E977467DAFE3F755798D7E6A68519C895322A75517F4459550D6FAE4145C82B52AEC4FEDA8FD731FDDA62F9B8AF9294658050013C0F12ECCCD9482716FEDD3BB83866ABC60D4D5664F687CA1D4F5B34A76B42AFFA2701C68F4D22A60C1D8C4C7A7A419F57B79D60722EC57C3374B504CB905B1C71A71BCA00F947452FC21AFF61FC7A52B19E7C32110A1E0E38791F80E82D14BD9C442BD1B1DE9A69D8C968A31D507FCBF99D897529B074D35EDEF1D653E8B8EC98E8B58CFB080C1CDDEC6B9B0B7352EF7C6D87B382DDDED80EC1FF55108E0516E53B21A27AA3B57AF9DB87582C86D802064009210F140B45C40557B48DE245BDBD066A78FD19EFE00CA33DBE29D3EF46E4CB115D0EE7F9F107AD844EB7BB436A96013488C3C35C2552334D51C9B7380782053FC752B28F3366EA97433997A2A1A69BAEB4803F6F2D59818E937FCD18A1D80C02BBDFECC43551E48A756BFB41D2DD7EEA865721C1FD7EBD6C1490842DAF9B3796623642AF33B5687E1565BABD4361B95EC758ADDC7B4B17208CD3999566AE962F97966757E668EF1B863FBF41D8D61491CC8F5BC8E4AA98888AA6AD521634C8777C38B6DCD0F1BB93D810E4909F841DE179E0FB25818FD51B068997582D1874F362132DB27E8BE509A77D22A6D0619FE02EB58CEED0E1B30A1BD8A00094C660955BF227A731300A3A3CD8868AEA4ABD8386306F953EF2F42AF35D0F12CBA64FFE37239DE219296AD726ECCA0601AA3D945B5723BE4D00BEC16865AB9DF8B86D62B2CFBB2ED6106B2D6646B5D07ED245177779E0C07DD5D9C9CC997B6DD880AE8153B2F5732B59F831A3669361D9D44DD557ECA4D0B6259895AD230E4055557788248EE75D9CDA17EF23C6DDEB3041126FE9AE026C2407AF69EBEE30AA4D3F53EE05546356DC1AB389AC1BEE8AF6F0A291E1C81F015E1225D82C3BA62E203350C1FC8FF112730865EDC820668638AC962FC9155C23DF1060E047382D72DB4ADB4297A8804D85E40495CF02532072605DD39688151C20A5B44B08CEEC571817276CA7590020920510107226458CF02AB0D447599FBD5203D37B3A0E4ED0206AF9BB9A0BAAAC7A14BBB32F567F094AF57BFC73B9B3BCC40C2D0C593E7705C5620B512C9BADDF619A40A73A04CB8AE562154696AD1ED8A379512AFD92FA178F59BACDFB5B63DD134D476CEFA14FA4AC9CC506728BCE49283BA5CB91EE6AC0448A97572D9B52BC11EF00253DF68EFA5FA11B33873EBA02571D32FED31DBD565D446C14429BD699D559917B64150AFDE2F4AFC989C6E9456055FEAADBE3A61AC43107631ADB10A271D6549DA55195189BC80C9EB7A5F20B74272ADDF78412FB5FEBBD088B7E27A721D413A3C1E192ABBBF5AD612E398F0349D7F04B82E70FF54C64C1561D6169EC1241CC40EEB97C186D1AFEA535B159BBB2B5E4330089B6B8155336A34E3507B149FFCE64D2D9B32CDF883D169B8E47184AE95C848D67E858B205E65464C922FA4D0EC6CC8158C0F9D83D2FFE6FF3ED33F30B61BA56EE011641B273058CB16237707DE7CFBECCD2F609D41A91F127F9B24FEF0B263D0C97F4D8A7969EDAD3B20C2A6C5AD0E43825E17D037F2F49785A3D8B7F1882A1956243BAAF18986A7ECC0FD880E4387C2BB861392F4490C1105BA912F985340A6EE12999464AA48142A7C5464C75541141157C6837D16835FB4140E515AB5E272AA426662FFB1E465BFB0ADB559E7A60DB1A6298891A80E62E51651B2DE111A2E1CD8BAEE4F48CF5D93C18A9D00155F12C65E887C50BB42A965E72E72134C9BEAD0F508E0421A4D05D9B95E09046580B93110AC0B13C03426D05622C846DAF60153D4A648888ECF932B8C4B0F29363EAEE469A7E33524538AA066AE98980EAA19D1F10593203DA2143B9E9E1973F7FF0E6C6AAA3C0B900E50D003412EFE96DEECE3046D8C46BC7709228789775ABDF56AED6416C90033780CB7A4984815DA1B14660DCF34AA34BF82CEBBCF");

        byte[] generatedSig = Arrays.concatenate(sig, msg);

        Assert.assertTrue(Arrays.areEqual(expectedSig, generatedSig));


        //
        // Round trip against the public key generated by the C version.
        //

        QTESLAPublicKeyParameters qPub = new QTESLAPublicKeyParameters(QTESLASecurityCategory.HEURISTIC_V_SIZE, publicKey);

        QTESLASigner verifier = new QTESLASigner();

        verifier.init(false, qPub);

        assertTrue(verifier.verifySignature(msg, sig));

    }

    public void testSignQ1p()
        throws Exception
    {

        byte[] seed = Hex.decode("061550234D158C5EC95595FE04EF7A25767F2E24CC2BC479D09D86DC9ABCFDE7056A8C266F9EF97ED08541DBD2E1FFA1");
        byte[] publicKey = Hex.decode("7561DAADC32E5C51E5C7AB83FB32FAA58E32A0D1E5134A07BBBC3AE889C85470D024D22EE8A269A9772C24B5971CEC2AD55A846C6D8DD917B76223B0799227F89FE8EB91020CA49BD528FF1915ED00D9F9709740A13110864F11C24CF0DD8DEA29BF288DCFE4B1CEB12A7135C5142D7F51376456892BEDF33A295D6D70AD058C51D565E8097D26440D57DDA86AD04C1E7ED45946654ADFE9F46A2D2CA0BEA6B2E57046D734A3989BD6B2C42B9413646C1A2F1B6C3E55502D8780681D1553601130BF98D26EA05C216E7C98FF0D5FC03D10384DC6E29316921F50AD19FF96772F998DA91AFC45CB3A00E67BAA713E2825C6DC2A0C0E8778444870A0483E588EDEC82199DA34B636966A85D9001C446C425415C8F8269697EAD5D69DBA92F77228808FE2AC5485612B0F28862D9EDA5D32D5CDD840BD45649C1D7C50044CC017D87E8D1012FE2EA0E26F2710467A13230C73F485F26154825038BEE477CE3154C36468B22124038C3C0A8E41C8681B20BFA3493CF88299E70D0D3FBCB5CF7EB82D39656A27FDA96E62CC84FE9A83DA858A9982F01803872833C48376E04C4E319744EA26EFD8FD4A1834B5058986DEF96CD22F4A30652A543D640C424AD107B54EC7D5E9244328BCBD166100969A54B003DB5F1D30B7D8462941A5C2E6E166563C1D7C7222D167E2627C98EB0F4274FB098C1BB288C8A12180E0A2F32596B54E3E68520B625B87B47F5E2FF64A1490CEC86E82E5E94359FDF6782E2138229D2C1EFF49B6BB6A722D033FF80BBA7A2CBC90D40E39E2E6777E062F4603BF87C407E2C20DD67E67DA5FB1AF696A05CB301B78A91A54F0881D5459E35E4070E0FA605C43E98C472C76DF9C31AAC8A7473DE2B989F297B230B751B4F32B61CF089F77317285D302011D7D6BABCF4C07C0C70AD4DE3E99C46EF595EA9A61A080DD48C74A0C961513C845DB6A5811750145D081B4D4E76DE5B15DBA5C1626289345049D5CB8771C7C129DA1C5DD8BEE596321647E853BCF8D661D194A1023845F420066244F6BB5A0D50533579AA0DB5A726DAB32EA2B35261AE5B6D0DEB12C31A79242E2D952AA1A1774CB90AE815BE9613A93B30AF30374F5C8181F54B4F5D56E07232F68C6D52B94BA64ED1B2B7CA37EE6C730E03816689853224242F0297A017DCE955C8B8D1B41BB3B12665759584D3373BC2C77999205ED56F6E8B6AAEC3346D1528C2AE938CE21C24400ECBC4BB520958E3303374C68A21D403A6E6F05DAB6A8C03FF07FF5B83A216B2EBBF8E357BCE51A52A56EAAF6B6F6D34B8BCE02E22BB67CAC6629A8E8C3F9F4E7A3AEE3B9AED01B2E3BCB3FE566E3DFFD8C4A9830AEF3D30DE63B5208A32433A4C42633C4840EC5493E891D22F409E35F02CFAE46A9D3DEED6C221916F9B27BD7EE3C1CC3C961E59B3DB42A59213FFB168DD170393832ACA8C79B52C194571681F0E8AAE2DB99C1201632659AE136E3B085985DC94981A5503D950E041763AD485E253DD8B329283929E2132EFA6B9EB08E79AF6027D6E2E7E30E3D6B785256BA2E012D003AB5C07FC4A0EAB484991B3CBC3B03346409491A876C82548E2BB253E344E80415E4625D3BF15975B59DC36FA00A7FD894D363172DB8C2ABE40364F549A00C5D5FA8B534E0CAE6A9AE83CB5E4BE6BAEE126B755C9CB8F76C1C8A6E6FE2567C1CBDA68370D4D8465D8B360880601206CAC0C9D0B67C0261A0E7D132CE9C4EBE21250F7F197480FD5E0D8DA83068EFA8B35475733FAB080BB888E1D1D89D124AEFD81BAB3D970FE059674B6E71455517B9BA322A236D272144963DA4A934A1D59D19F05FEECDF0F1E390376801E0454971E30C47109944BB4DF414E19326B8BA2013D5F6B3FA20188E5E9BCC63ED8BC55D8D7D3A086193F9E80DD32381B26BD534D34F298DC06378EDBA2E614E8C3D886297AD1B2B59FF78B8FEC0760336C5207082D82ADA01CAE49AE6500AD992B7FC0631491B909F449618E5F82B18995BC926F46BBEEE152AB2706521AEE3574295F26FC01A7AD154673B2D3B500E1043FF51340BAAA70CF8B3A65C65811318AC7B4A32A9519A00ACE331959AED26F86CACCD7A952F9D40E66FC31224AA1BD280F89A6B16F46AC39C5F6D709868F92D0FA519D39827D215D8BA7F2FA6B4DA67D5A791984E7A1BDB04A5A7B024762952121C109AA318FD2CE88EFAD90FFCC17419C2892C916BA7E7C482ACF41E5C386290F1174AE5C5BECC5A0D21E23B40FEAF220CB9A58AF8A5B5910DBE823359150388A4B0046090287B760B3978433317F4C2E1AF2A5BC87EFD2F59931F558ED226CEA7174B9BD4D1BBF6A10CE2C2D827DC4D36B2096B9309D42EA8D45B5AC2B1F7049CCA4078D4751B6B03DB06B8BEF3E119589CA61D7FE308AEF4561C4EE87DEAC2DB94C38C4760916D27E6BB2C169D1C88D35616F8C5EA6EDD4D48D6A5CFF409DD67D5BF704B832C3454A8BD14568B93F760EC179ECDED970C46BE39D5960352D2F5B3959758CA7A10C88E961D474449CCC21394D2099F6110BEE145E7005DA5501C0DFE3DF1094ACF99951A2974808A60108643E9F4177827A3F616009FA67E21F54C363BF8F162F33254D6CFED5E7C0D4AFCF9854620B9632FBE147284C6739F5FB4F211C20B1D9982215C2C4B1C02CFD041F8281E429940E8FCB66C32B694C2611D8D7F50A751D3969C2A3AB1FB2553CF0B26C0478C2988D9008EF4A1777E9F7F16122BDF208A5044BE728E9D928A52F133C1CC462984590D44E00FF7AE1254928A006054D008E780E5D10BA7E11E17E296D43D21F64544AAAF27E6AF9D4C7A381E4CC2873F358B3541454BA2D594602DA71273F50F99201CE60F93E1431D82D5402E8654206DFC651A3E36CA854A9B18E8DF0CE2809FA89BB465C68475020C51A773107D9B367E3C9A82370773A498FABAE4AE84D7685C9329FB226E0F5F6173C5107AF143BA84BB2CD9A9D2CEF930C5F8055A4E71C1CED7538F3D8FD194EDA2C98FFF3005BE8A73D09C7CBC8DDA07F4066BDCBFF23A1838520AEE0A28E69DE30019DA6AF61FE52A6FF10B4A9215F8F9ABBC9FB5081CA33463F891A53DC91E252E90EF4B0D72A35923208CA48C3793347F3D5FD28DE56538586D2C2C6C1FD50C4160D67DF11254BB36CB94B835734F5B831BF12845155B49FBE3B0F44CC5D6782983D9478C6B3A9F30626A797A2CDF8911F5BFA90E611B39B29314C9E4CB7F12A69D6DAA1916667AAC5AEA693B70BD741928014ACCD125137488BEE48BAABB02DA3C6A9604A16BF4D19F1C0D87FAC94840C721EDDF03CD8A841D2EFA5D52BAFB50726B45A476C47E251601B0127C092A4EB8A66A0CB7A2DB5503394AD36D54F37CC6EC73317E38AF9FB62BB758973971EE9E75E6D8AC67A0D44384439E7B11390E983975281A194F8173119905FE8FFD863D55CE7A6AD00683D4FF83263C81A447948DBF3F1EA2CA593B38E6719A8EECF654774599AB25D1EC9741AD3DE4DC23264C9700CDA27C463656E3A53C52B860B3264CD9FC0334D915E03EE74E54D4A2E2D795297FC748075A404A6C0AA6A22671A480AA3468B9FA9DA9A20DFDD8BB9100C8B6804DD6F16AB0C1B938FBEDC2F1A9DF43CC877B0F323042E9B1DFBB8A2BDA8986534D52B7EF06614DA22F63951716C2B04196567698552F3BA2067B2309AF06DB126727E1A82F731B0CC2904470429C1EC94456D1E66A0EA35A2A1C552CD3FA1A99AD3D748D563978800C32F5B6CA195938BA26CF721FFCDD9402EC4E37A9E1198D39516B4892919327592C67ED148672377A53C7AA9BD47D16282D977A40BB7E036A3FD11283DC2BD82EBA452474B827434014D0BF7C5483F28A432D378C6C78E6470F4026C27F531C367A2B950B0DD95114A106C72227CC33779C705B1C8926DFA2F996000535A0BB87BCFF4B9A12D829D04434AA579A11F6D15490A2C9FAF65042DB4CF88BE47368C589629703815FA6A2A1BD4A1447330E00CAE7645B2527FB82E864290C9574FCFD364F1A4FE3419642D24D98A6A33A0FC0E83505FD5151518555F9E03B2D5742630A119B2B32657AD6B2EE8B624508780F98B27E51BEFACBF3A7B920A282EA45358FA4145AA24E7CDCB3432C6F08D92421E2561EF811F1C60D7E51C840EFFD637D940F43D655FD1221F2A41027A71D90F978CB09E2264737053330E47E4C433F9B5AC94DB9B04EF7326410CC60DF7A220E1749A654FF6370D7C8197C808D35C2B6769E7CCD009BCA5835E4FDDA202D6C3DBE324AB97C879DA16184123CEEC3D5FDCC3CC71103E46E711CF8274D29B5CDF074BA889D6B0E51290428E0499022E634439804A488483D3927DDB78C248EBF9A6C9A678F4F482373580CB7FE2DAD993DAD34149F112D735C7E60DBA06BC44F0304551ABC09B9C91D4211FCD6025A865C90159CE3D842405A5143C46BE19DFDC64228A413D4225D7C94697C0F128B4336E9483192F3024014D2E9885447D0762F802087C7654786F76773DADA83CBC7396E5DDA29BEE95E93FD8C67D75C7D258765C7154DC822B925E8684DEB3443F85300C96E59192E8E99D2BCA21CB62713CC5EB23BF156FB3E97DAAA0695D84932FB9C9DB03E0BB13B103190246CD9AAF79C4B9C8916DB4B6BA02F5FA8B87B9E9B8D18DF6650E907E8A02BD67B4C00EBFE4E4C2CDA560D1874D7215CF0009DA57529EA831A8E71C88152849A8C2900134306C0C05A40BCE42A17CE9C025C100277D7F0CB35566BE5AC11B2466A2BB03B8DA8F10B7A30CA26FC4E0A3971E16DA0C5FCA52838361046549A77B9721027DF307AD3DC8B4EB3DC05BE4B0B0FB77482A794305BBE99499F6ADB05519D1D4A12740F91A363602232535458E94C7487DB90E777247864446B5A862164D9761DAAFEAE213440958E0C399B4DCC6C6BCCA44BF33512828B20402EB814384B9ECEC2B0C1316F3C545D4A65F31CC01B9E324F4468ED92896AD4572248E7298520FAAB161203A09D366EA8FB0041E8A79368822C557C67889DA58C63043C0B6E94B36C61CA41E5BB570448894EEE09F4F00A18A0164FE451B4D005AD5B9A1E3013C356652479D340594223238E068D9DC8C838902D72D97D35EA16E9B7A1852EF464E22D6CB4217BED00F1998134CC09098453C34CB9C0EA8ADD432E295A4B8DE30BDE1AB413F515153A75D02CE99B2EC8E45B3FBC1682973B769D688C8F6FA1AEBEE1795D1B9563AD1D462BAF1668D0426C457382E0EDA9A898FE694D319CCFFB53F378EBDF3AC7BBCDA8CB319470FDA31A1E4E920237A31A7F31392F54BD8991A0A98C65E8DCD9A9666B4403CF1C47B76D30391610161253A9057D23712ED9C71816D1C4B32A390AB6B4DE8F6D6032B8967B30471E80E2FF925DCA64887EA29FD14051BE7856B65B954A37F9577384245272B2098990F198EE1A9ACF1548299512F541E45922238F31115532A3AD6D744473F68DDCE411BEBFD933BE64AD1C7007258DEC9B112D4B9B5ED01FB4DE74E128C90BBAF64763A540E41B407151CFD8C2048A415304F05F7733238C6722AAB433ECE0CF900EEB02C24B20DEB96441E947ED1097A539C6A1B9E8B838E6CA2055ECC7064F43495815DCA3972B83401D5C8EC61708E692130512573672CCB5B9A56973E2EDDB1E3E1C965CBAD617D2590C277B91985007493DC9909BD6BF8578F2127141993ABF817B6DA2019DC6CF79207F96AB032B6D06C0512D049EA8663C46D5EDEB246F036C978496B1C1BC47E81CB63364F47B6913D0548EC13E1A37BCE62C68CE98BA1C29E71A3868491569B3093DAE40D42A5ED2972182CEBCE8F2589137699B142E3D3D7164939A081FDF237AA58ED794603943F2269A40B2967314C22E8668B15FCE244E145A3A49A3CE5BFC2C46ED93F40816A92DFB2880B5C4E755B2CC50914583D0FFAA28FD934E763118DA70C3D4137957333927FA4F0F637C4C52B9078E141089BCEDC7B4288019EDF92FD0ADED643C375E71C25ADBC8F94E04CA5A4E91C362D1C86BCAD31149636A895F443A491E6F558F9DC89ABA27967C7E66EF9C7302C100E4AD175021CFC295048BD5CADD8E86469EFA437034D7A01E38BDC64A6187F51F6D023CDB240F9FD0053FF7258D2C5802D1FA1C39DBC9D6D0E65026FCFEEC8205F77FBA1F64AA03B4D1C091AF43AB800839B4EBD378B28EA895111560183199390C3C6706EC35A05E4118A192E5A29C77CED86919C2A74A827913219B2C33E83249175B886B598CD25253A4B07D10C3AF92060C52FDA89B880923595865CA108EB0E78BA3F9E7B0465522CBA8DD6094131045E13A4C979B07BE8BD782AED050C3CF7C25ADE3C2A1CAE81738C55DC1ED0A33020EB6DC3464BDF6C16CC8223161991C62D149FCEA52140198B36B6379B47F5AA5EC066A5D5F561FDAC44EF3F967EE0E0A420AF89E22A053119DEF0D36FEAD69FF1B2C2476561DAF68D7682BD807CB4D2782C0B7FC39D7C6494BBE622352B534C21BFA25E6A37613CA73B85C98894EE1E588F20E73643F241F83003ECCD05B56255AA36782EB07283337E99144CD03B90680A048D4538D580728C0AD59C082104CD79099A08C193D40C3CAAFE3DBC968F9F8D9D0C74A7CA135F02C8F9C18380B00ECA21AE7E7A22133C1A65687C7F74CC5FB4BBD291183B803B1AF8441900134932217783D9EE86A565C8E9D316E0BC93E75941989C7E227D3170B0F78AF6F1D8FA70C697B4645A5F896B0C4971B6544D0C9786A774179E99EB4425C9838D57861C88E1DAE2E482D38BAE9D9C04DCC71D97449B13D3E9F6A52D81C91C0B02B581F4392C4EEE0514D4D39C84F323D7FE9A30FA87C5380913D3955C210B84444FE7CEDECF821D903E2102E8CAEF4020006F67B6D4B2146335AF10C6EA0A116A0110C5B9C935E349A6B29E8D609361B668E42BC0CD1E33D491D59FFD4A13E5B7742A8DBC918FE7F72BF18268121CE414D222C9AAA0522CE0487F2FB8545D19D7911BDCD4C81106EBA729FBD57365B1DE562A07660EDC92337C9A695F4DE495FFF27D63248BD4E4A96E405E39999A8AE35B6CF12AAB699FF741E298A3222D168EEE5ED1C0A372810A883BAF50E7DECA6F146F6DCFF1067EF4187AF79B70D8814CD50E39042417B4A1B7A230FE68504352093E91073307AD525F069F15DA88856C5140F8E89DFC8861E8678067FD054B163E02203E06AE92FA76FE2B68527737D99F2A13893699D7985F2F025DC3A430555FC23C9CE0C078E83CBCE363C5B5840FE09155F433178C46D257F5DBCEFC6AE9140F46A78872803B8FC6D0459C8A26279E1AC09711150E7F58F420A6AC2111647724DAED3867FAFAA58D4485F0265F0FF6A63C9F88CAB0FFBBB3579DC045903D682070C4DF15D3D02650213EA7A7D2FEE676BA92F923C1A0CBB2DADE5EA8F5623A548DC1060A2BFDE25AA6A09F80D8613D9673B66D2EBB124452921200BE54364DC705DC60BA75F2D0540C4168E6CDA16DA504D63068DE764E1823700BA4C97BF86058DDD2F5942DD5F4D3B19D6883412B6089FC6A6DAE5FAD95C3175AD53CBA016D59FED8107D0C64A1B50B1BC1380261A55D04998B99202078EAC318A36879D5C5AAD9299134EE66684179F8CACC52EE8106D23D0509D32E0459384B86CAE143B3E3C0EE95C8ACAE8D496E59131C80CDCA98B812E0452B8B9EFE94DE5424C50B935BCC927FF395D4D141DFC89A639703632E98451182D4D072A987A88B4409E0B5AD6F0CC62A5A10C3DC00B03597D1453B3257770E36949218F22D721302D3CE5DFC09D5604C943F73D75C996687931133DC4B6B061E5E74483FAD6EAA9E89D9467CE4C4FA061EAE71B02F3390DA9EE49D0EC92097321171D9771B1D65A4B54130345278FF8BD415FD5C9894B9F430E47F2967C650E376E614AF5F32A9456AB0C61A9278109404A484F28AC568922691C4C3965D465CD82FDFA330E3C9DD9E65687AD8827D18617C54EE0E3F6BF7E9FFABE7127AACD1B71573E2846AADBA44415407013EC01C5A7F70960870D1742DFD488B81A34DD7A286F4CC2C000E042352CE0120A637250B2A21AA998CFD1CA99BA21C321335F4A9222486AEF986FDA32C36F64172AFD225B5D358B59A06FBC1D388A99AD5780624E6A257A96910A4471C9ED1CDBF4AD41C74538A0933A460FFFA7B36C925E02D45D89A819725B8029742C189E561840F20EEB86252A6925116578A705FAC7B5B9A128E1B429E321C0B8EAC6B74C9590E6B02DEE15A0AEAB25B7D5533BB7B6D9299620BAA42C097304795B71A91DEC14A32B96438B0D4C313DD9A25A916554D2164D787E800B524D7E02215515244E7994C427574CA0E02FA18244A81E49C03C59E85524C8A76B77828A938A0BE90C77595567FD2619381FF0FD601777B7C226AEFF35E0B5BB7D6D88660027ED4E5E4265B2E0A775122A2E375F08DC24F4F327C9C2766F9CD8DF228AED7920250F1730A4A7D08531A26827EAD62E1BAA0A45EA9B8A26F5EB7CB6B36561F72FCFA31BD4509FAEC210D79E0E86B3048F8E629DABB24AF46C73547D40C0BFAB592078383832561F15DBD90E4073BE80079F3A489BCD51B98278337077F6791CAA0AC828A14865ADD78BBABF1113A171C06D10796415C7B0F4F3B732745BF9BEC82866D4508C1930B22E391FCB6D68AC89EE0D66A8B76BEAE525BC89AE9FC4C15A21169B7FE739DEAA80A7F19D5C669EBAC95A71EFE265A1570400315B8E853B7CB18E33E3ACCD4CF9E48546E36422E6E0ED282519DD5280FE5DB8B7877902188B17C4120444D729920963CA5AF34B94E365A8B0AF7947142C114C3F0A7FFF0714ACC3833CE4C0864185ECEFC7F36736F3E267DC956B0A1051ED765DF0BD12E1D25760A09EB05C16B327A30BAA1EA24552E15448BA1B3E1DF0E8550C7F4CB8240DD4146AB5FC002E33B4FAD65115439B10991417068B09AB2EE5B16D02C250A020B27580A9C1122604D1D69CA74CB478582614C56C4CEED92660B643C50712A132EF7D148BC27C4D1FA1E8680AE171CA8643EA4BE9EFD4F442B1BACB36221370D2DAAA509F78B76FA2611744D7617C12CE4B73914A26A0E64D15E8201C5BE8313FE0B0005102EDD25F95B440C96B90D9A92720AE271B542060B2EDB0245BCB3C83F901E2631B76C24768D28C18B01DA9C184DEF925D68C655E65A013B592D161841045F3EC54D0088449A64FFF0EA8E6AF632347BEAE431C5EF288A30AA74D95241EE7A6FF4E73DD22EAB04C6A6339CAA3A4E8C181E0751AEE8468771EECB0AAB3427493B0DCC2B19DD9A586DF437348C7CF9C5E3A8B1A630D5BBA6307CA395B4C797CEEBFAF5153258B325FAA9AAD673DE591DC8C0D589C61EB70CB7327B537AC1A31A6EA95C81C886CB3DE52427BBE10736E1BBDE9B8EA4AE6A2B44E7BC376B27C08E6FBB22A73B8D14CBB3BDA545B9430C30D6F3D67E0B42D7B122DCEC983B996188F79FE193F03CF1B446F166C5D8F2B1FBACD5C85678698EED8E5C76E2E0D55B955A2643FD1BBBC16D5F5BCA479AB5C1182FE2918BFD722DA84A010E60164C3ABF8137D293DC8719731F40ED404BCBF171E99F511F1E3CA723D59C34D78EFBBD463403F1E87337CA461447FE180EC53054A3F969218290042FF30D798B0C20A84C12A4D632CC9955FCE0D5DAB4AD68E71E5E4F5E446DA5FF1E2A5EF84BA2A3F222E4240355850B20CA5065330046E261E88156FC1A84442C60ECBF4C3D2242E27F8D806B022424D917CDA2830CC401C7AE9F1221FE533EABE3CD2B45E5DDC9379CEC4542B529977E18A8CCBD41B827CF900268CF7F6EB88C82415BA10930D1E157832F46E1B0F14E4944B720270C92509DC0DFC24F605A8AC015511B5554A4170F97064CFE6CF944D3B202A7C17DA356ECA45D92941C661B70B4AA679EC10DE7230C095F0590575FB28038E02A807ADD262BE38F3CA3F5A1D103EAF88EA59449AD040FEF17E702D2E46424A19216F2EA716B60070D5F8069215D580B296EDEA56FA3049972FA9A7CC947E1C56F669CD228B4C0446268BC47FB0D160EFDF7AD3218D3D57BC4B583319CA48A21D8D1BCCE5179421F776870F140CB9F18E2AA1DD2C5F877D91CBCCED0B4B8D84B111AA7160EE85B2C9B8AB69C1E3EE4431FFE4D3BD6A4DC6C8A800BD20CD8137AE1754BFC244CA7C5EC281381A237548A9D9AFFE7100B4254302EDD5461122D314B4938BA7B2A4423B40142E090E7AA3A6FD08578B40B17F189F9B16DABCB6DA64DA5470991398E9B3238DE4622FD2D12FCBA1928BC861ECC336BDE65A5BC43B6467CE293D37A1019EFBABA13ECE121B0ADE45AEB7C644C2D49C05B45F946DFB58E78B5373A4DB14884A241367672A563E3242D1856C8D1662D5F3691A6F5C769DCEF47778685BB448A8ECC5179EFE36CE6C7E5C04FB2644309018C064B2803CC1377D19F59D30B19E04D2981873CECC5C3E992C8889708B89E1990AFF746B340AF895962FADB2E2F926342137DAD8C1EBB09A616F658F40EBB28D3858D21B9F92A7FCE7FF2D421994CBE6072BCAC3E0DC3A030A212219D5DBDC906B07DBF29DB8EDCD213667F40CDE4AC7FB56E2A08A55EEAFDB4E71196FA642828D56983AAC268FFDD7E5BF02CEB2581B6DB158C91393A36C367F36AAAAFD2C40C2B4EB40963D1332155353412A2126C51BADEA6B842D2FE695B3CBA2E2584288304015905AFE6F808CF58A708290C4824CC484EED112384309A28E028D1E2EBD46CE419B5CEC1D9C9164C9A40218DCE50C9B466A8E3C357D3F86EE02A51F86FD361C000509AFB168275DDFE1F1BDCCBEB92CBB345E62CCD4F0328FB0A35FA8F28919927C1443D289AF808C8F034D28F79038DF670499E6521F080F0D365F2400D5D086CC7C0041D4DF80E4E4CE3906215D18EB720466CF8B43DE1C692BB71F63DF253EBD498A9020BA92517628263F65B8CC41A5D21BD76B6436029FED17639049766716B33F03E6F1786852AE47250BE2FDF8B6BC4F0084A823256B34A2C2FF4931119139FA60DFD0F376990DFCC08BA8A09B0EB3DC299CE091A1A15F1BF7C11FD35CC40BA9C2C624530441027ED45FF8C00EB0B2BDF7BCC18746DA7942C342D2A58A88EE549BD71915D1D907F0CF89C6E2CCF63025E0922E95E713AD78DDB8052E17007A83B966279E860A19F38FA484702A1229ED9BCE918B360B2C1EA70ABC182F62B2B6306802D70E4E2A83D46CAAAF950A1A20DBFBDA6ED1F21AF9C2AD2092875EB391A925951255D9FAE3292EC485B5C3CA16B003FEE565110E0A910A010C499AF322039140A83B28949AA8946FACC77ACC38CB4AE9E2AA250E34C0E63260BA989181C7470E0BD484C17704907A39EC96E2F4269CFFC95F311DBEE98360A999FFC28BEA9F9446A00758F83B5D492B602084DD47400864696BFB5119923EEC8D5CA82CF9F2BE623A7046A741A8F5A31259A37247F8EE9CF5EDA91B5BC5DE61AF067DAB0CE4C6C9881EFFB4E1D40C87184C38CEA0E07409AEBE92480294B852E21272AA71463C86354A37704B682825E1E7A1FB84A3329C376844286683055AAEC5C8BDD71BE9C88B3ABFA303E7885A0A027012B2B8EA8B83BFB1A8A8C4EC028DE82CC11CD18511E3F56137D84D326326AD2E0C479513F5F112E91454C6CA904010D328B94A26AFED5C8F14609037E17355E42B24222E7E5B1D84E61895C45090E769734E07AA03B00D08A0ECFE0967D7AE09D16843D54F6EEC12584F87EA7AD832B90DBBA8E39A0D21E867E3786D8FBAF19CDF7E56E9E9A44F421DD350D0D85AE095AE2F2BC0F9C7A8748279720BB0C0C6E7919CB83C40BDB3EAE1A6F87DFDAACCA342DF1C73AE02838ACCCAC609504A12F720356A57C4A3D21794A8106139C27503E6A6C47844962AC9FBBC0244601888B6F2CE6C41F8CB757F3E202F8B9A27D3057272745198A5CE7D2A4B227EA9CA6F0838B23EF2C66950F38693161AFBFD724EEA187F9D324C970B9F4BCD408161906A6648D18F4E6D52123F02694E39B6D8D1BE691C5AD20E793809F4D970893DAA133FB310146463EBF24617072871AEFC1CF9E885923416128479EDCCDB941FAFECE56906243A74FE19CAD9250141AE8B4CA6A343926D9076B964733D8978A109876475EC66691F659499CB552C28ADB0420E335F01DCC2BF041BD438E830FA09AE673C03930FF478300E5C1FCDFE6932AEBC289C3713A08B3136B37798527B2F67803C705107F985A1F4584AC2FEB24D195234DBFAF4097C1A1A6C50B6CBE1D31CEAE79299782B7A4482C21D1ED48EAD643681282282B1B0BF1150C20364431F62224FFD07EF87B9AA4CC4F73FD2284BE1064682DE6851DB21F786D1B6F73654DF04C06FB4F7E1CEF9480392AA851DB4308EFA35A16CF35B59DDE63F6208B90C776BE38CE0139E97C041D508DF432CA1D399910CD19A1A7C65C09A6CA89A5323D205ACC5BC75C312764B0B6599E10C2B8F4DAAAB9B298CC96CF3BADC21E4B797B52AE793B1BF08162DA0D4206FA64D703D100580435854460EE5085BFE241F8E149007EF2A373E2F48E55112AC1394721D0CC272C5C95D3EE9120A3F9F7758E5BBAC508FC5C20665132DEF552A7A65D122AFCFF8B1268ACB094DDB628D39ED6A5A0B86FDC96A7843C3043C083D8C06C8016AC05CC517BAFD15B6BC3EBCE8EE5F4C6D4A6B0722075586C66A769F714AEAEA49D6A0F5F330F8EF78EA55DB2FA5C4D057D3A1E17A92EE224745723BDD8FD7E6EAC10AFE9A0E22B702CA226F694FA079A95375E66B002F1E3C72C3CF63AF044C435A7EC2AB93570912535C40543A3B29AA9C8D07B0434443B32DE9C64B96385390FA0D6DFD80C2528697D253B9E7FD3AC3E5665E1FC0F707B7624FE526E5DF2242CB30740B6A965D82C4CC1F56468C8B43B4070C59F5F13A96E2D46ECCABDEC4702D1E8D57DE00F17200BF581760519FF2CA755AB85B1E6072000B0D7469B36C1D70290512A43F2B492C90C16AA08185C0920EB642054BD4D968396BA5393CA0364224CA7CE9EC77296E0E0108C691BFCE7B312524025B51F62C5A631440A21EAD737D224A9BEB8354C6F7293A710909A4C20E29F2DEFA90DC3AFCCA6608CBF4BD37800A4866A47DDDB7D6CB93E276CAD4C0BC6363B2204B8BDE55B1017181A57B3D8C21A452AC2E90329CF0A57734FD3D566CE07DAAA277390C0ED6A5F9E004F6A21AB57A29EAA2483421C06B7F26ED889E8FB5EDB83D7B323477C71CA2747065C8B6F25319E56CECC956A0F668EDC3667D16D2F511BCF247D1B0A0CB333741C2CDFBDF42E2397B92D582B2E2BAFBE4283F482460BC4EF92285A6C6901FCFD5A4207AB3ED31F0F96F887A9AA3106A11B8631DB062549A389BD938DAF7A78990698F57CD28BA283BD1627E33ADA7A5FED8F99D2916EC6369C3155969B420BD3226C7176EBADE1FDA729F841FDC40A4B71AD06CEE87D22CE513F044193ED05CCC89DA0B02BDCABA46B55077744E5CC67400CD2834299A5117C73ECC94BEC33014AC80A44B213E2454429E87186DE2AD19FCBB82717B410E17D53E0D3DC9E19549440B254C7476566B5FBEF170D9A72103FDECFA8C9734D1288524F5A14180BF729E56A3FAAD46EC1C565401646B60C319676274BCA3348D8ED8AD4CB033AD0E60F46E9326D7905EFD342FF4E62860140FE4EBB0B10A4A50BEAEEBC69454DCCA565480F0A343E69D82DC782356F4082E654245E50A9EB928B14A12C23554AC2BB690CDFF0A780F8B76450C894010C0AB69F32D1172F3A4093EE363285A1BCD8A28B652E02B0AC6AFDFEDC2FC544C70EE216805EE18F90FDB9629B315D2AB7DD2E4B07EEE3813802F131C9E9B1D28E566F9F92F0418B4D5D7C8F04A1B01FD4B311A2AB22B0663DAD07F993FA403F7752E9C4E8EF2E7D5B4015344E43914150AFA4C44E1761CAE104A9DE91BC81B6806264B4F888B7F24AB645F2F51D745C99FE1ABE1E733B8F9A54D6909E247E098D201293C3B70069D683DCE35AF0D91F490B1E439583129F45884ABEC6B25A5F59657C4F74846629746C48F25FBDDEEA64C931E3B07082204E35D3CE3DA543131FF6A284168D245EF1196B5138633030286F64B43B6BAEB12C266881E44F25B5A711553C8B30EB66070A12EE3B9DC78E9E91BCB1F5748F40DEA61B36711588A6A14060921D6776FA84BDA0B585A7CC1A855096763E91AAB01228F7EDD01C53C2EA0B5FB420CABCEC9A1EAB94EE0152A5D315AF370A1C192CC621FEF816C3CB4B9344DB176EB226138787C75280AA061D77ADF001267AD32C146C21CB02B7F0557624335E764B1BA948F81FBF69BD29641060EBB9AC541437900CBF32D8E206695E496E4747430243DD78D80CDD17320EADF225BD0CD0D158F95120AE130EFDF13441BF7578F4DCB3964DD9B507B95B1CBA60230D356C40C51A5D457F92BA19148D6A6E3F459A78A874921CCE17F654B72574398C481BA54976F940C1239CDC045F953EF5943BCBAADD35B9D3CAD3195337C4F28385D61282F97C8E1D63BFA91160F254EA157E7444E98DD5D871B839A9042E5E815BC681D6495EFD3A017806E8C28C4E0627DBF61D1240C12BBE5F08C3CEAD6A0635EF7CA2E816C56284BEE2E8ACEB4B4954B00B44DE006633AC5840A26D415C94A25A88F5B2B7B522669A9E9DD142CDC188B20A9D545E307081602646AFAB9A32B725D66EF158E98432BC2D889086DEC63D7C7B4BDDE13B3187FEECA3488AA1531E606839C04764902F0800955C6833C00FE3CCEDCDBF75F087227BF12F4603253F6177891F37D408D6D27EACCE1512ED2664BC87540510C43A1A89D8AA28C8DDBA97B1BC92DCBA9A68DFF3DC57338DC45F891BA704D17A18DE5E142B09ADD8F97A3A1266B251392C0449561E0D4EA4AD1B84D071D28038D5AAD50BC86CCC3569EDF18E5B24046668106D24767781EE56605BD41B1195D8470581517E3FD8109C0AC24448D57C146CC5D1335B140B9B4286AC0F6D2616030C0458BAD9310AB6EEE683489A1146F7A08E406F00A4CE8F514D4CDDECBD01EA05977F55C3871087B03777D0149BCB81E3A456510014E7AF448E03A36855777464E463261F419870C2E54A63B7E6D1BD9ABAE22855469FB9251394F58329F0225320C52A333CB228BFD6A0EF48420DD3C7C550C22459CFEB0073386DBE032D31C5B75ACD4F8C67AD82C71E7183969D20769A18318A725D1F22ED2BEDF1E9D72C4A8C240943370FED1DE7F23513AEA2AA1D5AEE27AFDAE647F03D98EA7121891227C9485A0A3EB5C72C263998B13CD68367AAC51CAB3CDE76674341A593B05546DE545DD0CEC049C4D445DFA36019F1448AA432ED1C0B70D11DCD69F188F10127FD96984DAEB3D2A7A3790196729BBA73443D109B38A96E394C3419F4E187EA26D474534588F2E9124E52E1001116886D350A2CB3C6CD3881FEBAEF336AC1162C84D0165F14DF8011AAF3587FCDE8D0A19FA260B652D682F57C65C3443AB602FBC27B8A0622C231880B1E62D095E1A4FCABFF880D86C3C4ACEA5946D981369678F4E34FD08A4625D9060363F22526D4D8DB175D6D854A9D15609F704322440AD183FE6FF3F4250213006D91FAC2985BCA13D4FEEA8020C8DC6770F517CDEC026E125C1AA3756A34C8CCCA219B0C214303637010586B8CD51DE2E9A29DD9675411C92540822514F10205820A2D6EA2EF3D742635D81A72AF24CE08C8FF0DC150219CBBC550AA20DD7797EA683ABF681C8042BF242C2799E55EE2C10577E3FDBB413B494447F121969AB56660700E260C31A01B88EDFFF3D8308940E295DC5AAC44CB9CDF672B3F7AD2AC7D7AC1CF668F913A64B8573A60947437E1270658919DAF571289CC5F2E0E7BDFE3E4911582B540B0B36732C5550358BD2738C70721D3C18A5BAE95A3A4DCC202C5634C390F1CB489CC907CB4DCAFE6FCAC299CAC3655BD7DB669DE2AE6AD77F3F78B4A6A154D7463944DA23515D1AB4C75456D601736BECB027B0D544062271A3345E0C9BF9333EB1B02D5038CF771C2EAA1FD6AAF8F40E9F077B907827A31193AEF045F4CB5C24A9F490819644834D01B57E09EC21038A2A701C7D21E0E92C67F3AC8151F9AB1442A9C122AD961DA84679584324F42308C384FE0A844714201EF64C0602EECC06C45FE04BFED8B664930A573B95FD7BDFDEAE6E6CB1ECC8EDA92939A92937C574CA50BFB8E6D4F92D713A4A0C3B9B098C2B45DCCD2544369A923C73DD95B6743D96549F9840781D6B0C1876B2A407640024C6A823292E4688D0A8F83EF689D7BA5A31F2D2A8039E355509F0C6A199D782346FEC75E9D9C4E5BCE1A1E668AB0F383E9B40545A36C4C90F92CCF6032DDFA51EFA03A1A026B53E092842AC49858E71322081457CC6006D81F0C3693F5892FEDBFB32290AA36B1F68199FE655E3BB57479012BC0090E58E4B9D6074A5665996666394ABC542B063174D67C7038172B85B646D330A152FF451DBAAFE2A215D1AFADD79CB9BB785E1B9F400C8DBC9F90E5E2BB54AE66760C0781C1233A33220521096AC8C5094FE49E8D631EA05188328C9732502ABD8A0EE35C8ABD039902A5C8A0C7BBFCB32508A2591731CFB1632F39DF33C2B6F36A6331E3DE35533A3CF7932D417E753ED68F1BEAF651465950B455F292A23F3675DF243043C727775C9BEED7E16789F048AB34A99E9F86DCE589211541DE582AC1B9139B25EA1F7862808DC97C598BBBAE330839320CC36DB8ABA774CADA3711DD41D44F9BD60918C2346704D0B591B76D8FE88C523155E3A7C24B388540C90B3097F4F39141CBDB541DE113F726C102B11A659E403C9AFF464A21AA4A5B3ED8132620623B48121C203B94A32DE0A42FFCB4EAC69FE2D7DE4E144C8C071DE51B1B11111E139AD656552A757DEF878844B97094A633EFE041288E275CE020A935D2F0110D09E7A9720E04FB3FDF8390B73CC92EF9378B802C2371A2FF1F396D95F587D362A615153AC8F687D84367B2C72F24C6A92C9B7119A92B95D69CF4BEE22A40CE1D0354551E2A867C78A71E38EF22F82240846DBC93EF1BA85D152752E9AF9A1ABF3896C1B36A082CF633645EECFE133E60354A05FE5BE0A16E843C8B9DD6A290F0FE1572614362B0E08C9569CCE55ABF8DC821356629F5313019D52496F7BC794BD2B1ED61260FFEA4D9BD07930EE2E66CAC9464710B87A318C6F66242C0764005DB8F9502046582F0A99B13B48A00F8796E846B2649E807D6E4B66A39BA514E07D53B0C5D85AB54BC30969E8CE0AEA37F5305F6F8312207B8505BFFB78DB0A29265D2DB06E0F617E626614371F8C49208B501ACAE806E3385458BCB52DB4D182B8F39ED5E4C2775D0E5882C189B38B4ABC1F49CE55688E6A044AC3717417D96053D0F22491BC3F5D93FA197FC246238864488B5C9A334773B11878AFB48D086CFFC5C8E389EC3AF54BC44F1C53B5273C8851F94D17F841F9D99F4EE8DC0A96640FDBA3B43F3B0174A44A2A8785CA45C1CC4462B4E201D21E3C749AD482B51079C76D44CD0264E074A10658AD6BC803314C0568A1B73699C5566DF80B5A6ADF40E80C5CA3EE7E4A989D4C40E6E043614F8829192308656EE7D81C7EBC53001640345FC9CA1D14CD3D2DBC4CA88E26224162918644A34EBA89408DB7B8B810476E33369014BE8195A7838BEE3BFCF49DE0CDFC19D50B57547879514D53B38CF19CA5456CE9DB44C08FA05E55A626984DAE33703DA1CDF56E277F20E3A9985423C9CCC85287D5BDBA4823CD95AB0D6334DB939FE601A8F1D18B60BE9D010B6D3DC14F6E2DF2524254EB0DF39895F498E4A9C46FE0BF5EE151CA3401D4DB116336F456C64E1B5349109341E94A852861D152FE10C400B98F98A7FE976852077D44765D191593723DED3E17A4DAF288BF54829DACCA038DB37070BE05B968849D8EF747A157AC51F33A31E1934574E6EA09220547E740D4472F70BA581E88D15C8C768F51FB6B006688F34BE85680AEF80B6FF74D1B84545EA641CEEC241110D4157E4BA521235529CED6A43F101D5CD9595E020E01019D819C214962576047D923CFE2EDA821DE59109C845DB58DDBBCDC2B0258CDD0D0B3D7833EF57CB9935F09044D50928B665E6460EA650634C55FE146F2B784331B815C36A9C966C9020C5A2FA9C351385ACE18405CB0EA0039F14F11EC1905D0D273C57E3F8FB218E5B3C5395BC8BECD356D513455FC70B9EC32598E677527F403F9D3A9F27FA14788D6D29F28019F44E80E2DA4787B13E60A43C8E66D81E53C3E42D02FA188C916B515D74C20724B2FBFDF902C720747481A4E268F13087900ACE6C33267CC83635E0B3ADB698D006801F967625E492B2066F6688857CBDF1452598F3319D9ECE68A85C1564A343B52913C8C09441E13C2D5F3BC59D61B624E9D671268708EAE80D74100446F8FE14A32E7DC41C4439793CFF61893B5A4D39883E99E0999541A82AF0DD8B93C07F07A07DA922217ABDDDD481EE8C5A2D6A6D0623AC3F2ED28116EA5C7ADCCC94FF0E201D1C989DC676D4043F33F37C442DD20C9AD459BCB89C2C50B453E6A91B087F3DFC72411C80E05B675A5E9A6129D0D145B3A119147FD00D37D92179B88E3AFE4E77F24A008A3D4B0DC86FBDD2773B53124E4DD5B30B08B048639A75C7094F966E81612D8C0AAF7E4B03E02E2930BD35F8506CED8B491C8038CE8C1160B5B4C11A2E57FDCA4F2B242C7F8B74E18C8C77801F09B277D4FF68FF40605A286801F24E50106005ECB27136EF343597CBDE60B132A57809D1F1FF82310E69BD5A8B851963486C73A681F04473A00E137737672B6E592572EB162422A17752CAD3E4D32076A49125B02B090731648762DD08362853C32A000167E8B32E35A372EA9D6686D82AB35656A4F4E00A6942CC4BA40E468A32C013C4BDFA76C73103E930BA5C75157B62DC3779E779ECC0956EC7758D83604D480590F88FE77B1FAD5AF7472B4905DDE62C59D14757ABD800EEE2D88E496BD3C544397A78A041E9161CB37E3F4E7B6E09C424EF12E9068B898944F53908FE800CAE8C10F625D800E0AFA6A53861E1A1F7C12E2ABA9E0D282EF848BD90C29A90A54AC5EC53BE5CAAD67C5D276E0C69C06862E1A79B9736E19C3AEA178BA8B0AE170BD304C4319DF261910B29B4B569D1B3507BF87468063AB4A53ED2D651DC7C47F6B42CCB57564E99DE5DD438A8069C8967E25DF402B8929EA8244AD67CA9B8818A03067B280A4DE2E1A1A22995BB778C40A704B0CE84A9248C7B6974970513B29AD3E58880E15054BF028AF26CFE30ADED531EAD501F5263F289E6FCCD67E978434296C52F42AA317E06C66DC4008564E971404E17AE00170211943105E89A8625B0B7D76E36768D00CCA75F68679938149075AEBCD04EEAF7C5C0BA4032C60B45515CEEBE0B57AD05C25B6A932ECB6F2ABFB088253039908315629AA975B8D2EA5CD5A1964C231934A310BD222C8896CB870A620293536A4D93E29538AE3EBF091B6EDC84083CD43DDE7DB84440C8DE69079EE11A1B7E354D2E02A326E0FA84821DB48C9B886C10D2EF5286F8DA7206C1CA5EA16852579B0201F8598446D4C0E66EE116507FA2E1F853C11890B32D419E093698B6B2EBAB9C4417178985B8DFE2767BD8624A2088E756EFAE37E98490982288094977A7A2538907653FA78952C133017BC129539300159E75E15C93807F8C8ADBC908C466D720E2A86D8BF9ACFC10263620B9B31DF7EEA587891D693154CF251AF35A2DC01B4A837FB8CA74F1AA744CC53AC3953B68D51F71D14CEFDAF91E3972B2993DE80F83C9E1E401128531A8C17462BA7892CB962BC084C91130CE933A36B2A74AEC1C5BFE498684351996E15CDAAA5C5AB9C767228397135845E82469085104AE5D97523C0C7634D0DDB2D7F49CA6822F6BDDD8AAFC7558A405D1BFC00DC8E80506B0B2A12767C0F905CD1F568991CF277EA51205F04354E80255FCE010B93E822CE08C30448C6F631E6D6339949E100F7AF00357E982378611BD2F17190CE6E2E71A43FB8E03ADAA98D54F78445B2C7C433409ED8CB75D2FC9344C7B2C24A5FC368D5D5C7CB9BEECE94647CC6B65C69DF829EA1EC6DA913052A534990D27756B2BC0AF7A533A945A49B4A3B20668D94254326E18226EC1605B63EF618C1259C81BA5342A20CF8DC64E39F4D7929694B516E64CD03614290D3C033B6B1C0B030171CE4EFA65491D1F376FD2469944524666EA0A28AAD35A48E15EE79E677FE2B38E9B11C1062731935F2513AAA3A5230A75A50AA446700B10C5A326776241100A2155BAE98E8CAB6843116B153E8BAF5D46399CF5F6EA67202B0144E34B0E1BAC6C1AA55FE7CA565E643BC1E15A1C09FC378CE37548D23BE3283A74D6B590CC8D25C64464B83A506D27AEC7F721A911F039AC4671A02564DC266A2EB78D6348A8D100E71F99FA861E499CEFBF200F8865D244BF30BA23EA4706290BD108EF82340B134F9E1ECE3C1226714C15BE72D5D33CB8DA2CF49181DED7BA3055E26D05DD8511D5ACA38192BD1AB7271B653005A6EBD06A3DE983CA28259478B4EAD1D66BA479A92F375E892075329BEA241C4897187F64C370F0171DC5D48CA543F3599FC8A87E7AD5C46306DE61518F471AE909B842601348CE0D92D657015772A7A59E957848263E359EB50DE8CCE2D2E37BC6DD42E4B880221F2B949BBE202A2648F42E9CD9E958D5481BFD186D444320FDB69B249C4EC2A11E4C6868D1E27E0F601163384AB8BA30B063B4D82C70CB26F061B2450AFA9C489A2FA3F11A09EA4CEF28B89DB6C5EF2A23CA9CBE1D980314807ADF85F64B3E627917AA0D05E35687BEE745FE67FB72842B1684587A9C41A8CB8D424E30BA1A7D0A17C6891738AD96B07C9881141FAC9B1C76AB47D0A1D32EE8B3D1B7F38003AB07C7CC89270E004942C3EEBA178E62D0F6EDA1C81B97E3EB2492AC594F710F2414119A481936A5E970F941C7BBD08DE49304D1E446CEF76E52713DD9485EA73CFC6B92DF4B09954DD20371C1E88087D73F0C885A68327486A812A1C9C36DA7E");
        byte[] sk = Hex.decode("FFFA0806FCF5F30D09FD0009F707FD010A0004FAFAF504F2F3FBF8FAFFF309FAFF1104FDF8010503F7FE0E08FAFF1806EFFEF2FEFCF1FD06050B07FA060C01FAF31300FDFD00070100F9F5110FF8FE0FF709F4FD0307FEFCF60800FF02F2FF0FF9EE07FF0703F002FD03FDF80902FC0B02F7F1F304010407FF0701FEFCFE15FC0503FE0804FE0704F202EF09FBF408070D07F206F307FFF502FDFD07F70404F5F8FB01F704E7F700F40501F7E00CFE080AFEFBFFFFF806FAF606F5FCFCFBFBFB00FD0AFBFFF5FC0B0EF411F4FEFC07020707F9F817FA0A0507FD0508EDF3FBF805FF00F1090607000508FB10EF0504FFFF0301FD0D09EFFE02FFFEF5FCFEF1FF0403F5F3FDFB0506F703FF09FDF3F9F5F7FFFE08110F0201F60701FAFFFA0A0404FE0809FF0AFEF20D09FF0A10F7FC020409F7F003FFFDFCF1F4F707F801F103FFF504090600F50301FA08FCF4F7F90C1310FCF20AF20E0CFA050103FCFA05FDEC0B08FE0502F8F9FD0C03F6FAFFFE01F8FB02FBEFF8FDFD0005030002F9FEF2000603FFFDF8F4F50206FAF9FC0BFE02FBF20BF400FFF90E0001F10FFC07FC12FBFDFEFB0702F8011008FDFF01FC06FF010501FE060A0201FF0302F116F4F8130008F60A100906F90309F7F605F4090C0510FEFAF8010609000A09020C1203F8FB02FFFC04FF0BF803050AFC06F1030808F6FB070000F80D0404FDEFF8F804FF090DF708FA050E02ED04FC0105FAFE080EFA06F706FA01FAF3F80404F905F3FFF0040406030505F808020B0803FF0FFDF8FB00F80102F7FAFDFEF3FAF9EDF0F704F302F10503FAF20302FBF306FAEC05F20A0400FE08F7F90506FBFEFCFFFA0E14080EF4041002F60702FAFCFD0F0B05F7FF080810FF030807FCF5FE020203FDFBFE021209FA05090205F800FB0011FC09FBFA14EC0610040C070A020C0CFE0006F900FFF8FBFE00FDFF0305F50B01FF02FCFE0708FDF7020006000011F800FEFBF7F6F6FBF4F50DFB09030D00060C030200F7FEF3F8070605FEF7FBE907F903010003FEF4F9F50FFBF0FD010810040502010AFDFCF00A0403FB030F0203F6FEFF060CFC010905040BEE0EFE01FFF6F6F508F90C0503050404FB090800FFFF110D0B0111FF0BF405FDF302FBFDFB00F603FD07F4F90102F5FF0908FBFEF901EF050DFB04010603120F05060B06FDF1FAFC0408FA07000E0DFAFDFD0AFCFCF9FBFA0AF201F904F9FAFAF80CF40003F6F9F8020805F709FD08F90BFCF7EFFE050AF901F4F9F4010704FEFA0CFF0506F103FA10FF09090109F90602F7EC03FE0107FF02FCF101FE05F9EEFDFAFC010301FE0202F80304050107F30107EF060100F9EEFCF60603FD02070CFDFCFE0AFDF90EFD03FF00FBF70308F50407F8090D010AEC0603030909FC020908FCFDF8140CFC1510F404FBF20AFCFE0FFB03FCFB0105F8070B00040AFAF6FFF8FB0C09FAFBF806000109FEFE0F050908FEFA02FF06FB03FF01EFF40AF9F502FE030DF4F6F9F4FCFCFBF9FC05FFF90A0204010901F903070C1007F70008EF03FF0DF705FCF8000F0A0312F204F810030D00F0F7F5050008FFF6F9070AF70600FCFDFE00FB03FDFCFC0302050506FDFE04FAFEFC0303F7EF05F3F70BFC06FE00F3FCF3F5F3000703FB07120604FFF9040A0406FBFAFAFB0309040C06000312F901F30200FA00F3F4FE030505FFFEFAF7030D1104FCFC02FCEEF116FD0B010B0EFDFBF904F3FAF3FDF90001030801FDFBF807030706F70304FF16FDF700FD010BFE090DFB0502FF0CFC00F5F00A09FBF604FF02050A04030AF3F505FAFCF809F900FDF00A06EC04F9FB0302FE02F6F60B0707F8F209FCEDFE08FBF709FC0805F904FDFE020AF4F2FD030303FFF8FAFB0CF60BFFFF07FC090613020502F7F2FD02FEF2F2F400020FFCFBF905F4FF03F706FAEEFA03FDFAF607030207F8040FF71101FEFFF50200F3FF02FBF901F50A0B0706FC050900FA000AFFF0F306F802FDF00BF910F202FEFC03070501EDFEFF06F805F7FE04ECE5FC0C00F50B0703000AFAF0FBFEF5070FFBF3F10600040AF3070704FA02FEF80703040107FDFD00100B04FF0402FD0419FDFBF5020901020B060BFEF5FCF207FD01F2F609FCFEFE14FC0D100900FAFBFD0AF802F80B01FD0008FDFB00FC0102F7E9F304FB04FEFCF60AFF0B07FB06FF0D020700EBFF040B00F5F8F0F905FD040807F3FE04FAF2F60AFAFFE70AF7FBF6030D0B01FC05F701FD0BFEFEFE02F70B0101F4FB08F1F600FC09F5FE03FBFD06FF0405FA03FEFCF7F601FD01060800040FF8F4F9FB070EFCF503FDF707F0EE0B05FFFC0703000201FBF9FB03F7FEFB06FFF200FB0004F704FB0904FFFE000603EE0A060BFF0AFBFF08F6FEFAF9F6FFFEFF0BFA0AFBFA08FFFFFDFF010BF60512F9FA01FDEB02FCF9050DFE01EDF5F3FA03041304FBFCFC01010CEB06011304FCFC04F7020BF6F10400FBF6F9FFF60FFEFFFBFF03FFFD03F108FFFCEDF501F5F8FA060305010501FCFE0DFD0600EF0304F907FF0000FB03FEFCFEFF0FFEF8000402FBFCF80D0709040B15FBFDF7050207FF01F8FFF7FA0608F8EFFB030AFC0DFA0DF8FC07F603FF07F408FD050EFBF9F5F5F60403F706FF030C1306FA0DFFFFFD090405020105F7020500FE07F701F608FEFD09F910ED0BF6FCFAEF0B01F4ED0708FB000213020700FAFBFFF9030AF6060A01070712FC0C03FCFFFC060407080104FFFC0904FCFAEFFE03F8FCFB01FBF0FE05FD06FD0F09FDFF03F40504FF00FEFBFDFD0EFBFFFE0B0AF4070C00F4FFF5FA05F10505FEEF00FD0303040103FC050407FC05F90104FD03F501FE07FD0BFBFE07FCF5F805020301000103060902041101FCF8FC00F301F503FD05020601FEFE070409090400030BF60B01F60DEB00FD1803FE0103F70AFFFBF90408F611F7FC0707FE080203F305F8FDFD04FAF5061005070301F607FAFFFD08020AFC02070BEE0907F9FB07FE02050F0AFE0FFCFE07F509FB0C01100306040E02070B0202FC010DFC09F801050102000CF5FDF9FFFB0004FDFB0A040506FAF00607FD0EF10DF5F8FB0408FEF3F4FE12FFF500FA02FFFCEFFDFDFF06FC09FF07051600F7050702F60608F102FBF60CF50400FB010401FE0A00FE0BF50CF809FEFF04EBFE11060501FEFC040B040605FF00000100FD0EFE00FE03F70DF4FAFF0400080AF80310F508EEFCF20AFA030C03000E0308050600F901EAFA0A05F800FAF6F808F803FAFEFF01FA010902F9FDF6F60A0CFEF702F408FAFEFD00F8F3FC05F9F60200FB05FDFEF50A01010D04F908E600050CF407FF0404F5FDFB06FFFEFC0006F604FFF707F809F900090E01FC0C040AFD0C0BFF05040AF30003090EFBFDF602F8F8FD0101060513FBF805FC0B00070AF500F803FDF50702F0FDF9FCFE01FD05F8010E04060000FAFC06FAFB16F6FBFFFF12090805F906FBF9FDF8FFFF1106FEF7100707FC0406FA11FE01FDF5110D0B0DFE01F807F6FF04F4EC00F50502FCE90AF9FC00FEFB150D0008F8F4140F010CFB00FB040F020207F209000BF8F409FFF704F3F7120511F90FF8030904FFFB020900F907F40BF605F607030BFEF301F207F1F801F9F705EEFD0FFE04F004FB0AFB0405FD0000FEF90DFF01FD060606F8F8F60D0AFA01F9FA051C00000B0FF9FE01FC00FD0E04070109FC0507E409F6F601080D02F302FCF702FC0BFEF302FFFF04090105FFF8F6F607FA0A00FFFDF5FC0AF3FAFF02ED09F2FBF7FBFF0CFEFD050D070505F8FBF700FEFEF80005FFFAFEEE0AFE0BFA000906020307F60607F80200FAFE0BF60604FF08F9FBF50606040802FD0004F4F8FCE9130911FE0305FEFEFDF905FFFF0D0B0EFA05000500000406ECFAF8FEF40AFA05F504F9F9010BFA0302FEFDFC07FB02FCF40D04FDFD0803EDFC0F00F7FE06FB090305FCF9FFFA130B0BFBFDF501F7FB03000D02FD0C0300FD0BFFFC13FC04F90E0804FCFBF803FDF7050907FB0702F8F9F8F2050102FC01F40A0614F6FDFDFCF00805FBF803FCF5090EF6FE0900FE04F8FAEE14EC000600FB0801F7FE0408FA0AFE05FDFDF907F5ED0A0C000409FCF305FF03090AFA0401F0FD0A000DFAFFFA02E9FBFE07070501F508FE03F50BF205FC05F50108F405F9FA02F101FAF50B06FC0AEDF4000DFB0D06FCFEFBFFFBF700FD0B07000703E70A0406FA050400080001F00E020D00FDFD0800FEFE04F90300050D05000D090700FC0E03F50304F90007F60D020002FFFE02FE0903010303040706F70800FA0706FEFDF10608FCFEF4F5F1F8F610FBFCF002020702070B0DF3F707FB07FEFB0F06FF0A07000C12EB0FF9FA09F6FDFB0B040AF7110302E9F6FDF0F90A04FF0AF3E6FF12FA010804030AFD1402FF05FA020E040201F502F908F00E030C02F8F9FFFB0201F903F3FFF6000606FBFBFB0204110CFAFCF40202FEECF3FE0003F007FF0AF90302FEF708F00DFD0B0AF906010206130809FB07FBFE0907FD080002F804F2FC0CFBF40301F40607F7FCFAF605FE06FD0DF4FCF60400F4FD0AFCFC0B0C01130807F502FE05F802FFFA0404F908F6FBF802FCFC060505FD00F604FE040802F20100FC070500F40305FE09FDFCF4F903010C010313FBFFFE06F005FB09F8F2F3FF0A05FC0AF6F7F506FA0409F9F900FFF7F307F602EC0CF8060EFB02FEFCF311F910FEF8F0F904090A0BFBFDFF03F8FA0E02F90D07FEFB02F9F206F40308030A00FAF704030204FA05FF0BF600FF0309FC05FEF9E8FEFA05F5F907051405FEF3F5F0FFF5010BFA06F6FD0D0504FEEF000CF7FF04F004050307FF0AFD00FA05FFFD05FC02000E060DFA0005040AFE0A01E1F2FA1508FD0804FFF900030906FCFAEB00FDFCF600010207FD05FB0005FF0206F8F900FEF902F903FC0BFD05F3F9F81306FBFEFFFF02F5F7EDF10FF50D03FFF6FD03FAFC0606F90B020B03FD07F90C0213F609FF07ED10F900F801F6F8FFFD05FD04061005F6090308FCFDF10400F9FE1702F811FDFE05130307FAFF0AFDF5F60907FEF5F9070709EF0009FEF8F8FFFE0A0CF6F30100040807F70D0D07FE0303F7F808F7060808000003F303F1FF01F700F7F70CF8FEFFFF01F70303F50600FFF800FF010AF3F4FAF001F105150C030803EFFDF6FAF3F6F900020C090A08FF0400050606040408030401120AF9F3F505F1020402050E010407FEFCF9FC010008FBFD09F7FCFC04F9F804F604FD0BFB02F407F8FB0702080404F5FE0A040B090305FCFE090C08F90705FEF8FEF8F1F501020DFA0D0504F8F900F9FFFB00010402F6FF0FFAF905EE09FF07FFFA180501F9FBF9FAFD040A0405FD11F00D11FFF900F2FE0406FD0BFDF8040DF2F80801041205FD06EAF8FA10F2FAF6FDF8030CF7F7FFF702E8F510FC070E0706FB04030D0C02F60C0904FC0AF5010700FBF703FAF708F501F7F9F80FFD050E0300F90D03FE1510F0F9F7F7FDFEEC101405020E14EE05F1F50C05FE09F5F602FA04FCFBFD01F003F6FBF6FE01030D05020310F6F8FAFF080906FDF6F6F604EFFA00020704FDF9FDFC07FA07FAFFFE05FFFAFD040C090E18FAF1F40400F3F40103FAF7040BFD1105FB05F7F505071006090BFEF7FBF90FFAF800FCEFFF07FAF8F905080B04F4F9F601F707FD0E01F5FFF3FF0700F4FA04FFFCFDF6FF0A0107FDFFF404F80AFF000402F20A06F90400FF13FFFF08060DF402040511FE05F7EF03FF0206F6FEFB0DFE08FAFA03F3F3FB0CFDF9F804FEFD0D03F9F8F2FDF7F8FD0B0BFAFDFCEDF3F60FF8F807FA01000203F9FF0C0AFF0D00EE07FC02F4FB050B03F608F9F4FC02F5FBF80200E905FBFEFE0BFC050904FEFD060006F7FB01FDFD010FFE04F6FC1207F511050CF8F6F900EBF7030CFA05ED090009030B02FBFC0608FDF60A01F608FC05FAF7F9FE0A040D010B0EFDF90402FBF702FE090FF5F7FD010301FA05FD0206F4FFF4030402FA0BFF1008FC03FE0A0607FCFD0108F60C010B080110110501080506F60708010BFFFA02060D100304FF03F8F503FC09FF08F00304FF01F1FC06010404F8FA0406FBF7000307020DF50C04F9F4FEF500F50105F70AFF100B0F00FC01FC03EB17F9F1F3F5FA080FFC0307FA0900FBFCF1FD0106FB0BFCFF0D0D1806FAF90EF7FDFDFE03FFF7080404FBFCF9FB0AFDFF13FB0502FD00E9F50CFB100800FDFD0FF4FF010307010AFAFC0DF906F4FC0514100B0A03010301F6FA0609010604F90009FA07FC05F7F2F601F3030DFE0A00FAF903F7F603FB05FAF8F9FE080F06F11604F3FCFFFEFE0200FCF8EEFB09030CFD0306F504FCFF070AFE030805080CF405F5F9070416FEF5FA0003F4070203061000FCFC05F9F809F9FFFDF908010BFD0602000D100BF8F8F9FEF6FEFB03FB01F6F70401FAFBFCFFFE0100F800FD0605FDFEF0FB0AFDFC080005FCFCFBFA08F7060205F1F60305020800FE0307FEFB00FA00100CFD060A02F70EFFFD060BFC03FCFA00F9030AFF03FAF7F414FC00FBF605FD03FFF0F802050BFA01F3FDF802FA010DF90107FA05010AF703FF050A0304FFF905F8FE05FDFBFA010302FD0E0800FCFCF8FF0401FEF30102FAF80D09FB0301ECFFF70301F3FC0513FF05F3010F04F70AFFFC060400F1F1F8F802FFF30FFEF8FF01F9F6050402FCFF01FCFBF80703F3100B05FC05FC06FD02FC18020B101102F40604FEF610F005F811FC04FAFBF50E02FFF713EF03F50700F3090301ED02F507FFFDFA0306FA030805FFFD0F0CFF00FAF0FB0609FFFC0C0307FFFD0F03FDF10606FAF900030C061705130C02F60AFF0DFA060304FA0106FDF7FCF404010AEF03F9ED06F7E8F9FDFF070901000105FBFC04FFF8F5FF0306F6F7050700F3FB0608FEF6FDFB0E04F804FEFDEDFC02FE0009FE0108F9F8070506EC1408EFFFFE0DF7F70DFEFDF8F80408F707F6FCF6F10105F80C0210FDF300F3FF0702F9F208FDFD0500FDEFFCFEFE0005000C05FBF90D0308F801F7F9F30302FBFBFC04FC09FB08FA0B00F0F5FD02F90C0506F80904F00B03FBF809FBF7F7FFF6F908060503F5FEFE07FB02F909FF0D0305060601FDFEF8F70007FAF30301F2FCF8EFF1F803F6F8F40D0603080100FDFE09F90002F71002FD01020DFE0105FDF0FF08020403060CEEFE0C06000001FC15FFEEF80FFA04F301FB09F1E90C0401031204F70EF4FE01FFFCF208F8030BFD1405FD05F205FEFA08FF1109ECF8FAF8F904090B0A01CFC6B92DF4B09954DD20371C1E88087D73F0C885A68327486A812A1C9C36DA7E4F5C254B6292FB5C3DB9561B8793D8AE3E1611423AC0A9F8CFC13E1C85FEC6B5");


        //
        // Key generration.
        //

        //
        // The QTESLASecureRandomFactory.getFixedNoDiscard(...) is used so the same key values can be generated for a given seed
        // for testing purposes. You MUST use a real SecureRandom instance in reality.
        //
        QTESLAKeyGenerationParameters keyGenerationParameters = new QTESLAKeyGenerationParameters(QTESLASecurityCategory.HEURISTIC_P_I, QTESLASecureRandomFactory.getFixedNoDiscard(seed, 256));
        QTESLAKeyPairGenerator keyGen = new QTESLAKeyPairGenerator();
        keyGen.init(keyGenerationParameters);
        AsymmetricCipherKeyPair acp = keyGen.generateKeyPair();
        Assert.assertTrue(Arrays.areEqual(publicKey, ((QTESLAPublicKeyParameters)acp.getPublic()).getPublicData()));
        Assert.assertTrue(Arrays.areEqual(sk, ((QTESLAPrivateKeyParameters)acp.getPrivate()).getSecret()));


        byte[] msg = Hex.decode("D81C4D8D734FCBFBEADE3D3F8A039FAA2A2C9957E835AD55B22E75BF57BB556AC8");


        QTESLAPrivateKeyParameters qPriv = new QTESLAPrivateKeyParameters(QTESLASecurityCategory.HEURISTIC_P_I, sk);
        QTESLASigner signer = new QTESLASigner();

        signer.init(true, new ParametersWithRandom(qPriv, QTESLASecureRandomFactory.getFixed(seed, 256)));

        byte[] sig = signer.generateSignature(msg);


        //
        // The expect sig from the C version is [sig][message] so to validate we need to append the message to our generated signature.
        //
        byte[] expectedSig = Hex.decode("6238CB4227F176C95E1661842CE9AABDC1BA0DF9801F74239152654841BFAA0EDF0294AA66D9BD9AFDE6F7F3627BB787B556493F32A81F94FF26193539BD9DB6D7B7DE91CB22BE2435BCFE3DD4509D8FC316CE42FB73E385DEB3E0CADFF8ADBD7EBBA602003FBC23F63D88A0BD31319A2BFF0721488191DCC13E529F9A6E3359AB22BBAAD3C85C755FA5649EC2BC84D7AD920DE7F9C6663B8BD56F53F6812B73571418922B710FB3BDB86ECF3BF1F7D12A5E32F39EB4FEC46534D940AF0B9F069C65CEA2152FABB44E870298BD07270E69E000342A1734E1CBEEC02E89FEF4036991460F4C6B71BC39DCB5DDD8FCBA78A264EA1BA64DE8D7C36D786C688E369EE15C55AD0F18443FF9565C57CC69CAC4EB5ECC49A77C799123F960FE7B185116BC6BC991903814F9C736815AFEF27A742A58A684D2AE284661AFDCBBCDD66B703010DBD2DB5AB56850F35E9F819CE240AEDE97EA43A483BD6AE1A9A8CB7FEE9B2B3398B63642EA5A7739BD793155B25D53F23BF08A89EA0A0B20829F40E83E7544BFB7FDCE3DC75189319D7C10E41395A40B64E909F2B7DDE0022C80E00C73661EDC01B18B5AB934D6D10201E5E11C84A90DDC9C41D98BBCEF8C575DDB3445474090E0EDF7AB340BA6256996B6ADF37A2A565BF81C31252C84F73CE4B30041FCCC674C44A439059704E944FB24767D52A6C72A41483B626D75D29F00CEE0CF53EF26C44BEF2E05105E64971D00D774747E0B590D3784146EED28C5059EE3203E5C668AB3878874F7B2B6ACFF34B6531952496624D49F7CDD3A2C4041D9296C59E36DF4C5AC471AA470FC37EE2E15ECA7891287D60EAC457D275138EAB20F55D2A93BBD2D1EF87517AB1F43ED1E6174F169AF0FAC48BA8FCD090753844E35F87B4DBD8351DD539B57E9F2418F23416294E026F2CA9A7D6D43596ACD6A684A4C96BDE527A6A3736D59E210527A180E632B33F43AEAB4113288CBBDCBA92E39378EF25FE70F3EA29C41E04E4474BAF79D5D0E78F57197495994F2EF770FB6856C25560F5E78ADD985AA1D2B8035B9459202F376B0E735BE3907E2E73BA6BC6F6D7583A137F910F41F3C21D817269E5C13012AE16E0A5AEA1B6545487BFE563C3CD2032ECA29DD90F0FF448ABFF7530C79F7E038C3CF8FC068250A8D1AA438EB98DB977F0FDE98EFDA31E18A8B82E33FC471ADA95BAA027909BE282EE4CA2DF6BE4477CBC23E599B8AB0E8715EC423F171FB04BAEA8B6DEA751C3DCFDB91B6DB6887E49DE3E0B199D8EAA27B40C16F41A881B2923B32EB44FBD4AC0C33AF5F7B62D04A1284E33290DE7F2283562D427E119FDFCA3D73B588CEDC11E855D88FF44D94970B629F66C6C03EF548E384B3A62C2E124B236D1705F9DB3B7197AA7BF8E6CBF731B000C56E4934F6D931947FCC35DEB4FF3A07D8A3DDAA30C3E88981561FEBDA0FEAB8EA2FE9E7C0A3DA496320F0FDDBCB9A9F6BB442F246A7FFDFB4A301456EFF8D67B6AE2BEC958BED930D6C73BD24ECCBFB58C293186DB871A40966CC6D5ED1780C076A8AA54B4B0471E1FE202DD02A59D3187D4007A8940B67A4D3FD1A8FD6AC77D48EB0646A30625BB2E261937422B0885180CCC7CC89CC9D14A00004E6D5E9F1EE25A94790ADA993904025ACB1EDF36E100CB8C3CB5AFF7E5FF36B7ACD94F865452FFBB2F180C4F7094574DD3A48E275E89A3D4E7D6635D7D5A95A11907CA974329290CC170908176E6C990E10BB8CB79051D690C5B71316BE43C384FEB0BD9DEE36A1D1ADE7B024B006DEB4A7E165A9A87095AB59DA160CEAF0ADC90331720D99FFADF0C04B22FB30E7F3D91790B508651FC368B545C728FFD1585FBC174A66554F5BF578CC6D3A903DBD188EF2E08A7D8A4B359F848B651DCE24B7F7F26C4042AE110A4048F84E61188CA6B59F2871990584ECBB3639C160B49B5539C3B6B969055490572CE5DBE5E27DC5F2FEEE41D081FA4F2CD660F3916CAB71C1582A80C34683844552DA13DA923791D274E33D02BF1ED1AD5D63C7A51232711A2A650A7D141AAD346672BA714711F70D0786DB17E0B4D2D30358D1F3BFBD0FB6C239730E6E03788E6915ABA1B7494D71D8A265A4BED8E477CF8885A2F405EE4911653A45D2F9AF62AA25B1B2BB7A369F766256124F20ABD9A0166C4B89DC1646AED2E818B7A33C44E58948BDA30098624ADE2B9BC19D186F43D33FC53962AD7555C153F7BFC80933B5262B7F626E4C4A429F9166AD15BF377C3D829500B91E716EDA05A4B099452A1C8DF4F7F2E6B182FF7FACBA7C12D6302D5B0160645BCAB4ECB45D1D6F8BF53EF0BD3B9A391B400D96C38C886D7DF32F0158271C3EB9259D070EEEF7B6A01D25BA33FFF465408E41BBF1BBF4B881BD1463CF326D3C932D131CB9EFA64A6933B5D8A0E06D4C6C0E9467EE6BEE70DD78BCFA2A5D96642719508DD2FF8F710353E8A1D6695F7DC9CF2FEC592B3581D3995154DFE2F5C0DDCF11FF49D1560D804686EEB4D9538D281CE524B382218B390DA7D34D29583D082880492175A3A348541E8B971F6F39921ECEEBEE775738C015D2DD07A8B1E325E3E640E13B97F9E54A58D99E249C45704370CF4CCD938E5552FC51D3EA76F1ECE57FE6415D751267547BE9B8D68C494898D610008C10070BE6D446FB3A107D961A2395F664D01171B871B1310A03BB8BA672DF01103345F25D484EF87AE99DA56FCCB0C97E7121FA07ED74C17CEDDEAEC7ABC18E14B2376E6E11805214F7473BB4514CFBA0A54BCB855395CCF7EBCEBD170776D7E78DA4FFC9F08A7D33A1042AE86DA1EECB44452E96CAE5EB874E78B69177B6E7EC75DF6CDC9662C1B7444E659BA4662C0445A5D729D2F2A5AB36ECDE30C28699ADC14EE7305F6E7810AD277E979199005DBACDD41521ABFA6AF26A991BF130C3277A810831696D11125976FA7B96CCEC7C429DCE00AD8D892E9F60A6D0BDC82F53CA0667503416C5C1B1D86DD14501811B9C7CA109C912C822E0FE1588404D92117F249405224CEC625291983F77439A05D1404692A8D10658F3BDFADF5593F89F60E34A04ED83E45CC61BB44D43B3331BA1999229EE2CAB3DFD2797C44B4DDDF6740EEF186EC98E9FB9BAE3155FE1E97DFF8B59E10EDABD282B539161F3EA597B5B8E33306578D7F6BCF1B1CDA1F72237FDDAC7BCAF15D112E6CAB50E38E57140CC9DF9BF8C1EAC4A44CC507D2E3B256934C6F8BAD57B9CA1B24562F3EDD7BD1ABE110AA52FC71E4FDB4B4EA7EB3113E69620AEF2C1F0CDD03CB2910FD61E98923B430BE4B5BEC6A7AE517F2AEFD746E0269D168D543CCFEFB1A36FFD17A8B208B2358EE40ABB64F0A887A27C3DE64B32FC78BDA1BFF932668A230A1AE8BAC4A64DB572400D28F4E53ABECF0EA12C64910E59B0C5B979A71A609B85A059C7052D6E077953E6402D84C5047F0D4F45B7D53B36CB0C3FFEFE1DE6C2DF0B9E5C5C5F927580B8FB67D698ABFBD095198777AE89AD25B79A5CA3CB64EED3EF6A566B222070877DB78DA2AE44976BA3DB7EA0D7D8066E4358807AEBC84105DF99A25E7E99553E8657B4DF176FF9A0B7B61EAAFCE6F196310173DA2465E73D40C66C4956A95C6AF143B24990451799249CE76E3A49B0D4C11A97FBA5413B0A99D5EB8D8B8DCB21845CB1B2AA6014F2B3D81C4D8D734FCBFBEADE3D3F8A039FAA2A2C9957E835AD55B22E75BF57BB556AC8");

        byte[] generatedSig = Arrays.concatenate(sig, msg);

        Assert.assertTrue(Arrays.areEqual(expectedSig, generatedSig));


        //
        // Round trip against the public key generated by the C version.
        //

        QTESLAPublicKeyParameters qPub = new QTESLAPublicKeyParameters(QTESLASecurityCategory.HEURISTIC_P_I, publicKey);

        QTESLASigner verifier = new QTESLASigner();

        verifier.init(false, qPub);

        assertTrue(verifier.verifySignature(msg, sig));

    }


    public void testSignQ3p()
        throws Exception
    {


        //
        // Values put in file because vectors exceeded length of string constant.
        //
        BufferedReader bin = new BufferedReader(new InputStreamReader(this.getClass().getResourceAsStream("/org/bouncycastle/pqc/crypto/test/q3pIII.txt")));
        String line;

        byte[] seed = Hex.decode(bin.readLine());
        byte[] msg = Hex.decode(bin.readLine());
        byte[] publicKey = Hex.decode(bin.readLine());
        byte[] sk = Hex.decode(bin.readLine());
        byte[] sm = Hex.decode(bin.readLine());

        bin.close();


        //
        // Key generration.
        //

        //
        // The QTESLASecureRandomFactory.getFixedNoDiscard(...) is used so the same key values can be generated for a given seed
        // for testing purposes. You MUST use a real SecureRandom instance in reality.
        //
        QTESLAKeyGenerationParameters keyGenerationParameters = new QTESLAKeyGenerationParameters(QTESLASecurityCategory.HEURISTIC_P_III, QTESLASecureRandomFactory.getFixedNoDiscard(seed, 256));
        QTESLAKeyPairGenerator keyGen = new QTESLAKeyPairGenerator();
        keyGen.init(keyGenerationParameters);
        AsymmetricCipherKeyPair acp = keyGen.generateKeyPair();
        Assert.assertTrue(Arrays.areEqual(publicKey, ((QTESLAPublicKeyParameters)acp.getPublic()).getPublicData()));
        Assert.assertTrue(Arrays.areEqual(sk, ((QTESLAPrivateKeyParameters)acp.getPrivate()).getSecret()));


        QTESLAPrivateKeyParameters qPriv = new QTESLAPrivateKeyParameters(QTESLASecurityCategory.HEURISTIC_P_III, sk);
        QTESLASigner signer = new QTESLASigner();

        signer.init(true, new ParametersWithRandom(qPriv, QTESLASecureRandomFactory.getFixed(seed, 256)));

        byte[] sig = signer.generateSignature(msg);


        //
        // The expected sig from the C version is [sig][message] so to validate we need to append the message to our generated signature.
        //
        byte[] expectedSig = sm;
        byte[] generatedSig = Arrays.concatenate(sig, msg);

        Assert.assertTrue(Arrays.areEqual(expectedSig, generatedSig));


        //
        // Round trip against the public key generated by the C version.
        //

        QTESLAPublicKeyParameters qPub = new QTESLAPublicKeyParameters(QTESLASecurityCategory.HEURISTIC_P_III, publicKey);

        QTESLASigner verifier = new QTESLASigner();

        verifier.init(false, qPub);

        assertTrue(verifier.verifySignature(msg, sig));

    }


    public void testKATVectors()
        throws Exception
    {

        String[] files = new String[]{

            // org.bouncycastle.crypto.test.qteslaR2.KAT.ref.KAT32
            "/org/bouncycastle/pqc/crypto/test/qTeslaR2/KAT/ref/KAT32/PQCsignKAT_qTesla-I.rsp",
            "/org/bouncycastle/pqc/crypto/test/qTeslaR2/KAT/ref/KAT32/PQCsignKAT_qTesla-II.rsp",
            "/org/bouncycastle/pqc/crypto/test/qTeslaR2/KAT/ref/KAT32/PQCsignKAT_qTesla-III.rsp",
            "/org/bouncycastle/pqc/crypto/test/qTeslaR2/KAT/ref/KAT32/PQCsignKAT_qTesla-V.rsp",
            "/org/bouncycastle/pqc/crypto/test/qTeslaR2/KAT/ref/KAT32/PQCsignKAT_qTesla-V-size.rsp",
            "/org/bouncycastle/pqc/crypto/test/qTeslaR2/KAT/ref/KAT32/PQCsignKAT_qTesla-p-I.rsp",
            "/org/bouncycastle/pqc/crypto/test/qTeslaR2/KAT/ref/KAT32/PQCsignKAT_qTesla-p-III.rsp",


            "/org/bouncycastle/pqc/crypto/test/qTeslaR2/KAT/ref/KAT64/PQCsignKAT_qTesla-I.rsp",
            "/org/bouncycastle/pqc/crypto/test/qTeslaR2/KAT/ref/KAT64/PQCsignKAT_qTesla-II.rsp",
            "/org/bouncycastle/pqc/crypto/test/qTeslaR2/KAT/ref/KAT64/PQCsignKAT_qTesla-III.rsp",
            "/org/bouncycastle/pqc/crypto/test/qTeslaR2/KAT/ref/KAT64/PQCsignKAT_qTesla-V.rsp",
            "/org/bouncycastle/pqc/crypto/test/qTeslaR2/KAT/ref/KAT64/PQCsignKAT_qTesla-V-size.rsp",
            "/org/bouncycastle/pqc/crypto/test/qTeslaR2/KAT/ref/KAT64/PQCsignKAT_qTesla-p-I.rsp",
            "/org/bouncycastle/pqc/crypto/test/qTeslaR2/KAT/ref/KAT64/PQCsignKAT_qTesla-p-III.rsp",
        };


        for (String file : files)
        {
            List<QTeslaKatVector> vectors =
                new QTeslaKatParser(file, QTESLATest.class.getResourceAsStream(file))
                    .parse("count");

            TestCase.assertEquals(100, vectors.size());

            int type;

            if (file.endsWith("qTesla-I.rsp"))
            {
                type = QTESLASecurityCategory.HEURISTIC_I;
            }
            else if (file.endsWith("qTesla-p-I.rsp"))
            {
                type = QTESLASecurityCategory.HEURISTIC_P_I;
            }
            else if (file.endsWith("qTesla-p-III.rsp"))
            {
                type = QTESLASecurityCategory.HEURISTIC_P_III;
            }
            else if (file.endsWith("qTesla-II.rsp"))
            {
                type = QTESLASecurityCategory.HEURISTIC_II;
            }
            else if (file.endsWith("qTesla-III.rsp"))
            {
                type = QTESLASecurityCategory.HEURISTIC_III;
            }
            else if (file.endsWith("qTesla-V.rsp"))
            {
                type = QTESLASecurityCategory.HEURISTIC_V;
            }
            else if (file.endsWith("qTesla-V-size.rsp"))
            {
                type = QTESLASecurityCategory.HEURISTIC_V_SIZE;
            }
            else
            {
                throw new Exception("unable to determine file type for. " + file);
            }


            for (QTeslaKatVector vector : vectors)
            {
                try
                {
                    doTestKAT(file, type, vector.pk, vector.sk, vector.seed, vector.msg, vector.sm);
                }
                catch (Exception ex)
                {
                    throw new Exception(file + " count =" + vector.count + " failed", ex);
                }
            }

        }


    }

    public static class QTeslaKatVector
    {

        final int count;
        final byte[] seed;
        final int mlen;
        final byte[] msg;
        final byte[] pk;
        final byte[] sk;
        final int smlen;
        final byte[] sm;


        QTeslaKatVector(Map<String, String> parameters)
            throws Exception
        {
            count = asInt(parameters, "count", -1);
            seed = asByteArray(parameters, "seed");
            mlen = asInt(parameters, "mlen", -1);
            msg = asByteArray(parameters, "msg");
            pk = asByteArray(parameters, "pk");
            sk = asByteArray(parameters, "sk");
            smlen = asInt(parameters, "smlen", -1);
            sm = asByteArray(parameters, "sm");
        }

        @Override
        public boolean equals(Object o)
        {
            if (this == o)
            {
                return true;
            }
            if (o == null || getClass() != o.getClass())
            {
                return false;
            }

            QTeslaKatVector that = (QTeslaKatVector)o;

//            if (count != that.count)
//            {
//                return false;
//            }
            if (mlen != that.mlen)
            {
                return false;
            }
            if (smlen != that.smlen)
            {
                return false;
            }
            if (!java.util.Arrays.equals(seed, that.seed))
            {
                return false;
            }
            if (!java.util.Arrays.equals(msg, that.msg))
            {
                return false;
            }
            if (!java.util.Arrays.equals(pk, that.pk))
            {
                return false;
            }
            if (!java.util.Arrays.equals(sk, that.sk))
            {
                return false;
            }
            return java.util.Arrays.equals(sm, that.sm);
        }

        @Override
        public int hashCode()
        {
            int result;// = count;
            result = java.util.Arrays.hashCode(seed);//   31 * result + java.util.Arrays.hashCode(seed);
            result = 31 * result + mlen;
            result = 31 * result + java.util.Arrays.hashCode(msg);
            result = 31 * result + java.util.Arrays.hashCode(pk);
            result = 31 * result + java.util.Arrays.hashCode(sk);
            result = 31 * result + smlen;
            result = 31 * result + java.util.Arrays.hashCode(sm);
            return result;
        }
    }

    public static class QTeslaKatParser
    {

        private final InputStream src;
        private final String srcLabel;

        public QTeslaKatParser(String label, InputStream src)
        {
            this.src = src;
            this.srcLabel = label;
        }


        public List<QTeslaKatVector> parse(String blockDelimField)
            throws Exception
        {

            List<QTeslaKatVector> vectors = new ArrayList<QTeslaKatVector>();
            Map<String, String> extractedParameters = new HashMap<String, String>();
            BufferedReader bin = new BufferedReader(new InputStreamReader(src));
            Set<QTeslaKatVector> duplicateTrap = new HashSet<QTeslaKatVector>();


            String line = null;

            while ((line = bin.readLine()) != null)
            {
                line = line.trim();
                if (line.length() == 0 || line.startsWith("#"))
                {
                    continue;
                }


                //
                // Vector parameter.
                //
                if (line.contains("="))
                {
                    String[] kv = line.split("=");

                    for (int t = 0; t < kv.length; t++)
                    {
                        kv[t] = kv[t].trim();
                    }

                    String key = null;
                    String value = null;

                    if (kv.length > 0)
                    {
                        if (!extractedParameters.isEmpty() && kv[0].equals(blockDelimField))
                        {
                            QTeslaKatVector vector = new QTeslaKatVector(extractedParameters);
                            vectors.add(vector);

                            if (duplicateTrap.contains(vector))
                            {
                                throw new Exception("Duplicate Vector encountered, set : " + vector.count + " in " + srcLabel);
                            }

                            duplicateTrap.add(vector);

                            extractedParameters.clear();
                        }

                        if (kv.length > 1)
                        {
                            extractedParameters.put(kv[0], kv[1]);
                        }
                        else
                        {
                            extractedParameters.put(kv[0], null);
                        }
                    }
                }

            }

            //
            // Trailing block.
            //
            if (!extractedParameters.isEmpty())
            {
                vectors.add(new QTeslaKatVector(extractedParameters));
            }


            return vectors;
        }

    }

}
